@{
    ViewData["Title"] = "What's If Sub-Sofware";

    Layout = "~/Views/Shared/_LayoutWeb.cshtml";

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

    <link rel="stylesheet" href="~/assets/css/theme.min.css">

    <link rel="stylesheet" href="~/assets/css/tablefreezer.css">

    <link href="~/assets/css/theme.min.css" type="text/css" rel="stylesheet" id="style-default">

    <link href="~/assets/css/choices.min.css" type="text/css" rel="stylesheet">

    <link href="~/assets/css/table.min.css" type="text/css" rel="stylesheet">

    <script src="~/assets/js/config.js"></script>

    <link rel="stylesheet" href="~/css/autocomplete.css">

    <script src="~/assets/js/all.min.js"></script>

    <link rel="stylesheet" href="~/css/myStyles.css"> 

    <link rel="stylesheet" href="~/css/button.css" />
}

<div class="content mt-1" style="font-size: 12px; min-height: auto!important;" id="divPage" ng-controller="ctrlAppPage" ng-click="toggleResultsVisibility()">

    <div class="row g-0">

        <div class="col-6">
            <div class="card shadow-sm p-2 mb-3 bg-light rounded">
                <div class="card-body p-2">

                    <div class="row justify-content-between">
                        <div class="col-auto d-flex gap-4 ">
                            <div class="col-auto">
                                <b>PHA No.:</b> <br>
                                <span class="text-uppercase">{{ ( data_header[0].action_type =='update' ? data_header[0].pha_no : data_header[0].pha_sub_software + '-2023-00000XX')}}</span>
                            </div>
                            <div class="col-auto">
                                <b>Revision :</b> <br>
                                <span ng-if="data_header[0].pha_version>0 "> {{data_header[0].pha_version_text + '(' + data_header[0].pha_version_desc  +  ')'}}</span>
                                <span ng-if="data_header[0].pha_version==0 "> - </span>
                            </div>
                            <div class="col-auto">
                                <b>Request By :</b> <br>
                                <span>{{data_header[0].request_user_displayname}}</span>
                            </div>
                            <div class="col-auto">
                                <b>Request Status :</b> <br>
                                <span> {{data_header[0].pha_status_displayname}}</span>
                            </div>
                        </div>
                        <div class="col-auto" ><!----ng-class="{ 'd-none': (minutes > 9) }"------>
                            <div class="col-auto">
                                <b>Auto-Save Interval :</b> <br>
                                <span ng-class="{ 'blinking-text': (minutes <= 10) }">{{counterText}} </span>
                            </div>
                       </div>
                    </div>

                </div>
            </div>

        </div>

        <div class="col-6 ">

            <div class="d-flex align-items-center py-2  justify-content-end">
                <span class="mx-2">
                    <button class="btn btn-outline-secondary btn-sm" style="width: 100px;" ng-click="confirmBack()">BACK</button>
                </span>
                <span class="mx-2" ng-if="cancle_type && data_header[0].action_change > 0">
                    <button class="btn btn-danger btn-sm" style="width: 100px;" ng-click="confirmCancle()">CANCEL</button>
                </span>
                <span class="mx-2" ng-if="export_type && false">
                    <button class="btn text-light btn-sm" style="background-color: #e90f8b;" ng-click="clickExportReport()">EXPORT/IMPORT</button>
                </span>
                <span class="mx-2" ng-if="save_type">
                    <button class="btn btn-primary btn-sm" style="width: 100px;" ng-click="confirmSave('save')">SAVE</button>
                </span>
                <span class="mx-2" ng-if="action_to_review">
                    <button class="btn btn-warning btn-sm" style="width: 200px;"
                            ng-click="confirmMailtoMemberReview('submit')">
                        <span style="font-size:9px">EMAIL TO MEMBER TEAM REVIEW</span>
                    </button>
                </span>
                <span class="mx-2" ng-if="submit_type">
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 11 && data_general[0].sub_expense_type == 'Normal'" ng-click="confirmSave('submit_register')">
                        Task Register
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 11 && !(data_general[0].sub_expense_type == 'Normal')" ng-click="confirmSave('submit')">
                        Submit and Closed
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 12" ng-click="confirmSave('submit_conduct')">
                        Submit
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 21" ng-click="confirmSave('submit_approver')">
                        Submit
                    </button>
                </span>
            </div>

            <div class="float-end pe-3">
                <div class="form-check form-switch  disabled-link">
                    <input class="form-check-input" id="flexSwitchCheckChecked" type="checkbox" />
                    <label class="form-check-label" for="flexSwitchCheckChecked">History tracking record</label>
                </div>
            </div>

        </div>

    </div>

    <div class="row g-0">
        <div class="col-12 ">

            <div class="card">

                <div class="card-header mb-0 pb-0 border border-bottom-0 ">

                    <ul class="nav nav-underline border-3 border-primary border-bottom " id="myTab" role="tablist" style="position: relative;">

                        <li ng-repeat="tab in tabs" ng-if="tab.isShow || true">
                                <a ng-click="changeTab(tab)"
                                    class="btn-nav-menu btn-outline-primary border border-0"
                                    ng-class="{'btn active': (tab.isActive === true)}"
                                    id="{{tab.name}}-tab" name="{{tab.name}}-tab"
                                    data-bs-toggle="tab" href="#tab-{{tab.name}}" role="tab"
                                    aria-controls="tab-{{tab.name}}"
                                    aria-selected="{{tab.isActive}}">
                                    {{ tab.title }}
                                </a>
                        </li>
                    </ul>
                </div>


                <div class="card-body tab-content">
                    @* {{action_part}} *@

                    <!-- general information start -->
                    <div class="" ng-class="{
                        'tab-pane fade show active':(action_part == 1),
                        'tab-pane fade show active':(tabs[0].isActive),
                        'tab-pane fade':(action_part != 1)}"
                         id="tab-general" role="tabpanel" aria-labelledby="general-tab">

                        <div class="mx-3 row g-3 align-items-center" ng-repeat="item in data_general">

                            <div class="col-md-2">
                                <label class="form-label ps-0" for="expense_type"><b class="text-danger"> * </b>Project Type</label>
                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                       data-bs-placement="top" title=" Project Type : OPEX" data-bs-html="true"></a>
                                </label>

                                <select class="form-select rounded-1"
                                        ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                        id="expense_type" placeholder="Project Type"
                                        name="expense_type" ng-model="item.expense_type" ng-if="data_header[0].pha_status == 11"
                                        ng-change="actionChange(item,item.seq,'expense_type')">
                                    <option id="OPEX">OPEX</option>
                                    <option id="CAPEX">CAPEX</option>
                                </select>
                                <select class="form-select rounded-1 disabled-link" ng-if="data_header[0].pha_status>=12"
                                        ng-model="item.expense_type">
                                    <option id="OPEX">OPEX</option>
                                    <option id="CAPEX">CAPEX</option>
                                </select>

                            </div>
                            <div class="col-md-2 ">

                                <label class="form-label ps-0" for="expense_type">
                                    <b class="text-danger"> * </b>Sub Project Type
                                </label>
                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                       data-bs-placement="top" name="sub_expanse_type" title=" Sub Project Type : Normal" data-bs-html="true"></a>
                                </label>
                                <select class="form-select  text-uppercase rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                        id="sub_expense_type" name="sub_expense_type" ng-if="data_header[0].pha_status == 11"
                                        ng-model="item.sub_expense_type" ng-change="actionChange(item,item.seq,'sub_expense_type')">
                                    <option id="Normal">Normal</option>
                                    <option id="Study">Internal Study</option>
                                </select>
                                <select class="form-select  text-uppercase rounded-1 disabled-link" ng-if="data_header[0].pha_status>=12"
                                        ng-model="item.sub_expense_type">
                                    <option id="Normal">Normal</option>
                                    <option id="Study">Internal Study</option>
                                </select>

                            </div>

                            <div class="col-md-3 ">
                                <div class="row g-0 align-items-center">

                                    <div class="col-12 p-1">
                                        <label class="form-label ps-0" for="unit">{{(item.expense_type=='OPEX'? 'e-MOC Reference Number' : 'MOC Reference Number')}} </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Reference MOC : PN-13081" data-bs-html="true"></a>
                                        </label>
                                        <input type="text" name="reference_moc" class="form-control rounded-1"
                                               ng-class="{'disabled-link':(!tab_general_active)}"
                                               ng-keyup="actionChange(item,item.seq,'')" ng-model="item.reference_moc"
                                               placeholder="Input Data"
                                               autocomplete="off"
                                               value="PN-13089">
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div class="mx-3 row  g-3 align-items-top" ng-repeat="item in data_general">
                            <!-- area -->
                            <div class="col-md-11 p-1 ">
                                <div class="row g-0 align-items-top">
                                    <div class="col-md-2 p-1 me-2 id_apu" >
                                        <label class="form-label ps-0 pb-1" for="area"><b class="text-danger"> * </b>Area Process Unit </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip"
                                                data-bs-placement="top" 
                                                title=" Area Process Unit : A" 
                                                data-bs-html="true">
                                            </a>
                                        </label>
                                        <label class="form-label ps-0" for="area"></label>
                                        <select class="form-control js-choice-apu mb-0" id="id_apu"
                                                ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'area')"
                                                ng-model="item.id_apu"
                                                ng-disabled="!tab_general_active || !(tab_general_active && data_header[0].pha_status <= 12)"
                                                hide-placeholder-option>
                                            @*<option value="" selected ng-if="!placeholderHidden">Please select</option>*@
                                            <option ng-repeat="item2 in master_apu" ng-value="item2.id" >
                                                {{item2.name}}
                                            </option>
                                        </select>
                                        @*<select class="form-select rounded-1 disabled-link" ng-if="!tab_general_active"
                                                ng-model="item.id_apu">
                                            <option ng-selected="item.id_apu == item2.id"
                                                    ng-repeat="item2 in master_apu" ng-value="item2.id">
                                                {{item2.name}}
                                            </option>
                                            <i class="fa-solid fa-triangle-exclamation"></i>
                                        </select>*@
                                        <div class="invalid-feedback" id="id_apu_error">
                                            <div ng-message="required">Please select an Area Process Unit.</div>
                                        </div>
                                    </div>
                                    <div class="col-auto p-1 d-none">
                                        <i class="fas fa-clipboard-list cursor-pointer" 
                                            ng-class="{'disabled-link':(!tab_general_active)}"
                                            style="font-size: 18px;color: blue;"
                                            data-bs-toggle="modal" 
                                            data-bs-target="#modalNotification"
                                            ng-click="openModalDataNotification(item)">
                                        </i>
                                    </div>
                                    <!-- Unit No -->
                                    <div class="col-md-2 p-1 me-2 align-items-top" 
                                        ng-if="item.id_company != '9999' "
                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                        style="display: flex; flex-direction: column; padding-top: 2px;">
                                            <label class="form-label ps-0" style="margin-top: 4px;" for="unit">
                                                <b class="text-danger d-none"> * </b>
                                                Unit No 
                                            </label>
                                            <div class="dropdown">
                                                <button id="dropdown_unit_no" class="dropbtn" ng-class="{'disabled-link':(!tab_general_active)}">
                                                    {{item.unit_no_name}}
                                                </button>
                                                <div id="unit_no" class="dropdown-content">
                                                    <input id="dropdown_input" 
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        class="dropdown_input" 
                                                        type="text" 
                                                        placeholder="Search.." 
                                                        ng-model="search_keywords.unit_no"
                                                        ng-change="filterFunction('unit_no')">
                                                    <a ng-repeat="item2 in master_unit_no_list" 
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        ng-if="item2.id_apu == item.id_apu"
                                                        ng-click="changeUnitNo(item2)"
                                                        value="item2.id" >
                                                        {{item2.name}}
                                                    </a>
                                                </div>
                                            </div>
                                    </div>

                                    <!-- functional location -->
                                    <div class="col-md-2 p-1 me-2 align-items-top" 
                                        ng-if="item.id_company != '9999' "
                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                        style="display: flex; flex-direction: column; padding-top: 2px;">
                                        <label class="form-label ps-0" style="margin-top: 4px;" for="unit">
                                            <b class="text-danger d-none"> * </b>
                                            Functional Location
                                        </label>
                                        <div class="dropdown">
                                            <button id="dropdown_functional" class="dropbtn" ng-class="{'disabled-link':(!tab_general_active)}">
                                                {{item.functional_location}}
                                            </button>
                                            <div id="functional" class="dropdown-content">
                                                <input id="dropdown_input" 
                                                    class="dropdown_input" 
                                                    ng-class="{'disabled-link':(!tab_general_active)}"
                                                    type="text" 
                                                    placeholder="Search.." 
                                                    ng-model="search_keywords.functional"
                                                    ng-change="filterFunction('functional')">
                                                <a ng-repeat="item2 in master_functional_list" 
                                                    ng-class="{'disabled-link':(!tab_general_active)}"
                                                    ng-click="changeTFunctional(item2)"
                                                    value="item2.id" >
                                                    {{item2.name}}
                                                </a>
                                            </div>
                                        </div>
                                    </div>    

                                    <div class="col-4 p-1 d-none">
                                        <label class="form-label ps-0" for="organizerSingle">
                                            Functional Location
                                        </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip" 
                                                data-bs-placement="top" 
                                                title=" Functional Location : TPX-76-LICSA-002-TX" 
                                                data-bs-html="true">
                                            </a>
                                        </label>
                                        <div ng-if="!(item.expense_type=='CAPEX' && (item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study'))">
                                            <select class="form-control js-choice-functional"
                                                    ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                    data-choices="data-choices"
                                                    data-options='{"removeItemButton":true,"placeholder":true}'
                                                    ng-change="actionChange(item,item.seq,'')" 
                                                    ng-model='item.functional_location'
                                                    ng-if="tab_general_active && !(item.expense_type=='CAPEX' && (item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study'))"
                                                    hide-placeholder-option>
                                                <option value="" selected ng-if="!placeholderHidden">Please select</option>
                                                <option ng-repeat="item2 in master_functional" 
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        ng-value="item2.id">{{item2.name}}
                                                </option>
                                            </select>
                                            <select class="form-control disabled-link"
                                                    ng-model='item.functional_location'
                                                    ng-class="{'disabled-link':(!tab_general_active)}"
                                                    ng-if="!tab_general_active && !(item.expense_type=='CAPEX' && (item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study'))">
                                                <option ng-repeat="item2 in master_functional" ng-value="item2.id">{{item2.name}}</option>
                                            </select>

                                        </div>

                                        <div ng-if="(item.expense_type=='CAPEX' && (item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study'))">
                                            <input class="form-control rounded-1" 
                                                    ng-class="{'disabled-link':(!tab_general_active)}"
                                                   type="text" 
                                                   placeholder="Functional Location"
                                                   name="other_functional_location" 
                                                   ng-model="item.other_functional_location" />
                                        </div>


                                    </div>

                                    <div class="col-md-4 p-1">
                                        <label class="form-label ps-0 pb-1" for="organizerMultiple">Functional Location Additional</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top"
                                               title=" Functional Location Desc: TPX-76-LICSA-002-TX, TPX-76-LICSA-003-TX, TPX-76-LICSA-004-TX"
                                               data-bs-html="true"></a>
                                        </label>
                                        <select class="form-select align-bottom rounded-1 js-choice-functional_audition"
                                                style="height: 36px;" id="organizerMultiple"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                multiple="multiple" data-options='{"removeItemButton":true,"placeholder":true}'
                                                name="functional_location_audition"
                                                ng-model="item.functional_location_audition"
                                                ng-change="actionChange(item,item.seq,'')"
                                                ng-disable="!tab_general_active" data-allow-clear="true">
                                            <option ng-repeat="item2 in master_functional_audition"
                                                    ng-selected="item.functional_location_audition == item2.name"
                                                    value="{{item2.name}}">
                                                {{ item2.name }}
                                            </option>
                                        </select>
                                        @*<select class="form-select align-bottom rounded-1 disabled-link" style="height: 36px;"
                                                ng-model="item.functional_location_audition"
                                                ng-if="!tab_general_active">
                                            <option ng-repeat="item2 in master_functional_audition"
                                                    ng-selected="item.functional_location_audition == item2.name"
                                                    value="{{item2.name}}">
                                                {{ item2.name }}
                                            </option>
                                        </๑select>*@
                                    </div>
                                </div>
                            </div>

                            <!-- Business Unit -->
                            <div class="col-md-auto p-1  align-items-top d-none">
                                <div class="row g-0 align-items-top p-2">

                                    <label class="form-label ps-0" for="unit">Business Unit </label>
                                    <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                        <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                           data-bs-placement="top" title=" Business Unit : ADIP Unit" data-bs-html="true"></a>
                                    </label>

                                    <div ng-if="!(item.expense_type=='CAPEX' && (item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study'))">

                                        <select class="form-control"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')"
                                                ng-model='item.id_business_unit'
                                                ng-if="tab_general_active">
                                            <option ng-repeat="item2 in master_business_unit"
                                                    ng-value="item2.id" ng-if="item2.id_apu == item.id_apu">
                                                {{item2.name}}
                                            </option>
                                        </select>

                                        <select class="form-control disabled-link"
                                                ng-model='item.id_business_unit'
                                                ng-if="!tab_general_active">
                                            <option ng-repeat="item2 in master_business_unit"
                                                    ng-value="item2.id" ng-if="item2.id_apu == item.id_apu">
                                                {{(item2.name).replace('Please select','')}}
                                            </option>
                                        </select>
                                    </div>
                                    <div ng-if="(item.expense_type=='CAPEX' && (item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study'))">
                                        <input class="form-control rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                               type="text" placeholder="Business Unit"
                                               name="other_business_unit" ng-model="item.other_business_unit" />
                                    </div>


                                </div>
                            </div>


                        </div>

                        <div class="mx-3 row  g-3 align-items-center" ng-repeat="item in data_general"
                             ng-class="{'disabled-link':(!tab_general_active)}">

                            <!-- Project Name -->
                            <div class="col-md-5 p-1">

                                <label class="form-label ps-0">{{(item.expense_type=='OPEX'? 'MOC Title' : 'Project Name')}}</label>
                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                       data-bs-placement="top"
                                       data-bs-html="true"></a>
                                </label>

                                <input class="form-control rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                       type="text" placeholder="Project Name"
                                       name="project_name"
                                       ng-model="item.pha_request_name"
                                       ng-keyup="filterResultGeneral(item.pha_request_name, 'pha_request_name')">
                                <ul class="list-group mt-2 w-25" style="position: absolute;" ng-show="showResults">
                                    <li class="list-group-item "
                                        ng-repeat="result in filteredResults | toArray | filter:{field:'pha_request_name'}"
                                        ng-click="selectResult(result,item,'pha_request_name')">
                                        {{ result.name }}
                                    </li>
                                </ul>

                            </div>

                            <!-- Target Date -->
                            <div class="col-md-7 p-1">

                                <div class="row g-0 align-items-center">
                                    <div class="col-md-3 p-1">
                                        <label class="form-label ps-0" for="tgs_date">Target Start Date</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Target Start Date :  " data-bs-html="true"></a>
                                        </label>
                                        <input type="date"
                                            ng-model="item.target_start_date"
                                            ng-keyup="actionChange(item, item.seq, '')"
                                            ng-max="item.target_end_date"
                                            max="{{ item.target_end_date | date:'yyyy-MM-dd' }}"
                                            class="form-control rounded-1 datetimepicker cursor-pointer"
                                            ng-class="{'disabled-link': (!tab_general_active)}"
                                            placeholder="dd/mm/yyyy">
                                    </div>

                                    <div class="col-md-auto p-1">
                                        <label class="form-label ps-0" for="tge_date">COMPLETION DATE (CLOSE OUT REPORT)</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Complete Date :  " data-bs-html="true"></a>
                                        </label>
                                        <input type="date" ng-model="item.target_end_date"
                                            ng-keyup="actionChange(item,item.seq,'')"
                                            ng-min="item.target_start_date"
                                            min="{{ item.target_start_date | date:'yyyy-MM-dd' }}"
                                            class="form-control rounded-1 datetimepicker cursor-pointer"
                                            ng-class="{'disabled-link':(!tab_general_active)}"
                                            placeholder="dd/mm/yyyy">
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div class="mx-3 row  gx-0 align-items-center" ng-repeat="item in data_general"
                             ng-class="{'disabled-link':(!tab_general_active)}">

                            <div class="col-5 p-1">

                                <label class="form-label ps-0" for="description_general">Study Objective and Work Scope :</label>
                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                       data-bs-placement="top" title="Study Objective and Work Scope :  " data-bs-html="true"></a>
                                </label>

                                <textarea class="form-control rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                          id="work_scope" name="work_scope"
                                          placeholder="Study Objective and Work Scope" style="height: 100px"
                                          ng-model="item.work_scope"></textarea>

                            </div>

                            <div class="col-5 p-1 d-none">

                                <label class="form-label ps-0" for="description_general">Description/Remark :</label>
                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                       data-bs-placement="top" title=" Description/Remark :  " data-bs-html="true"></a>
                                </label>

                                <textarea class="form-control rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                          id="description_general" name="description_general"
                                          placeholder="Description/Remark" style="height: 100px"
                                          ng-model="item.descriptions"></textarea>

                            </div>
                        </div>


                    </div>
                    <!-- general information end-->
                    <!-- session start-->
                    <div class="" ng-class="{
                        'tab-pane fade show active':(action_part==2),
                        'tab-pane fade show active':(tabs[1].isActive),
                        'tab-pane fade':(action_part!==2)}"
                        id="tab-session" 
                        role="tabpanel" 
                        aria-labelledby="session-tab">
                        <div class="m-3 row  gx-0 align-items-center">

                            <div class="card px-2 ">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3 d-none">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>{{ sub_software }} Member</h5>
                                    </div>
                                </div>

                                <div class="col-12 col-md mx-1">

                                    <div class="table-responsive scrollbar">

                                        <table class="table mb-0 table-borderless">

                                            <thead class="  text-uppercase text-start border-bottom">
                                                <tr>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">No</th>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">
                                                        Member team {{(data_general[0].expense_type=='CAPEX' && data_general[0].sub_expense_type=='Normal')?' and Approver':''}}
                                                        <span class="fa-stack fa-lg cursor-pointer p-1" 
                                                            data-toggle="tooltip" 
                                                            data-placement="top" 
                                                            title="" 
                                                            ng-if="data_general[0].expense_type=='CAPEX' && data_general[0].sub_expense_type=='Normal'"
                                                            ng-click="openModalMatrix()"
                                                            style="display: inline-block; text-align: center;">
                                                            <i class="fa-solid fa-circle-info fa-lg" style="color: #2445fc; background-color: #f1f2f4;"></i>
                                                        </span>
                                                    </th>  
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">Session Date Time </th>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2"></th>
                                                </tr>
                                            </thead>

                                            <tbody class="" id="customer-rating-table-body">

                                                <tr ng-repeat="item in data_session | orderBy:no" class="">

                                                    <td class="align-top text-top" style="width: 30px;">
                                                        <h6 class="fw-semi-bold text-center">{{item.no}}</h6>
                                                    </td>

                                                    @* Member Team *@
                                                    <td class="align-top col-auto" style="min-width: 450px;">
                                                        <div class="row d-flex">
                                                            <div class="col-6">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'member')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>
                                                                        Add Member Team
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_memberteam" 
                                                                     ng-if="item2.user_name !== null && item2.id_session === item.seq">
                                                                    <div class="col-8 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:100%;border-color: #f1f2f4;">
                                                                                {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-4 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                                {{ item2.user_title}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <!-- data_relatedpeople_outsider -->
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople_outsider | toArray | filter:{user_type: 'member'}" 
                                                                    ng-if="item2.user_displayname !== null && item2.id_session === item.seq">
                                                                    <div class="col-8 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                            style="width:80%;border-color: #f1f2f4;">
                                                                            {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-4 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                                {{ item2.user_title}}
                                                                        </label>
                                                                    </div>                                                                    
                                                                </div>                                                                
                                                            </div>                                                           

                                                            <!-- Safety Reviewer Section -->
                                                            <div class="col-6" ng-if="data_general[0].expense_type=='CAPEX' && data_general[0].sub_expense_type=='Normal'">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'approver')" 
                                                                            title="ผู้ทบทวนหลัก">
                                                                        <span class="far fa-address-book fa-lg"></span>
                                                                        Add Reviewer
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_approver" 
                                                                    ng-if="item2.user_name !== null && item2.id_session === item.seq"> 
                                                                    <div class="col-8 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                                style="width:80%;border-color: #f1f2f4;"
                                                                                ng-if="item2.approver_type === 'approver'">
                                                                                {{ '(Main)' + item2.user_displayname}}
                                                                        </label>
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                                style="width:80%;border-color: #f1f2f4;"
                                                                                ng-show="item2.approver_type === 'safety'">
                                                                                {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-4 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                                {{ item2.user_title}}
                                                                        </label>
                                                                    </div>                                                                    
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row d-flex mt-4" >
                                                             <div class="col-6 " ng-if="data_general[0].expense_type=='CAPEX' && data_general[0].sub_expense_type=='Normal'">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'specialist')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>
                                                                        Add ผู้เชี่ยวชาญเฉพาะด้าน (ถ้ามี):
                                                                    </button>
                                                                </div>
                                                                <!-- Specialist from data_relatedpeople -->
                                                                <div class="row" 
                                                                    ng-repeat="item2 in data_relatedpeople | toArray | filter:{ user_type:'specialist'}"
                                                                    ng-if="item2.user_displayname !== null && item2.id_session === item.seq">
                                                                    <div class="col-8 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:100%;border-color: #f1f2f4;">
                                                                                {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-4 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                                {{ item2.user_title}}
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <!-- Specialist from data_relatedpeople_outsider -->
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople_outsider | toArray | filter:{id_session: selectdata_session, user_type:'specialist'}" 
                                                                    ng-if="item2.user_displayname !== null && item2.id_session === item.seq">   
                                                                    <div class="col-8 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                            style="width:80%;border-color: #f1f2f4;">
                                                                            {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-4 align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                                {{ item2.user_title}}
                                                                        </label>
                                                                    </div>                                                                       
                                                                </div>
                                                            </div>
                                                            
                                                        </div>                                                        

                                                    </td>

                                                    @* Session Date *@
                                                    <td class="align-top">

                                                        <div class="row g-2" ng-class="{'disabled-link':(!tab_general_active)}">

                                                            <span class="row p-0">

                                                                <span class="col-md-4  p-1 d-flex">
                                                                    <label class="form-label d-none" for="meeting_date">Meeting Date</label>

                                                                    <input type="date" class="form-control rounded-1 datetimepicker" id="meeting_date" name="meeting_date"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_date" placeholder="dd/mm/yyyy">

                                                                </span>

                                                                <span class="col-md-3  p-1 d-flex">
                                                                    <label class="form-label d-none" for="timepicker1">Start Time</label>
                                                                    <label class="form-label d-none" style="font-size: 10px;">{{formatTo24Hour(item.meeting_start_time)}}</label>

                                                                    <input class="form-control  d-none" id="st_meet" name="st_meet"
                                                                           style="width:20px; height: 20px"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_start_time" value="{{formatTo24Hour(item.meeting_start_time)}}"
                                                                           type="time" placeholder="hour : minute" />

                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_start_time_hh"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_hours" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_start_time_mm"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_minutes" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>

                                                                </span>
                                                                <span class="col-md-1 p-1 d-flex">
                                                                    <label class="form-label p-0 pt-2">To</label>
                                                                </span>
                                                                <span class="col-md-3 p-1 d-flex">
                                                                    <label class="form-label d-none" for="timepicker2">End Time</label>
                                                                    <label class="form-label d-none" style="font-size: 10px;">{{formatTo24Hour(item.meeting_end_time)}}</label>
                                                                    <input class="form-control  d-none" id="et_meet" name="et_meet"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_end_time"
                                                                           type="time" placeholder="hour : minute" />

                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_end_time_hh"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_hours" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_end_time_mm"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_minutes" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                </span>

                                                            </span>

                                                        </div>
                                                    </td>

                                                    @* Buton Action *@
                                                    <td class="align-top " style="width: 158px;" ng-class="{'d-none': (!tab_general_active)}">

                                                        <div class="col-12" style="width: 158px;">
                                                            <div class="float-end">
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                                            ng-click=removeDataSession(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Remove">
                                                                        <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                                            ng-click=copyDataSession(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy">
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1 d-none">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #1336fc; background-color: #f1f2f4; border-color: #a8a8a8;"
                                                                            ng-click=copyDataSession(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy">
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                                            ng-click=addDataSession(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Add">
                                                                        <span class="fas fa-square-plus fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                            </div>
                                                        </div>
                                                    </td>

                                                </tr>


                                            </tbody>

                                        </table>

                                    </div>

                                </div>

                            </div>
                        </div>

                    </div>
                    <!-- session end-->
                    <!-- Task list -->
                    <div class="" 
                        ng-class="{
                            'tab-pane fade show active':(action_part==3),
                            'tab-pane fade show active':(tabs[2].isActive),
                            'tab-pane fade':(action_part!==3)}"
                         id="tab-task" role="tabpanel" aria-labelledby="task-tab">

                        <div class="m-3 row  gx-0 align-items-center">
                            <div class="card px-2">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Drawing & Reference</h5>
                                    </div>
                                </div>
                                <div class="col-12 col-md mx-1">

                                    <div class="table-responsive scrollbar">

                                        <table class="table fs--1 mb-0 table-borderless">
                                            <thead class=" text-uppercase border-bottom">
                                                <tr>
                                                    <th class="align-middle text-center" scope="col" style="font-size: 10px;">No</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;">Document Name</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;"><b class="text-danger"> * </b>Drawing No</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;"><b class="text-danger"> * </b>Document File</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;">Comment </th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;"> </th>

                                                </tr>
                                            </thead>

                                            <tbody class="list" id="customer-rating-table-body ">
                                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                                    ng-repeat="item in data_drawing">
                                                    <td class="align-middle text-center">
                                                        <div class="p-1 ">
                                                            <h6 class="fw-semi-bold">{{item.no}}</h6>
                                                        </div>
                                                    </td>

                                                    <td class="align-middle white-space-nowrap ">
                                                        <textarea ng-keyup="actionChange(item,item.seq,'')" 
                                                                ng-model="item.document_name"
                                                                class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                                placeholder="Document Name"
                                                                style="font-size: 10px;">
                                                        </textarea>
                                                    </td>

                                                    <td class="align-middle white-space-nowrap ">
                                                        <textarea ng-keyup="actionChange(item,item.seq,'')" 
                                                                ng-model="item.document_no"
                                                                class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                                placeholder="Drawing No"
                                                                style="font-size: 10px;">
                                                        </textarea>
                                                    </td>

                                                    <td class="align-middle white-space-nowrap col-3">
                                                        <div class="d-flex align-items-center d-none ">
                                                            <input type="file" id="file-upload-1" ng-click="showFileName(1)" hidden />
                                                            <span id="fileNameDisplay-1"></span>
                                                            <button id="del1" class="btn btn-sm transition-none btn-reveal fs--2 p-1"
                                                                    ng-class="{'disabled-link':(!tab_general_active)}"
                                                                    style="display: none;"
                                                                    ng-click="clearFileName(1)">
                                                                <a class="text-decoration-none text-danger">
                                                                    <span class="fas fa-times"></span>
                                                                </a>
                                                            </button>
                                                        </div>
                                                        <div class="uploadbox align-items-center cursor-pointer">
                                                            <div class="btn-group">
                                                                <div class="icon-button border p-3" style="border-color: #0d6efd; background-color: #0d6efd;">
                                                                    <span class="fa-solid fa-arrow-up-from-bracket fa-lg" style="color: #ffffff;"></span>
                                                                </div>
                                                                <button class="Upload-button btn ps-3"  ng-if="!item.document_file_size">
                                                                    <label class="dz-message-text  fw-bold cursor-pointer"
                                                                        for="attfile-{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}">
                                                                        Upload File(Word, Excel, PDF, Image)
                                                                    </label>
                                                                    <input type="file" id="attfile-{{item.seq}}"
                                                                        name="file{{item.seq}}"
                                                                        onchange="angular.element(this).scope().fileSelect(this,'drawing')"
                                                                        style="display:none" />
                                                                </button>
                                                                <button class="Upload-button btn ps-3" ng-if="item.document_file_size > 0">
                                                                    <div class="d-flex align-items-center">
                                                                        <span class="mr-3 nametext"
                                                                            id="filename{{item.seq}}" 
                                                                            ng-class="{'d-none':(!tab_general_active)}"
                                                                            ng-click="downloadFile(item)"
                                                                            ng-if="item.document_file_size>0">
                                                                                <b style="font-size:x-small;">
                                                                                    {{(item.document_file_size>0? item.document_file_name + '('+  item.document_file_size + 'KB)' : '')}}
                                                                                </b>
                                                                        </span>
                                                                        <a id="deluploadfile-{{item.seq}}" class="btn btn-link text-danger p-0 ms-2"
                                                                                ng-class="{'d-none':(!tab_general_active)}"
                                                                                ng-click="clearFileName(item.seq)">
                                                                            <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                        </a>
                                                                    </div>
                                                                </button>
                                                            </div>   

                                                            @*<div class=" align-items-center p-1 cursor-pointer ">
                                                                <span class="mr-3 nametext text-primary" id="filename{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}"
                                                                      ng-click="downloadFile(item)">
                                                                    <b>{{(item.document_file_size>0? item.document_file_name + '('+  item.document_file_size + 'KB)' : '')}}</b>
                                                                </span>
                                                                <br>
                                                                <label class="dz-message-text text-primary fw-bold cursor-pointer"
                                                                       for="attfile-{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-3"></i>Upload File(PDF)
                                                                </label>
                                                                <input type="file" id="attfile-{{item.seq}}"
                                                                       name="file{{item.seq}}"
                                                                       onchange="angular.element(this).scope().fileSelect(this,'drawing')"
                                                                       style="display:none" />

                                                                <button id="del-{{item.seq}}" class="btn btn-link text-danger"
                                                                        ng-class="{'d-none':(!tab_general_active)}"
                                                                        ng-click="clearFileName(item.seq)"
                                                                        ng-if="status_upload">
                                                                    ng-if="item.document_file_size>0"> 
                                                                    <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                </button>
                                                                <br>
                                                                <a class="nametext ms-3 filename-text me-2"
                                                                   ng-class="{'d-none':(tab_general_active)}"
                                                                   ng-click="downloadFile(item)">
                                                                    <i class="far fa-file-pdf text-danger"></i>
                                                                </a>
                                                            </div>*@
                                                        </div>
                                                        <div id="drawing-document-file-{{item.seq}}"
                                                             class="invalid-feedback text-danger">
                                                            Please provide a valid Drawing.(Max size 10mb)
                                                        </div>
                                                    </td>

                                                    <td class="align-middle ">
                                                        <div class="col-12">
                                                            <textarea class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                      ng-class="{'disabled-link':(!tab_general_active)}"
                                                                      ng-keyup="actionChange(item,item.seq,'')"
                                                                      ng-model="item.descriptions"
                                                                      placeholder="Comment"
                                                                      style="font-size: 10px;">
                                                            </textarea>
                                                        </div>
                                                    </td>

                                                    <td class="align-middle " style="width: 158px;" ng-class="{'d-none': (!tab_general_active)}">
                                                        <div class="col-12" style="width: 158px;">
                                                            <div class="float-end ">
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                                            ng-click=removeDrawingDoc(item.seq,$index-1)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Remove">
                                                                        <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1 d-none">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #1336fc; background-color: #f1f2f4; border-color: #a8a8a8;"
                                                                            ng-click=copyDrawingDoc(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy">
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                                            ng-click=addDrawingDoc(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Add">
                                                                        <span class="fas fa-square-plus fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="mx-3 row  g-3 align-items-center">
                            <div class="card px-2">

                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0">
                                            <span class=" me-2 text-primary"><B>|</B></span>Task List
                                        </h5>
                                    </div>
                                </div>

                                <div class="col-12 col-md ">

                                    <div class="table-responsive scrollbar">
                                        <table class="table fs--2 mb-0 table-borderless">
                                            <thead class=" text-uppercase text-start border-bottom">
                                                <tr>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col">No</th>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col"><b class="text-danger"> * </b>Task</th>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col">Design Intent</th>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col">Design Conditions</th>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col">Operating Conditions</th>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col">Task Boundary</th>
                                                    <th class=" align-middle" style="font-size: 10px;" scope="col">
                                                        <b class="text-danger">
                                                            *
                                                        </b>Drawing
                                                    </th>
                                                    <th class=" align-middle d-none" scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody class="list">
                                                <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                                    ng-repeat="item in data_tasklist | orderBy:no">

                                                    <td class="align-top text-center " style="width: 30px;">
                                                        <h6 class="fw-semi-bold">{{item.no}}</h6>
                                                        <div class="" ng-class="{'d-none':(!tab_general_active)}">
                                                            <div class="align-top ">
                                                                <div class="font-sans-serif btn-reveal-trigger position-static  col-auto">
                                                                    <button class="btn btn-sm transition-none btn-reveal fs--2 p-1"
                                                                            ng-class="{'d-none':(!tab_general_active)}"
                                                                            type="button"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Add"
                                                                            ng-click=addDataTaskList(item.seq,$index)>
                                                                        <span class="fas fa-plus-circle text-success"></span>
                                                                    </button>
                                                                    <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                            ng-class="{'d-none':(!tab_general_active)}"
                                                                            type="button" 
                                                                            data-bs-toggle="dropdown" 
                                                                            data-boundary="window"
                                                                            aria-haspopup="true" 
                                                                            aria-expanded="false" 
                                                                            data-bs-reference="parent"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Options">
                                                                        <span class="fas fa-cog text-info"></span>
                                                                    </button>
                                                                    <div class="dropdown-menu dropdown-menu-end py-2">
                                                                        <a class="dropdown-item text-success"
                                                                           ng-click=copyDataTaskList(item.seq,$index)>
                                                                            <span class="fas fa-copy"></span>
                                                                            Copy
                                                                        </a>
                                                                        <div class="dropdown-divider"></div>
                                                                        <a class="dropdown-item text-danger"
                                                                           ng-click=removeDataTaskList(item.seq,$index)>
                                                                            <span class="fas fa-times-circle"></span>
                                                                            Remove
                                                                        </a>
                                                                    </div>
                                                                    <button class="btn btn-sm transition-none btn-reveal fs--2 d-none" type="button"
                                                                            ng-click=removeDataTaskList(item.seq,$index)>
                                                                        <span class="fas fa-times-circle text-danger"></span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top">
                                                        <div class="d-flex align-items-center " ng-class="{'disabled-link':(!tab_general_active)}">
                                                            <div class="autocomplete-container">
                                                                <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                          style=" width: 200px; font-size: 10px;"
                                                                          id="task_{{item.seq}}" 
                                                                          name="task_{{item.seq}}"
                                                                          placeholder="Task" 
                                                                          rows="3"
                                                                          ng-class="{'disabled-link':(!tab_general_active)}"
                                                                          ng-model="item.list"
                                                                          ng-keyup="filterResultHistory(item.list, 'task', 'task_'+ item.seq);actionChange(item,item.seq,'task')">
                                                                </textarea>
                                                                <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                     ng-class="{'ng-show' : (filteredArr[0].fieldID == ('task_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('task_'+item.seq)) }">
                                                                    <div class="autocomplete-option"
                                                                         ng-repeat="result in filteredResults | toArray | filter:{field:'task'}"
                                                                         ng-click="selectResult(result,item,'task')">
                                                                        {{ result.name }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div id="valid-task-task-{{item.seq}}"
                                                             class="invalid-feedback text-danger">
                                                            Please provide a valid Node.
                                                        </div>
                                                    </td>

                                                    <td class="align-top ">
                                                        <div class="d-flex align-items-center " ng-class="{'disabled-link':(!tab_general_active)}">
                                                            <div class="autocomplete-container">
                                                                <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                          style="font-size: 10px;"
                                                                          id="design_intent_{{item.seq}}" name="design_intent_{{item.seq}}"
                                                                          placeholder="Design Intent" rows="3"
                                                                          ng-class="{'disabled-link':(!tab_general_active)}"
                                                                          ng-model="item.design_intent"
                                                                          ng-keyup="filterResultHistory(item.design_intent, 'design_intent', 'design_intent_'+ item.seq);actionChange(item,item.seq,'')">
                                                                </textarea>
                                                                <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                     ng-class="{'ng-show' : (filteredArr[0].fieldID == ('design_intent_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('design_intent_'+item.seq)) }">
                                                                    <div class="autocomplete-option"
                                                                         ng-repeat="result in filteredResults | toArray | filter:{field:'design_intent'}"
                                                                         ng-click="selectResult(result,item,'design_intent')">
                                                                        {{ result.name }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </td>

                                                    <td class="align-top text-end status">
                                                        <div class="d-flex align-items-center " ng-class="{'disabled-link':(!tab_general_active)}">
                                                            <div class="autocomplete-container">
                                                                <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                          style="font-size: 10px;"
                                                                          id="design_conditions_{{item.seq}}" 
                                                                          name="design_conditions_{{item.seq}}"
                                                                          placeholder="Design Conditions" 
                                                                          rows="3"
                                                                          ng-class="{'disabled-link':(!tab_general_active)}"
                                                                          ng-model="item.design_conditions"
                                                                          ng-keyup="filterResultHistory(item.design_conditions, 'design_conditions', 'design_conditions_'+ item.seq);actionChange(item,item.seq,'')">
                                                                </textarea>
                                                                <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                     ng-class="{'ng-show' : (filteredArr[0].fieldID == ('design_conditions_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('design_conditions_'+item.seq)) }">
                                                                    <div class="autocomplete-option"
                                                                         ng-repeat="result in filteredResults | toArray | filter:{field:'design_conditions'}"
                                                                         ng-click="selectResult(result,item,'design_conditions')">
                                                                        {{ result.name }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top text-end status">
                                                        <div class="d-flex align-items-center " ng-class="{'disabled-link':(!tab_general_active)}">
                                                            <div class="autocomplete-container">
                                                                <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                          style="font-size: 10px;"
                                                                          id="operating_conditions_{{item.seq}}" 
                                                                          name="operating_conditions_{{item.seq}}"
                                                                          placeholder="Design Intent" 
                                                                          rows="3"
                                                                          ng-class="{'disabled-link':(!tab_general_active)}"
                                                                          ng-model="item.operating_conditions"
                                                                          ng-keyup="filterResultHistory(item.operating_conditions, 'operating_conditions', 'operating_conditions_'+ item.seq);actionChange(item,item.seq,'')">
                                                                </textarea>
                                                                <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                     ng-class="{'ng-show' : (filteredArr[0].fieldID == ('operating_conditions_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('operating_conditions_'+item.seq)) }">
                                                                    <div class="autocomplete-option"
                                                                         ng-repeat="result in filteredResults | toArray | filter:{field:'operating_conditions'}"
                                                                         ng-click="selectResult(result,item,'operating_conditions')">
                                                                        {{ result.name }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top text-end ">
                                                        <div class="d-flex align-items-center " ng-class="{'disabled-link':(!tab_general_active)}">
                                                            <div class="autocomplete-container">
                                                                <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                          style="font-size: 10px;"
                                                                          id="task_boundary_{{item.seq}}"
                                                                          name="task_boundary_{{item.seq}}"
                                                                          placeholder="Design Intent" 
                                                                          rows="3"
                                                                          ng-class="{'disabled-link':(!tab_general_active)}"
                                                                          ng-model="item.list_boundary"
                                                                          ng-keyup="filterResultHistory(item.list_boundary, 'task_boundary', 'task_boundary_'+ item.seq);actionChange(item,item.seq,'')">
                                                                </textarea>
                                                                <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                     ng-class="{'ng-show' : (filteredArr[0].fieldID == ('task_boundary_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('task_boundary_'+item.seq)) }">
                                                                    <div class="autocomplete-option"
                                                                         ng-repeat="result in filteredResults | toArray | filter:{field:'task_boundary'}"
                                                                         ng-click="selectResult(result,item,'task_boundary')">
                                                                        {{ result.name }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top text-end ">
                                                        @*data_tasklistdrawing*@
                                                        <div ng-repeat="item2 in data_tasklistdrawing | toArray | filter:{id_list:item.seq}">
                                                            <div class="d-flex align-items-center pb-1" style="width: 350px;">
                                                                <div class="font-sans-serif btn-reveal-trigger position-static me-1"
                                                                     ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                            type="button" 
                                                                            data-bs-toggle="dropdown" 
                                                                            data-boundary="window"
                                                                            aria-haspopup="true" 
                                                                            aria-expanded="false"
                                                                            data-bs-reference="parent"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Options">
                                                                        <span class="fas fa-cog text-info"></span>
                                                                    </button>
                                                                    <div class="dropdown-menu dropdown-menu-end py-2">
                                                                        <a class="dropdown-item text-success"
                                                                           ng-click=addDataTaskDrawing(x.seq,item.seq)>
                                                                            <span class="fas fa-copy"></span>
                                                                            Add
                                                                        </a>
                                                                        <div class="dropdown-divider"></div>
                                                                        <a class="dropdown-item text-danger" ng-click=removeDataTaskDrawing(item2.seq,item.seq)>
                                                                            <span class="fas fa-times-circle"></span> 
                                                                            Remove
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                                <select class="form-control" 
                                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                                        ng-model="item2.id_drawing"
                                                                        ng-change="actionChangeTaskDrawing(item,item.seq,'')">
                                                                    <option ng-selected="item2.id_drawing == y.id"
                                                                            ng-repeat="y in data_drawing" ng-value="y.id">
                                                                        {{y.document_no}}
                                                                    </option>
                                                                </select>
                                                                <div class="p-1 text-start">
                                                                    <b>Page</b>
                                                                    <div class="d-flex col-auto">
                                                                        <div class="p-0 m-0 align-top">
                                                                            <input class=" m-0 border" 
                                                                                style="height: 14px; width: 30px; font-size: 10px; border-color: #f1f2f4;"
                                                                                placeholder="Start" 
                                                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                                                ng-model="item2.page_start_first" />
                                                                        </div>
                                                                        <div class="p-0 m-0 align-top">
                                                                            <input class=" m-0 border" 
                                                                                   style="height: 14px; width: 30px; font-size: 10px; border-color: #f1f2f4;"
                                                                                   placeholder="End" 
                                                                                   ng-class="{'disabled-link':(!tab_general_active)}"
                                                                                   ng-model="item2.page_end_first" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="font-sans-serif btn-reveal-trigger position-static mx-1">
                                                                    <span class="mx-1">
                                                                        <button class="btn btn-outline-secondary p-2" 
                                                                                style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                                                data-toggle="tooltip" 
                                                                                data-placement="top" 
                                                                                title="Dowload file PDF"
                                                                                ng-click="embedPdf(item2)">
                                                                            <span class="fas fa-file-pdf fa-lg"></span>
                                                                        </button>
                                                                    </span>
                                                                </div>


                                                            </div>
                                                        </div>

                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>

                        </div>

                    </div>
                    <!-- Task list -->
                    <!-- RAM start-->
                    <div class="" 
                        ng-class="{
                            'tab-pane fade show active':(action_part==4),
                            'tab-pane fade show active':(tabs[3].isActive),
                            'tab-pane fade':(action_part!==4)}"
                         id="tab-ram" role="tabpanel" aria-labelledby="ram-tab">

                        <div class="m-3 row  gx-0 align-items-center" ng-if="flow_role_type == 'admin' && tab_worksheet_active ">

                            <div class="card px-2 pb-2 ">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-10 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span><b class="text-danger"> * </b> Risk Assessment Matrix</h5>
                                    </div>
                                     <div class="col-2">
                                        <span class="mx-1 d-flex" style="float:right;">
                                            <a class="m-1 text-info cursor-pointer"
                                               href="{{y.document_definition_file_path}}" 
                                               target="_blank"
                                               ng-repeat="y in master_ram | toArray | filter:{id: data_general[0].id_ram}">
                                               Definition Consequence Rating
                                            </a>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md mx-1 pb-2  ">
                                    <div class="row ">
                                        <div class="d-flex flex-wrap">
                                            <div class="col-md-2 col-lg-1" ng-repeat="item in data_general">
                                                <select id="ddl-ram" class="form-control form-control-sm" ng-class="{'disabled-link':(!tab_general_active)}"
                                                        ng-change="actionChange(item,item.seq,'ChangeRAM')" ng-model="item.id_ram">
                                                    <option ng-selected="item.id_ram == item2.id"
                                                            ng-repeat="item2 in master_ram" ng-value="item2.id">
                                                        {{ item2.name }}
                                                    </option>
                                                </select>
                                            </div>
                                            <div class="col-md-10 col-lg-11 d-none">
                                                <h5 class="text-900 mb-0">
                                                    <a ng-click="openModalNewRAM()" style="font-size:10px;"
                                                       class="text-decoration-none cursor-pointer ps-3">
                                                        <span class="fas fa-edit"></span>Add Risk Assessment Matrix Type
                                                    </a>
                                                </h5>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="row ps-2 mt-2">
                                        <div class="col-12 mt-4"
                                             ng-repeat="itemRam in master_ram | toArray | filter:{id: data_general[0].id_ram}">

                                            @* <div class="row ">
                                                <div class="col-12">
                                                    <div class="p-0 cursor-pointer " ng-class="{'d-none':(!tab_node_active)}">
                                                        <div ng-if="!((select_rows_level==4 && select_columns_level==4) || (select_rows_level==5 && select_columns_level==5))">
                                                            <br>
                                                            <label class="dz-message-text text-primary fw-bold"
                                                                   for="attfile-ram-{{itemRam.seq}}">
                                                                <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-3"></i>Upload (image File)
                                                            </label>
                                                            <input type="file" id="attfile-ram-{{itemRam.seq}}"
                                                                   name="file_ram_{{itemRam.seq}}"
                                                                   onchange="angular.element(this).scope().fileSelectRAM(this)"
                                                                   style="display: none;" />

                                                            <span class="mr-3 dz-message-text text-primary fw-bold" id="filename_ram_{{itemRam.seq}}">
                                                                RAM File Name : {{(itemRam.document_file_size>0? itemRam.document_file_name + '('+  itemRam.document_file_size + 'KB)' :itemRam.document_file_name )}}
                                                            </span>

                                                            <button id="del-ram-{{itemRam.seq}}" class="btn btn-link text-danger"
                                                                    ng-click="clearFileNameRAM(itemRam.seq)">
                                                                <span class="fa-regular fa-trash-can fa-lg"></span>
                                                            </button>
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="col-12 align-items-center">
                                                    <img src="{{itemRam.document_file_path}}" style="width: 100%;  height:300px;" />
                                                </div>
                                            </div> *@
                                            <div class=" d-flex justify-content-center">
                                                <div class="row" style="background-color : #F8F8F8 ; width:70%;">
                                                    <img ng-src="{{itemRam.document_file_path}}" class="cursor-pointer" />
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-6 mt-4" style="background-color : #F8F8F8;  height:350px;"
                                             ng-if="!((select_rows_level==4 && select_columns_level==4) || (select_rows_level==5 && select_columns_level==5))">

                                            <table class="table table-sm fs--1 mb-0">
                                                <thead class="">
                                                    <tr>
                                                        <th rowspan="2" colspan="1" class="text-center">ระดับความรุนแรง (Security)</th>
                                                        <th rowspan="1" colspan="{{select_columns_level}}" class="text-center">โอกาสในการเกิดความเสี่ยง (Likelihood)</th>
                                                    </tr>
                                                    <tr ng-repeat="item_ram in master_ram_level  | toArray | filter:{rows_level : select_rows_level,columns_level: select_columns_level}"
                                                        ng-if="$index == 0">
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood1_text}}</th>
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood2_text}}</th>
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood3_text}}</th>
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood4_text}}</th>
                                                        <th ng-if="select_columns_level >= 5" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood5_text}}</th>
                                                        <th ng-if="select_columns_level >= 6" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood6_text}}</th>
                                                        <th ng-if="select_columns_level >= 7" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood7_text}}</th>
                                                        <th ng-if="select_columns_level >= 8" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood8_text}}</th>
                                                        <th ng-if="select_columns_level >= 9" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood9_text}}</th>
                                                        <th ng-if="select_columns_level >= 10" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood10_text}}</th>
                                                    </tr>
                                                </thead>
                                                <tbody class=" list">
                                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                                        ng-repeat="item_ram in master_ram_level  | toArray | filter:{rows_level : select_rows_level,columns_level: select_columns_level}">
                                                        <td class="align-top text-center" style="width:150px;">{{item_ram.security_level}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram1_color}">{{item_ram.ram1_text}}<br />{{item_ram.ram1_priority}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram2_color}">{{item_ram.ram2_text}}<br />{{item_ram.ram2_priority}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram3_color}">{{item_ram.ram3_text}}<br />{{item_ram.ram3_priority}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram4_color}">{{item_ram.ram4_text}}<br />{{item_ram.ram4_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 5" ng-style=" { 'background-color' : item_ram.ram5_color}">{{item_ram.ram5_text}}<br />{{item_ram.ram5_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 6" ng-style=" { 'background-color' : item_ram.ram6_color}">{{item_ram.ram6_text}}<br />{{item_ram.ram6_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 7" ng-style=" { 'background-color' : item_ram.ram7_color}">{{item_ram.ram7_text}}<br />{{item_ram.ram7_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 8" ng-style=" { 'background-color' : item_ram.ram8_color}">{{item_ram.ram8_text}}<br />{{item_ram.ram8_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 9" ng-style=" { 'background-color' : item_ram.ram9_color}">{{item_ram.ram9_text}}<br />{{item_ram.ram9_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 10" ng-style=" { 'background-color' : item_ram.ram10_color}">{{item_ram.ram10_text}}<br />{{item_ram.ram10_priority}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card px-2 mt-2 pb-2" ng-if="!((select_rows_level==4 && select_columns_level==4) || (select_rows_level==5 && select_columns_level==5))">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Set Risk Assessment Matrix</h5>
                                    </div>
                                </div>
                                <div class="col-12 col-md mx-1">
                                    <div class="row">

                                        <div class="col-12">

                                            <div class="mt-2 table-responsive scrollbar">
                                                @*    1. select format : 6x6, 7x7
                                                2. genarate table
                                                3. maintain S & L => Risk
                                                4. Attached RAM file *@
                                                <table class="table table-sm fs--1 mb-0">
                                                    <thead class="">
                                                        <tr>
                                                            <th rowspan="2" colspan="1" class="text-center">ระดับความรุนแรง (Security)</th>
                                                            <th rowspan="1" colspan="{{select_columns_level}}" class="text-center">โอกาสในการเกิดความเสี่ยง (Likelihood)</th>
                                                        </tr>
                                                        <tr ng-repeat="item_ram in master_ram_level | toArray | filter:{rows_level : select_rows_level,columns_level: select_columns_level}" ng-if="$index == 0">
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood1_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood1_desc" placeholder="Description">
                                                            </th>
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood2_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood2_desc" placeholder="Description">
                                                            </th>
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood3_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood3_desc" placeholder="Description">
                                                            </th>
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood4_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood4_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 5 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood5_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood5_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 6 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood6_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood6_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 7 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood7_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood7_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 8 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood8_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood8_desc" placeholder="Description">
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class=" list">
                                                        <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                                            ng-repeat="item_ram in master_ram_level  | toArray | filter:{rows_level : select_rows_level,columns_level: select_columns_level}">
                                                            <td class="align-middle text-center" style="width:150px;">
                                                                <b>{{item_ram.security_level}}</b>
                                                            </td>
                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram1_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram1_priority"
                                                                        placeholder="Priority">
                                                                    <option ng-selected="item_ram.ram1_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>

                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram1_color"
                                                                                style="{'background-color': item_ram.ram1_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram1_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood1_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood1_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>

                                                            </td>
                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram2_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram2_priority">
                                                                    <option ng-selected="item.ram2_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram2_color"
                                                                                style="{'background-color': item_ram.ram2_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram2_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood2_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood2_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>

                                                            </td>
                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram3_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram3_priority">
                                                                    <option ng-selected="item.ram3_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>

                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram3_color"
                                                                                style="{'background-color': item_ram.ram3_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram3_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood3_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood3_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>

                                                            </td>
                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram4_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram4_priority">
                                                                    <option ng-selected="item.ram4_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram4_color"
                                                                                style="{'background-color': item_ram.ram4_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram4_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood4_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood4_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="align-top text-center" ng-if="select_columns_level >= 5 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram5_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram5_priority">
                                                                    <option ng-selected="item.ram5_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram5_color"
                                                                                style="{'background-color': item_ram.ram5_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram5_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood5_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood5_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="align-top text-center" ng-if="select_columns_level >= 6 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram6_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram6_priority">
                                                                    <option ng-selected="item.ram6_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>



                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram6_color"
                                                                                style="{'background-color': item_ram.ram6_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram6_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood6_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood6_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="align-top text-center" ng-if="select_columns_level >= 7 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram7_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram7_priority">
                                                                    <option ng-selected="item.ram7_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram7_color"
                                                                                style="{'background-color': item_ram.ram7_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram7_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood7_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood7_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="align-top text-center" ng-if="select_columns_level >= 8 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram8_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram8_priority">
                                                                    <option ng-selected="item.ram8_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram8_color"
                                                                                style="{'background-color': item_ram.ram8_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram8_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood8_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood8_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 9 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram9_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram9_priority">
                                                                    <option ng-selected="item.ram9_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram9_color"
                                                                                style="{'background-color': item_ram.ram9_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram9_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood9_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood9_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 10 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram10_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram10_priority">
                                                                    <option ng-selected="item.ram10_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram10_color"
                                                                                style="{'background-color': item_ram.ram10_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram10_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood10_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood10_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                        </tr>
                                                    </tbody>
                                                </table>

                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="m-3 row  gx-0 align-items-center" ng-if="!(flow_role_type == 'admin') || !tab_worksheet_active">
                            <div class="card px-2 pb-2 " ng-repeat="itemRam in master_ram | toArray | filter:{id: data_general[0].id_ram}">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-10">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span><b class="text-danger"> * </b> Risk Assessment Matrix {{itemRam.name}}</h5>
                                    </div>

                                    <div class="col-auto">
                                        <span class="mx-1 d-flex" style="float:right;">
                                            <a class="m-1 text-info cursor-pointer"
                                               href="{{y.document_definition_file_path}}" target="_blank"
                                               ng-repeat="y in master_ram | toArray | filter:{id: data_general[0].id_ram}">Definition Consequence Rating<span class="fas fa-file-pdf fa-lg ms-1"></span></a>
                                        </span>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-12 d-flex justify-content-center">
                                        <div class="row" style="background-color : #F8F8F8 ; width:75%;">
                                            <img ng-src="{{itemRam.document_file_path}}" class="cursor-pointer" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <!-- RAM end-->
                    <!-- What's Worksheet -->
                    <div class="" 
                        ng-class="{
                            'tab-pane fade show active':(action_part==5),
                            'tab-pane fade show active':(tabs[4].isActive),
                            'tab-pane fade':(action_part!==5)}"
                         id="tab-worksheet" role="tabpanel" aria-labelledby="worksheet-tab">

                        <div style="background-color: #ffffff;"
                             ng-if=" ( data_header[0].pha_status == 11 && tab_worksheet_active==true) || (data_header[0].pha_status >  11) ||
                            (data_general[0].expense_type == 'OPEX' && (data_general[0].sub_expense_type == 'Study' || data_general[0].sub_expense_type == 'Internal Study'))">

                            <div class="mx-3 row  g-3 align-items-top " ng-if="( data_tasklist.length == 1 ? (data_tasklist[0].list == null ? false : true) : true) ">

                                <div class=" col-md-3">
                                    <div class="col-md-12">
                                        <div class="row">
                                            <div class=" col-auto pe-0 me-0">
                                                <p class="form-label m-2 ps-0">Task List:</p>
                                            </div>
                                            <div class=" col-auto p-0 m-0 ps-1">
                                                <select class="form-select rounded-1 mx-1 p-1  border-start-0  border-end-0 border-top-0" ng-model="selectedItemListView"
                                                        ng-click="viewDataTaskList(selectedItemListView)">
                                                    <option ng-selected="selectedItemListView == item2.seq"
                                                            ng-repeat="item2 in data_tasklist" ng-value="item2.seq">
                                                        {{item2.list}}
                                                    </option>
                                                </select>
                                                <button class="btn btn-link me-4 px-0 text-end d-node pt-0 small " style="font-size:10px;" ng-if="selectedItemListView !=0"
                                                        ng-click="focusTask()">
                                                    <span class="fas fa-share"></span> View record Task List
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div ng-repeat="item in data_tasklist | toArray | filter:{id:selectedItemListView}"
                                         ng-if="item.id == selectedItemListView">
                                        <div class="row">
                                            <div class=" col-auto">
                                                <p class="form-label m-1">Design Intent : {{item.design_intent}}</p>
                                                <p class="form-label m-1">Operating Conditions : {{item.operating_conditions}}</p>
                                            </div>
                                            <div class=" col-auto">
                                                <p class="form-label m-1">Design Conditions : {{item.design_conditions}}</p>
                                                <p class="form-label m-1">Task Boundary : {{item.list_boundary}}</p>
                                            </div>

                                            <div class="col-auto">
                                                <p class="form-label m-1">
                                                    PFD, PID No. :
                                                    <div class="d-flex">
                                                        <div class="m-0 p-0" ng-repeat="x in data_tasklistdrawing | toArray | filter:{id_list:selectedItemListView}">
                                                            <a class="form-label m-1 text-info cursor-pointer"
                                                               href="{{y.document_file_path}}" target="_blank"
                                                               ng-repeat="y in data_drawing"
                                                               ng-if="y.id == x.id_drawing">{{y.document_no}}({{y.document_name}}),</a>
                                                        </div>
                                                    </div>
                                                </p>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <div class="col-3 row m-0 p-0">
                                    <div class="col-12">
                                        <!-- ส่วนที่มีอยู่แล้ว -->
                                        <div class="float-end align-top">

                                            <button class="btn btn-danger btn-sm  p-1 m-0 " ng-if="submit_type"
                                                    ng-click="confirmSave('submit_genarate')">
                                                <i class="fa-solid far fa-file-pdf  text-danger" ng-if="!(item.sub_expense_type=='Study' || item.sub_expense_type=='Internal Study')"></i> Genarate Full Report
                                            </button>
                                            <br>
                                            <button class="float-end btn btn-outline btn-sm p-1 m-1" ng-click="toggleFullscreen()">
                                                <i class="fas fa-expand" style="color: #a1a1a6"></i>
                                            </button>
                                            <div class="float-end align-top pt-2 ms-1 d-none" ng-class="{'tab-pane fade show active':!(data_header[0].pha_status==12)}">
                                                <div class="float-end pe-3">
                                                    <div class="form-check form-switch cursor-pointer">
                                                        <input class="form-check-input" id="sceSwitchCheckChecked"
                                                               type="checkbox"
                                                               ng-click="safety_critical_equipment_show()" />
                                                        <label class="form-check-label" for="sceSwitchCheckChecked cursor-pointer" style="color:#a1a1a6">Open SCE</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>


                            </div>

                            <div class=" border-bottom  " id="fullscreenzone" style="background-color: #ffffff;">

                                <div class="table-responsive scrollbar tableFixHead " id="table-container" style="min-height:400px;">
                                    <table class="table fs--2 mb-0 table-bordered " cellpadding="0" cellspacing="0">
                                        <thead class=" text-uppercase  text-center  bg-soft  test" style="font-size: 10px;" id="myHeader">
                                            <tr>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important; width: 200px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[0].title_th}}  {{data_tooltip[0].title_en}}">
                                                    List System
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important; width: 200px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[1].title_th}}  {{data_tooltip[1].title_en}}">
                                                    List Sub System
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important; width: 200px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[2].title_th}}  {{data_tooltip[2].title_en}}">
                                                    What If (cause)
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important; width: 200px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[3].title_th}}  {{data_tooltip[3].title_en}}">
                                                    Consequence
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important;"
                                                    ng-if="select_columns_level == 5"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[4].title_th}}  {{data_tooltip[4].title_en}}">
                                                    CAT<br>(P/A/E/R/Q) 
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="3" 
                                                    rowspan="1" 
                                                    scope="col" 
                                                    style="padding: 0 !important;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[5].title_th}}  {{data_tooltip[5].title_en}}">
                                                    Risk<br>Assessment
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    scope="col" 
                                                    style="padding: 0 !important; width:100px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[6].title_th}}  {{data_tooltip[6].title_en}}"> 
                                                    Safeguard / Mitigation
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="3" 
                                                    rowspan="1" 
                                                    style="padding: 0 !important;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[7].title_th}}  {{data_tooltip[7].title_en}}">
                                                    Residual Risk 
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    scope="col" 
                                                    style="padding: 0 !important; width: 50px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[8].title_th}}  {{data_tooltip[8].title_en}}"> 
                                                    Action<br />No
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important; width: 200px;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[9].title_th}}  {{data_tooltip[9].title_en}}">
                                                    Recommendations
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    style="padding: 0 !important;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[10].title_th}}  {{data_tooltip[10].title_en}}">
                                                    Responder
                                                </th>
                                                <th class=" align-middle   mx-0" 
                                                    colspan="1" 
                                                    rowspan="2" 
                                                    scope="col" 
                                                    style="padding: 0 !important;"
                                                    data-toggle="tooltip" 
                                                    data-placement="top" 
                                                    title="{{data_tooltip[11].title_th}}  {{data_tooltip[11].title_en}}">
                                                    Action<br>Status
                                                </th>
                                            </tr>
                                            <tr>
                                                <th class=" align-middle  mx-0" scope="col" style="padding: 0 !important;">S</th>
                                                <th class=" align-middle  mx-0" scope="col" style="padding: 0 !important;">L</th>
                                                <th class=" align-middle  mx-0" scope="col" style="padding: 0 !important;">R</th>
                                                <th class=" align-middle  mx-0" scope="col" style="padding: 0 !important;">S</th>
                                                <th class=" align-middle  mx-0" scope="col" style="padding: 0 !important;">L</th>
                                                <th class=" align-middle  mx-0" scope="col" style="padding: 0 !important;">R</th>
                                            </tr>
                                        </thead>
                                        <tbody class="">
                                            <tr class="rowwork border border-dashed"
                                                ng-if="( data_tasklist.length == 1 ? (data_tasklist[0].list == null ? false : true) : true) "
                                                ng-repeat="item in data_listworksheet | toArray | filter:{id_list : selectedItemListView} | orderBy:'index_row'">
                                                @* List system*@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='list_system'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.list_system_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('list_system',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider"></div>        
                                                                    <a class="dropdown-item text-primary" ng-click="copyList('list_system',item.seq)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Copy
                                                                    </a>
                                                                    <div class="dropdown-divider" ng-if="data_copy"></div>        
                                                                    <a class="dropdown-item" ng-if="data_copy" ng-click="pasteList('list_system',item.seq)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Paste
                                                                    </a>                                                                    
                                                                    <div class="dropdown-divider " ng-if="!(item.list_system_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" ng-if="!(item.list_system_no == 1)"
                                                                       ng-click="remove_listworksheet('list_system',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 100vh; font-size: 10px;"
                                                                      id="list_worksheet_{{item.seq}}" 
                                                                      name="list_worksheet_{{item.seq}}"
                                                                      placeholder="List System" 
                                                                      rows="3"
                                                                      ng-model="item.list_system"
                                                                      ng-keyup="filterResultHistory(item.list_system, 'list', 'list_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;" ng-show="isShow == 'list_worksheet_'+ item.seq"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('list_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('liat_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | toArray | filter:{field:'list'}"
                                                                     ng-click="selectResult(result,item,'list')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="valid-worksheet-listsystem-{{item.seq}}"
                                                         class="invalid-feedback text-danger">
                                                        Please provide a valid List System.
                                                    </div>
                                                </td>

                                                @* List sub system *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='list_system' || item.row_type =='list_sub_system'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.list_system_no +'.'+item.list_sub_system_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('list_sub_system',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.list_sub_system_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" ng-if="!(item.list_sub_system_no == 1)"
                                                                       ng-click="remove_listworksheet('list_sub_system',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> 
                                                                        Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 200px; font-size: 10px;"
                                                                      id="listsub_worksheet_{{item.seq}}" 
                                                                      name="listsub_worksheet_{{item.seq}}"
                                                                      placeholder="List Sub System"
                                                                      rows="3"
                                                                      ng-model="item.list_sub_system"
                                                                      ng-keyup="filterResultHistory(item.list_sub_system, 'listsub', 'listsub_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;" ng-show="isShow == 'listsub_worksheet_'+ item.seq"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('listsub_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('listsub_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | toArray | filter:{field:'listsub'}"
                                                                     ng-click="selectResult(result,item,'listsub')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="valid-worksheet-listsubsystem-{{item.seq}}"
                                                         class="invalid-feedback text-danger">
                                                        Please provide a valid List Sub System.
                                                    </div>
                                                </td>

                                                @* Cause *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type == 'list_system' || item.row_type =='list_sub_system' || item.row_type =='causes'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.list_system_no +'.'+ item.list_sub_system_no + '.'+item.causes_no }}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('causes',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.causes_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" ng-if="!(item.causes_no == 1)"
                                                                       ng-click="remove_listworksheet('causes',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 200px; font-size: 10px;"
                                                                      id="causes_worksheet_{{item.seq}}" 
                                                                      name="causes_worksheet_{{item.seq}}"
                                                                      placeholder="What's If (causes)" 
                                                                      rows="3"
                                                                      ng-model="item.causes"
                                                                      ng-keyup="filterResultHistory(item.causes, 'causes', 'causes_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;" ng-show="isShow == 'listsub_worksheet_'+ item.seq"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('causes_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('causes_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | toArray | filter:{field:'causes'}"
                                                                     ng-click="selectResult(result,item,'causes')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="valid-worksheet-causes-{{item.seq}}"
                                                         class="invalid-feedback text-danger">
                                                        Please provide a valid Causes.
                                                    </div>
                                                </td>

                                                @* Consequence *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='list_system' || item.row_type =='list_sub_system' || item.row_type =='causes' || item.row_type =='consequences'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.list_system_no +'.'+item.list_sub_system_no + '.'+item.causes_no  +'.'+item.consequences_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('consequences',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.consequences_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" ng-if="!(item.consequences_no == 1)"
                                                                       ng-click="remove_listworksheet('consequences',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 200px; font-size: 10px;"
                                                                      id="consequences_worksheet_{{item.seq}}" 
                                                                      name="consequences_worksheet_{{item.seq}}"
                                                                      placeholder="Consequences" 
                                                                      rows="3"
                                                                      ng-model="item.consequences"
                                                                      ng-keyup="filterResultHistory(item.consequences, 'consequences', 'consequences_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;" ng-show="isShow == 'consequences_worksheet_'+ item.seq"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('consequences_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('consequences_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | toArray | filter:{field:'consequences'}"
                                                                     ng-click="selectResult(result,item,'consequences')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="valid-worksheet-consequences-{{item.seq}}"
                                                         class="invalid-feedback text-danger">
                                                        Please provide a valid Consequences.
                                                    </div>
                                                </td>

                                                @* cat *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 70px;"
                                                    ng-if="select_columns_level == 5">
                                                    <div class="d-flex align-items-top px-0" style="width: 70px;">
                                                        <div class="align-top font-sans-serif btn-reveal-trigger position-static pt-1 mx-0 px-0" style="width: 20px;">
                                                            <p class="p-0 m-0 me-1 text-end d-none">
                                                                {{item.seq}}x{{item.seq_category}}
                                                            </p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1 mx-1 border border-end-0 border-top-0 text-center"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('category',item)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider "></div>
                                                                    <a class="dropdown-item text-danger" ng-click="remove_listworksheet('category',item,$index)"><span class="fas fa-times-circle"></span> Remove</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <select class="form-select rounded-1 mx-1 p-1  border-start-0  border-end-0 border-top-0 "
                                                                ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                ng-change="actionChangeWorksheet(item,item.seq,'')" ng-model="item.category_type">
                                                            <option ng-selected="item.category_type == item2.id"
                                                                    ng-repeat="item2 in DataCategory" ng-value="item2.id">
                                                                {{item2.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </td>

                                                @* risk assesment start *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;"
                                                         ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'s',item.seq,'befor')">
                                                            <div class="d-flex"><h6 class="me-1">{{item.ram_befor_security}}</h6> <span class="fas fa-pencil-alt fa-sm d-none" style=" width: 8px;"></span> </div>
                                                        </button>
                                                    </div>
                                                </td>

                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" 
                                                            style=" width: 20px;"
                                                            ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" 
                                                                ng-click="openModalDataRAM_Worksheet(item,'l',item.seq,'befor')">
                                                            <div class="d-flex"><h6 class="me-1">{{item.ram_befor_likelihood}}</h6> <span class="fas fa-pencil-alt fa-sm d-none" style=" width: 8px;"></span> </div>
                                                        </button>
                                                    </div>
                                                </td>
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 30px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 30px;">
                                                        <button ng-style=" { 'background-color' : ((item.ram_befor_risk == 'H') ? 'red' : ((item.ram_befor_risk == 'M') ? 'yellow' : ((item.ram_befor_risk == 'L') ? 'green' : '#D3D3D3')) ) }"
                                                                class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" 
                                                                ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                ng-click="openModalDataRAM_Worksheet(item,'r',item.seq,'befor')" 
                                                                style="width: 30px;">
                                                            <div class="d-flex text-center" style=" width: 20px;">
                                                                <h6 class="me-1 text-center" style=" width: 20px;">{{item.ram_befor_risk}}</h6>
                                                                <span class="fas fa-pencil-alt fa-sm " style=" width: 8px;"></span>
                                                            </div>
                                                        </button>
                                                    </div>
                                                </td>
                                                @* risk assesment end *@


                                                @* Safeguard / Mitigation *@
                                                <td id="td_safeguards" class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-center w-100" ng-if="!(item.row_type =='category' || item.row_type =='category')">
                                                        <div class="autocomplete-container" ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 400px; font-size: 10px;"
                                                                      id="safeguards_worksheet_{{item.seq}}" 
                                                                      name="safeguards_worksheet_{{item.seq}}"
                                                                      placeholder="PROTECTION/MITIGATION BARRIERS" 
                                                                      rows="3"
                                                                      ng-model="item.existing_safeguards"
                                                                      ng-keyup="filterResultHistory(item.existing_safeguards, 'safeguards', 'safeguards_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('safeguards_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('safeguards_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | toArray | filter:{field:'safeguards'}"
                                                                     ng-click="selectResult(result,item,'safeguards')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* Residual Risk start *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;" ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'s',item.seq,'after')">
                                                            <div class="d-flex"><h6 class="me-1">{{item.ram_after_security}}</h6> <span class="fas fa-pencil-alt fa-sm d-none" style=" width: 8px;"></span> </div>
                                                        </button>
                                                    </div>
                                                </td>

                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;" ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'l',item.seq,'after')">
                                                            <div class="d-flex"><h6 class="me-1">{{item.ram_after_likelihood}}</h6> <span class="fas fa-pencil-alt fa-sm d-none" style=" width: 8px;"></span> </div>
                                                        </button>
                                                    </div>
                                                </td>
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 30px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 30px;">
                                                        <button ng-style=" { 'background-color' : ((item.ram_after_risk == 'H') ? 'red' : ((item.ram_after_risk == 'M') ? 'yellow' : ((item.ram_after_risk == 'L') ? 'green' : '#D3D3D3')) ) }"
                                                                class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" 
                                                                ng-click="openModalDataRAM_Worksheet(item,'r',item.seq,'after')" 
                                                                style="width: 30px;">
                                                            <div class="d-flex text-center" style=" width: 25px;"><h6 class="me-1 text-center" style=" width: 30px;">{{item.ram_after_risk}}</h6><span class="fas fa-pencil-alt fa-sm " style=" width: 8px;"></span></div>
                                                        </button>
                                                    </div>
                                                </td>

                                                @* Recommendations no*@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-top w-100">
                                                        <div class="autocomplete-container" ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                             ng-if="item.recommendations!=''">
                                                            @* {{item.recommendations_no}} *@
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0 text-center"
                                                                      style=" width: 50px; font-size: 10px;"
                                                                      placeholder="No" rows="1"
                                                                      ng-model="item.recommendations_no"
                                                                      ng-keyup="actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* Recommendations *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important;">
                                                    <div class="d-flex align-items-top w-100">
                                                        <span class=" font-sans-serif btn-reveal-trigger position-static pt-1 disabled-link d-none"
                                                              ng-class="{'d-none':(!tab_worksheet_active)}">
                                                            <button data-bs-toggle="modal" 
                                                                    data-bs-target="#modalSuggestionRecommendations"
                                                                    class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1">
                                                                <span class="fas fa-lightbulb text-warning align-top"></span>
                                                            </button>
                                                        </span>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 400px; font-size: 10px;"
                                                                      id="recommendations_worksheet_{{item.seq}}" 
                                                                      name="recommendations_worksheet_{{item.seq}}"
                                                                      placeholder="Recommendations" 
                                                                      rows="3"
                                                                      ng-model="item.recommendations"
                                                                      ng-keyup="filterResultHistory(item.recommendations, 'recommendations', 'recommendations_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;" ng-show="showResults"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('recommendations_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('recommendations_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | toArray | filter:{field:'recommendations'}"
                                                                     ng-click="selectResult(result,item,'recommendations')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* Responder *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important; width: 120px;">
                                                    <div class="d-flex align-items-center">
                                                        <div ng-class="{'disabled-link': !action_owner_active || item.action_status === 'Responed'}">
                                                            <button ng-click="openDataEmployeeAdd(item, 'owner')" 
                                                                    class="btn btn-link px-0 mx-1"
                                                                    data-toggle="tooltip" 
                                                                    data-placement="top" 
                                                                    ng-if="action_owner_active && item.action_status !== 'Responed'"
                                                                    title="Add Employee">
                                                                <span class="far fa-address-book"></span>
                                                            </button>
                                                            <button class="btn btn-sm transition-none btn-reveal fs--2 p-1" 
                                                                    type="button"
                                                                    ng-click="removeDataEmpWorkSheet('worksheet', item.seq)"
                                                                    ng-if="item.responder_id > 0">
                                                                <span class="fas fa-times text-danger"></span>
                                                            </button>
                                                        </div>
                                                        <p class="m-0 text-1100 fw-bold" style="width: 115px;">
                                                            {{ item.action_project_team === false ? item.responder_user_displayname : item.project_team_text }}
                                                        </p>
                                                    </div>

                                                    <div id="valid-worksheet-responder-{{item.seq}}"
                                                         class="invalid-feedback text-danger">
                                                        Please provide a valid Responder.
                                                    </div>
                                                </td>

                                                @* Action Status *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 50px;">
                                                    <div class="align-items-center text-end mt-1" style="width: 50px;" ng-if="!item.action_project_team">
                                                        <button ng-style="{ 'background-color': (item.action_status === 'Closed' ? 'success' : 'secondary') }"
                                                                class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end" type="button">
                                                            <div class="text-center" style="width: 50px;">
                                                                <h6 class="me-1 text-center" style="width: 50px;">{{ item.action_status }}</h6>
                                                            </div>
                                                        </button>
                                                    </div>

                                                    <select class="form-control px-1 "
                                                            ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                            ng-if="item.action_project_team" ng-model="item.action_status">
                                                        <option value="N/A">N/A</option>
                                                        <option value="Waiting for detail design" title="Waiting for detail design">Waiting for detail design</option>
                                                    </select>
                                                </td>

                                            </tr>
                                        </tbody>

                                    </table>

                                </div>

                            </div>
                            <div class="align-items-center mb-5 mt-2">
                                <div class="form-check form-switch cursor-pointer">
                                    <input class="form-check-input cursor-pointer" name="sceSwitchNoteChecked" id="sceSwitchNoteChecked"
                                           type="checkbox"
                                           ng-click="node_note_show()" />
                                    <label class="form-check-label cursor-pointer" for="sceSwitchNoteChecked" style="color:#a1a1a6"><b>Note:</b> </label>
                                </div>

                                <div class="form-floating d-none" id="div_node_note" name="div_node_note" ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                    <textarea class="form-control rounded-1" placeholder="Note"
                                              ng-repeat="item in data_tasklist | toArray | filter:{id:selectedItemListView}"
                                              ng-if="item.id == selectedItemListView"
                                              ng-model="item.descriptions"
                                              style="height: 50px"></textarea>

                                </div>

                            </div>


                            <!--Modal Suggestion List (Causes) Start-->
                            <div class="modal fade modal-xl shadow-sm p-3 mb-5  rounded" id="modalSuggestionCauses" tabindex="-1"
                                 aria-labelledby="modalSuggestionCausesLabel" aria-hidden="true" style="display: none;">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="modalSuggestionCausesLabel">Suggestion List (Causes)</h5>

                                            <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                                                <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                                                     data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                                                     data-fa-i2svg="">
                                                    <path fill="currentColor"
                                                          d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                                                    </path>
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="modal-body">

                                            <div class="mb-4">
                                                <div class="row g-3">
                                                    <div class="col-auto d-flex">
                                                        <p class="pe-2"><b>Deviations : </b>Less of</p>
                                                        <p><b>GuideWords : </b>Less/Low Pressure</p>
                                                    </div>
                                                </div>

                                                <div class="row g-3">
                                                    <div class="col-auto d-flex">
                                                        <div class="search-box p-1">
                                                            <form class="position-relative" data-bs-toggle="search" data-bs-display="static">
                                                                <input class="form-control search-input search" type="search" placeholder="Search Causes "
                                                                       aria-label="Search" />
                                                                <span class="fas fa-search search-box-icon"></span>

                                                            </form>
                                                        </div>

                                                        <div class="search-box p-1">

                                                            <div class="col-auto scrollbar overflow-hidden-y flex-grow-1">
                                                                <div class="btn-group position-static" role="group">
                                                                    <div class="btn-group position-static text-nowrap">
                                                                        <button class="btn btn-phoenix-secondary px-7 flex-shrink-0" type="button"
                                                                                data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true"
                                                                                aria-expanded="false" data-bs-reference="parent">
                                                                            ACTION TYPE<span class="fas fa-angle-down ms-2"></span>
                                                                        </button>
                                                                        <ul class="dropdown-menu">
                                                                            <li><a class="dropdown-item">ALL</a></li>
                                                                            <li><a class="dropdown-item">ACTIVE</a></li>
                                                                            <li><a class="dropdown-item">INACTIVE</a></li>
                                                                        </ul>
                                                                    </div>

                                                                    <button class="btn btn-phoenix-primary  ms-1  float-end bg-light-primary">
                                                                        <a class="dropdown-item text-primary">
                                                                            <span class="fas fa-check"></span>
                                                                            Apply
                                                                        </a>
                                                                    </button>
                                                                </div>

                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <!--Modal Suggestion List (Causes) End-->
                            <!--Modal Suggestion List (Recommendations) Start-->
                            <div class="modal fade modal-xl shadow-sm p-3 mb-5  rounded" id="modalSuggestionRecommendations" tabindex="-1"
                                 aria-labelledby="modalSuggestionRecommendationsLabel" aria-hidden="true" style="display: none;">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="modalSuggestionRecommendationsLabel">Suggestion List (Recommendations)</h5>

                                            <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                                                <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                                                     data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                                                     data-fa-i2svg="">
                                                    <path fill="currentColor"
                                                          d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                                                    </path>
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="modal-body">

                                            <div class="mb-4">
                                                <div class="row g-3">
                                                    <div class="col-auto d-flex">
                                                        <p class="pe-2"><b>Deviations : </b>Less of</p>
                                                        <p class="pe-2"><b>GuideWords : </b>Less/Low Pressure</p>
                                                        <p class="pe-2"><b>Causes : </b>Operator fails to align correct lines/valves</p>
                                                    </div>
                                                </div>

                                                <div class="row g-3">
                                                    <div class="col-auto d-flex">
                                                        <div class="search-box p-1">
                                                            <form class="position-relative" data-bs-toggle="search" data-bs-display="static">
                                                                <input class="form-control search-input search" type="search"
                                                                       placeholder="Search Recommendations" aria-label="Search" />
                                                                <span class="fas fa-search search-box-icon"></span>

                                                            </form>
                                                        </div>

                                                        <div class="search-box p-1">

                                                            <div class="col-auto scrollbar overflow-hidden-y flex-grow-1">
                                                                <div class="btn-group position-static" role="group">
                                                                    <div class="btn-group position-static text-nowrap">
                                                                        <button class="btn btn-phoenix-secondary px-7 flex-shrink-0" type="button"
                                                                                data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true"
                                                                                aria-expanded="false" data-bs-reference="parent">
                                                                            ACTION TYPE<span class="fas fa-angle-down ms-2"></span>
                                                                        </button>
                                                                        <ul class="dropdown-menu">
                                                                            <li><a class="dropdown-item">ALL</a></li>
                                                                            <li><a class="dropdown-item">ACTIVE</a></li>
                                                                            <li><a class="dropdown-item">INACTIVE</a></li>
                                                                        </ul>
                                                                    </div>

                                                                    <button class="btn btn-phoenix-primary  ms-1  float-end bg-light-primary">
                                                                        <a class="dropdown-item text-primary">
                                                                            <span class="fas fa-check"></span>
                                                                            Apply
                                                                        </a>
                                                                    </button>
                                                                </div>

                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-white border-top border-bottom border-200 position-relative top-1">
                                                <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                                                    <table class="table table-sm fs--1 mb-0">
                                                        <thead class=" text-uppercase">
                                                            <tr>
                                                                <th class="white-space-nowrap fs--1 align-middle ps-0" style="width:5%;">Active</th>
                                                                <th class=" align-middle pe-5" scope="col" data-sort="sort_causes" style="width:30%">
                                                                    Recommendations
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class=" list" id="customers-table-body">
                                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                                <td class="fs--1 align-middle ps-0 py-3">
                                                                    <input class="form-check-input text-end bg-glay" id="flexCheckChecked" disabled
                                                                           type="checkbox" value="" checked="">
                                                                </td>
                                                                <td class="align-middle white-space-nowrap text-1000 pe-5">
                                                                    Position indicator on valve
                                                                </td>
                                                            </tr>
                                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                                <td class="fs--1 align-middle ps-0 py-3">
                                                                    <input class="form-check-input text-end bg-glay" id="flexCheckChecked" type="checkbox"
                                                                           value="" checked="">
                                                                </td>
                                                                <td class="align-middle white-space-nowrap text-1000 pe-5">
                                                                    Labeling of lines in the
                                                                    field
                                                                    fails CV closed
                                                                </td>
                                                            </tr>
                                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                                <td class="fs--1 align-middle ps-0 py-3">
                                                                    <input class="form-check-input text-end bg-glay" id="flexCheckChecked" type="checkbox"
                                                                           value="" checked="">
                                                                </td>
                                                                <td class="align-middle white-space-nowrap text-1000 pe-5">
                                                                    Car seals on critical valves
                                                                </td>
                                                            </tr>
                                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                                <td class="fs--1 align-middle ps-0 py-3">
                                                                    <input class="form-check-input text-end bg-glay" id="flexCheckChecked" type="checkbox"
                                                                           value="" checked="">
                                                                </td>
                                                                <td class="align-middle white-space-nowrap text-1000 pe-5">
                                                                    Procedures for routing of
                                                                    lines
                                                                </td>
                                                            </tr>
                                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                                <td class="fs--1 align-middle ps-0 py-3">
                                                                    <input class="form-check-input text-end bg-glay" id="flexCheckChecked" type="checkbox"
                                                                           value="" checked="">
                                                                </td>
                                                                <td class="align-middle white-space-nowrap text-1000 pe-5">
                                                                    Unique connectors for
                                                                    flexible lines
                                                                </td>
                                                            </tr>
                                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                                <td class="fs--1 align-middle ps-0 py-3">
                                                                    <input class="form-check-input text-end bg-glay" id="flexCheckChecked" type="checkbox"
                                                                           value="" checked="">
                                                                </td>
                                                                <td class="align-middle white-space-nowrap text-1000 pe-5">
                                                                    Color coded lines, connectors
                                                                </td>
                                                            </tr>

                                                        </tbody>
                                                    </table>
                                                </div>

                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <!--Modal Suggestion List (Recommendations) End-->


                        </div>

                    </div>

                    <!-- What's Worksheet -->
                    <!-- manage recment -->
                    <div class="" 
                        ng-class="{
                            'tab-pane fade show active':(action_part==6),
                            'tab-pane fade show active':(tabs[5].isActive),
                            'tab-pane fade':(action_part!==6)}"
                         id="tab-manage" role="tabpanel" aria-labelledby="manage-tab">

                        <div class=" border-bottom border-200 my-0" id="NodeTable">
                            <div class="table-responsive scrollbar">
                                <table class="table fs--2 mb-0">
                                    <thead class=" text-uppercase text-center">
                                        <tr>
                                            <th class=" align-middle" colspan="1" rowspan="3">Recommen<br />dations<br />No</th>
                                            <th class=" align-middle" colspan="1" rowspan="3">Task</th>
                                            <th class=" align-middle" colspan="1" rowspan="3">Casuse No.</th>
                                            <th class=" align-middle text-start" colspan="1" rowspan="3">Recommendations</th>
                                            <th class=" align-middle" colspan="1" rowspan="3">Action Owner</th>
                                            <th class=" align-middle" colspan="1" rowspan="3" ng-if="data_header[0].pha_status >12">Document File</th>
                                            <th class=" align-middle" colspan="2" rowspan="1">
                                                Risk Assessment Matrix
                                            </th>
                                            <th class=" align-middle" colspan="1" rowspan="3">Action<br />Status<br />(Items)</th>
                                            <th class=" align-middle " colspan="2" rowspan="1">
                                                <b class="text-danger"> * </b>Recommendations Close Plan
                                            </th>
                                            <th class=" align-middle" colspan="1" rowspan="3">Action Close Date</th>
                                        </tr>
                                        <tr>
                                            <th class=" align-middle" scope="col" colspan="1" rowspan="1" title="MITIGATED RISK ASSESSMENT MATRIX">Before Action</th>
                                            <th class=" align-middle" scope="col" colspan="1" rowspan="1">After Action</th>
                                            <th class=" align-middle" scope="col" rowspan="2">Start Date</th>
                                            <th class=" align-middle" scope="col" rowspan="2">End Date</th>
                                        </tr>
                                        <tr class="text-center">
                                            <th class="sort align-middle " scope="col">
                                                <div class="d-flex ">
                                                    <div class="align-items-center ">
                                                        <p class="transition-none btn-reveal fs--2p-1 ps-0 text-center rounded-1" style="width: 20px; height:20px">
                                                            S
                                                        </p>
                                                    </div>

                                                    <div class="align-items-center ">
                                                        <p class="transition-none btn-reveal fs--2p-1 ps-0 text-center rounded-1" style="width: 20px; height:20px">
                                                            L
                                                        </p>
                                                    </div>

                                                    <div class="align-items-center ">
                                                        <p class="transition-none btn-reveal fs--2p-1 ps-0 text-center rounded-1" style="width: 20px; height:20px">
                                                            R
                                                        </p>
                                                    </div>
                                                </div>
                                            </th>
                                            <th class="sort align-middle " scope="col">
                                                <div class="d-flex ">
                                                    <div class="align-items-center ">
                                                        <p class="transition-none btn-reveal fs--2p-1 ps-0 text-center rounded-1" style="width: 20px; height:20px">
                                                            S
                                                        </p>
                                                    </div>

                                                    <div class="align-items-center ">
                                                        <p class="transition-none btn-reveal fs--2p-1 ps-0 text-center rounded-1" style="width: 20px; height:20px">
                                                            L
                                                        </p>
                                                    </div>

                                                    <div class="align-items-center ">
                                                        <p class="transition-none btn-reveal fs--2p-1 ps-0 text-center rounded-1" style="width: 20px; height:20px">
                                                            R
                                                        </p>
                                                    </div>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>

                                    <tbody class="list" id="customer-rating-table-body">
                                        <tr ng-repeat="item in data_listworksheet | orderBy:['list_no','no']"
                                            ng-if="( !(item.recommendations == null)) == true  "
                                            class="hover-actions-trigger btn-reveal-trigger position-static text-center"> <!----- || item.responder_user_name == null ------->

                                            <td class="align-top rating white-space-nowrap text-start">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.recommendations_no}}
                                                    </label>
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.list_no+'.'}}
                                                    </label>
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.causes_no+'.'}}
                                                    </label>
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap text-start">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.recommendations}}
                                                    </label>
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.action_project_team === false ? item.responder_user_displayname : item.project_team_text}}
                                                    </label>
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap" ng-if="data_header[0].pha_status >12">
                                                <div class="ms-3 text-start d-none">
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileOwner(item)"
                                                       ng-if="!(item.document_file_path =='' || item.document_file_path == null)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Responder has attached the file.
                                                    </a>
                                                    <br ng-if="!(item.document_file_admin_path =='')" />
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileReviewer(item)"
                                                       ng-if="!(item.document_file_admin_path =='' || item.document_file_path == null)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Reviewer has attached the file.
                                                    </a>
                                                </div>
                                                <div class="ms-3 text-start"
                                                     ng-repeat="item_x in data_drawingworksheet_responder | toArray | filter:{id_worksheet:item.seq}"
                                                     ng-click="downloadFileOwner(item)"
                                                     ng-if="$index == 0">
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileOwner(item)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Responder has attached the file.
                                                    </a>
                                                </div>
                                                <div class="ms-3 text-start"
                                                     ng-repeat="item_x in data_drawingworksheet_reviewer | toArray | filter:{id_worksheet:item.seq}"
                                                     ng-click="downloadFileReviewer(item)"
                                                     ng-if="$index == 0">
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileReviewer(item)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Reviewer has attached the file.
                                                    </a>
                                                </div>

                                            </td>

                                            <td class="align-top rating white-space-nowrap ">
                                                <div class="d-flex align-items-top text-end ">
                                                    <div class="d-flex align-items-top justify-content-center" style="min-height: 52px;">
                                                        <p class="transition-none fs--2p-1 ps-0 p-1 text-center rounded-1 cursor-pointer"
                                                        style="width: 20px; height:20px; margin: 0;">
                                                            {{item.ram_after_security}}
                                                        </p>
                                                    </div>

                                                    <div class="d-flex align-items-top justify-content-center" style="min-height: 52px;">
                                                        <p class="transition-none fs--2p-1 ps-0 p-1 text-center rounded-1 cursor-pointer"
                                                        style="width: 20px; height:20px; margin: 0;">
                                                            {{item.ram_after_likelihood}}
                                                        </p>
                                                    </div>

                                                    <div class="d-flex align-items-top justify-content-center text-end" 
                                                         ng-class="{ 'no-drop': !canAccess(item_d), 'cursor-pointer': canAccess(item_d) }"
                                                         style=" width: 30px;height:30px">
                                                        <button
                                                            ng-style=" { 'background-color' : ((item.ram_after_risk == 'H') ? 'red' : ((item.ram_after_risk == 'M') ? 'yellow' : ((item.ram_after_risk == 'L') ? 'green' : '#D3D3D3')) ) }"
                                                            class="btn btn-sm dropdown-toggle h-100 dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                            ng-class="{ 'cant-Access': !canAccess(item_d) }"
                                                            type="button"
                                                            style="width: 30px;">
                                                            <div class="d-flex text-center"
                                                                style=" width: 25px;">
                                                                <h6 class="me-1 text-center"
                                                                    style=" width: 30px;">
                                                                    {{item.ram_after_risk}}</h6>
                                                            </div>
                                                        </button>
                                                    </div>
                                                </div>
                                            </td>

                                            <td class="align-top rating white-space-nowrap " ng-class="{'disabled-link':(!tab_managerecom_active)}">
                                                <div class="d-flex align-items-top text-end ">
                                                    <div class="d-flex align-items-top justify-content-center" style="min-height: 52px;">
                                                        <p class="transition-none fs--2p-1 ps-0 p-1 text-center rounded-1 cursor-pointer"
                                                            style="width: 20px; height:20px; margin: 0;"
                                                            ng-click="openModalDataRAM_Worksheet(item,'s',item.seq,'after',item.id_ram)">
                                                            {{item.ram_action_security}}
                                                        </p>
                                                    </div>

                                                    <div class="d-flex align-items-top justify-content-center" style="min-height: 52px;">
                                                        <p class="transition-none fs--2p-1 ps-0 p-1 text-center rounded-1 cursor-pointer"
                                                            style="width: 20px; height:20px; margin: 0;"
                                                            ng-click="openModalDataRAM_Worksheet(item,'r',item.seq,'action',item.id_ram)">
                                                            {{item.ram_action_likelihood}}
                                                        </p>
                                                    </div>
                                                    
                                                    <div class="align-items-top text-end cursor-pointer" 
                                                         ng-class="{ 'no-drop': !canAccess(item_d), 'cursor-pointer': canAccess(item_d) }"
                                                         style=" width: 30px;height:30px">
                                                        <button
                                                            ng-style=" { 'background-color' : ((item.ram_action_risk == 'H') ? 'red' : ((item.ram_action_risk == 'M') ? 'yellow' : ((item.ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }"
                                                            class="btn btn-sm dropdown-toggle h-100 cursor-pointer dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                            type="button"
                                                            ng-click="openModalDataRAM_Worksheet(item,'r',item.seq,'action',item.id_ram)"
                                                            style="width: 30px;">
                                                            <div class="d-flex text-center"
                                                                style=" width: 25px;">
                                                                <h6 class="me-1 text-center"
                                                                    style=" width: 30px;">
                                                                    {{item.ram_action_risk}}</h6>
                                                                <span class="fas fa-pencil-alt fa-sm "
                                                                    style=" width: 8px;"></span>
                                                            </div>
                                                        </button>
                                                    </div>                                                    
                                                </div>

                                            </td>

                                            <td class="align-top rating white-space-nowrap">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.action_status}}
                                                    </label>
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap">
                                                <input type="date" class="form-control datetimepicker rounded-1" ng-class="{'disabled-link':(!tab_managerecom_active)}"
                                                       placeholder="Start Date dd/mm/yyyy"
                                                       ng-model="item.estimated_start_date"
                                                       ng-change="actionChangeWorksheet(item,item.seq,'')">


                                                <div id="valid-worksheet-estimated-start-{{item.seq}}"
                                                     class="invalid-feedback text-danger">
                                                    Please provide a valid Estimated Start.
                                                </div>
                                            </td>
                                            <td class="align-top rating white-space-nowrap">
                                                <input type="date" class="form-control  datetimepicker rounded-1" ng-class="{'disabled-link':(!tab_managerecom_active)}"
                                                       placeholder="End Date dd/mm/yyyy"
                                                       min="{{ item.estimated_start_date | date:'yyyy-MM-dd' }}"
                                                       ng-model="item.estimated_end_date"
                                                       ng-change="actionChangeWorksheet(item,item.seq,'')">
                                                <div id="valid-worksheet-estimated-end-{{item.seq}}"
                                                     class="invalid-feedback text-danger">
                                                    Please provide a valid Estimated End.
                                                </div>
                                            </td>
                                            <td class="align-top  px-0" style=" width: 80px;">
                                                <div class="align-items-center ">
                                                    <p><b>{{item.reviewer_date}}</b></p>
                                                </div>
                                            </td>

                                        </tr>
                                    </tbody>

                                </table>
                            </div>
                        </div>

                    </div>
                    <!-- manage recment -->
                    <!-- ta2 approver -->
                    <div class="" 
                        ng-class="{
                            'tab-pane fade show active':(action_part==7),
                            'tab-pane fade show active':(tabs[6].isActive),
                            'tab-pane fade':(action_part!==7)}"
                         id="tab-approver" role="tabpanel" aria-labelledby="approver-tab">

                        <div class="m-3 row  gx-0 align-items-center">

                            <div class=" border-bottom border-200 my-0" id="ApproverTable">
                                <div class="table-responsive scrollbar">
                                    <table class="table fs--2 mb-0">
                                        <thead class=" text-uppercase text-center">
                                            <tr>
                                                <th class=" align-middle">No</th>
                                                <th class=" align-middle">Approver</th>
                                                <th class=" align-middle">Status</th>
                                                <th class=" align-middle"><b class="text-danger" ng-if="item.action_status == 'reject'"> * </b>Comment</th>
                                                <th class=" align-middle">Document File</th>
                                                <th class=" align-middle">Action Date</th>
                                                <th class=" align-middle"></th>
                                                @* user_displayname, action_status, date_review *@
                                            </tr>
                                        </thead>

                                        <tbody class="list" id="customer-rating-table-body">
                                            <tr ng-repeat="item in data_approver" 
                                                ng-init="accessInfo = Access_check(item)"
                                                ng-style="{ 'background-color': accessInfo.canAccess ? '' : '#f9fbff' }"
                                                ng-class="{ 'task-highlight':  accessInfo.canAccess}"                                                   class="hover-actions-trigger btn-reveal-trigger position-static text-center">
                                                <!--------ng-if="(item.user_name == user_name ) || (flow_role_type == 'admin')"---------------------->
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{$index + 1}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap">
                                                    <div class="d-flex align-items-center d-none">
                                                        <div class="col-md-12 p-1 ps-3 d-flex justify-content-between align-items-center">
                                                            <div ng-if="params == 'edit_approver'">
                                                                <button 
                                                                    ng-click="
                                                                        openDataEmployeeAdd(item, 'edit_approver', $index); 
                                                                        recommentAction_valid(item);" 
                                                                    class="btn btn-link px-0 mx-1"
                                                                    ng-class="{'no-drop': item.approver_action_type == 2 || data_header[0].pha_status != 21}"
                                                                    ng-disabled="item.approver_action_type == 2 || data_header[0].pha_status != 21"
                                                                    data-toggle="tooltip" 
                                                                    title="Add Employee">
                                                                    <span class="far fa-address-book"></span>
                                                                </button>
                                                                <button class="btn btn-sm transition-none btn-reveal fs--2 p-1 " 
                                                                        type="button"
                                                                        ng-click="removeDataEmpWorkSheet('worksheet',item.seq)"
                                                                        ng-if="item.responder_id>0">
                                                                    <span class="fas fa-times text-danger"></span>
                                                                </button>
                                                            </div>
                                                            <div ng-show="item.user_name === user_name && params !== 'edit_approver'">
                                                                <button ng-click="openDataEmployeeAdd(item,'approver_ta3')"
                                                                    class="btn btn-link px-0 mx-1"
                                                                    data-toggle="tooltip" 
                                                                    title="Add Employee">
                                                                    <span class="far fa-address-book"></span>
                                                                </button>
                                                                @*<button class="btn btn-sm transition-none btn-reveal fs--2 p-1 " 
                                                                        type="button"
                                                                        ng-click="removeDataEmpWorkSheet('worksheet',item.seq)"
                                                                        ng-if="item.responder_id>0">
                                                                    <span class="fas fa-times text-danger"></span>
                                                                </button>*@
                                                            </div>                                                                                                                                                                                   
                                                            <label class="text-1100 fw-bold m-0">
                                                                {{item.user_displayname}}
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <div class="col-md-12 p-1 ps-3 d-flex justify-content-between align-items-center">
                                                            <div ng-if="params == 'edit_approver'">
                                                                <button 
                                                                    ng-click="
                                                                        openDataEmployeeAdd(item, 'edit_approver', $index); 
                                                                        recommentAction_valid(item);" 
                                                                    class="btn btn-link px-0 mx-1"
                                                                    ng-class="{'no-drop': item.approver_action_type == 2 || data_header[0].pha_status != 21}"
                                                                    ng-disabled="item.approver_action_type == 2 || data_header[0].pha_status != 21"
                                                                    data-toggle="tooltip" 
                                                                    title="Add Employee">
                                                                    <span class="far fa-address-book"></span>
                                                                </button>
                                                                <button class="btn btn-sm transition-none btn-reveal fs--2 p-1 " 
                                                                        type="button"
                                                                        ng-click="removeDataEmpWorkSheet('worksheet',item.seq)"
                                                                        ng-if="item.responder_id>0">
                                                                    <span class="fas fa-times text-danger"></span>
                                                                </button>
                                                            </div>                                                                                                                                                                               
                                                            <label class="text-1100 fw-bold m-0">
                                                                {{item.user_displayname}}
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="text-start ps-4" ng-if="accessInfo.isTA2">
                                                            <a ng-click="openDataEmployeeAdd(item,'approver_ta3')"
                                                                class="btn btn-link px-0"
                                                                data-toggle="tooltip" 
                                                                title="select TA3"
                                                                style="font-size: smaller;">
                                                                <span>Click to select TA3</span>
                                                        </a>
                                                    </div> 

                                                    <div class="col-md-12 text-start p-1 ps-4" 
                                                            ng-show="(accessInfo.isTA2 || item_ta3.id_approver ===  item.id) && item_ta3.action_type !== 'delete'"
                                                            ng-repeat="item_ta3 in data_approver_ta3 | toArray | filter:{id_approver: item.id}">                                                            
                                                            <label class="text-secondary">Task assigned : <br></label>
                                                            <div>
                                                                <a class="fa-solid fa-user-pen pe-2 cursor-pointer" ></a>
                                                                <label class="text-1100 fw-bold">{{item_ta3.user_displayname}}</label>

                                                            </div>
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap" ng-class="{'disabled-link':(!tab_approver_active)}">
                                                    <div class="col-md-12 p-1 ps-3 text-start"  ng-if="(accessInfo.canAccess || accessInfo.isTA2) && item.approver_action_type != 2">
                                                        <div class="form-check form-check-inline cursor-pointer">
                                                            <span class="fa-solid far fa-file-pdf text-danger" style="font-size:15px;" ng-click="confirmExport('whatif_report','pdf')"></span>
                                                            <b>
                                                                What's if Report
                                                            </b>
                                                        </div><br />
                                                        <div class="form-check form-check-inline" ng-if="accessInfo.canAccess || accessInfo.isTA2" >
                                                            <input class="form-check-input" id="inlineRadio-{{item.seq}}" type="radio"
                                                                   name="inlineRadioOptions-{{item.seq}}" 
                                                                   value="approve" checked ng-model="item.action_status" />
                                                            <label class="form-check-label" for="inlineRadioApprove-{{item.seq}}"> Approve</label>
                                                        </div>
                                                        <div class="form-check form-check-inline" ng-if="accessInfo.canAccess || accessInfo.isTA2">
                                                            <input class="form-check-input" id="inlineRadioOptions-{{item.seq}}" type="radio"
                                                                   name="inlineRadioOptions-{{item.seq}}" 
                                                                   value="reject" checked ng-model="item.action_status" />
                                                            <label class="form-check-label" for="inlineRadioReject-{{item.seq}}"> Send back with Comment</label>
                                                        </div>
                                                        <div id="valid-approver-status-{{item.seq}}" class="invalid-feedback text-danger">
                                                            Please select a valid status.
                                                        </div>
                                                    </div>


                                                    <div class="col-md-12 p-1 ps-3 text-start" ng-if="item.approver_action_type == 2">
                                                        <div class="form-check form-check-inline cursor-pointer p-0">
                                                            <span class="fa-solid far fa-file-pdf text-danger" style="font-size:15px;" ng-click="confirmExport('hazop_report','pdf')"></span>
                                                            <b>
                                                                What's if Report
                                                            </b>
                                                        </div><br />
                                                        <p>{{item.action_status =='approve' ? 'Approve' : 'Send back with Comment' }}</p>
                                                    </div>
                                                </td>                                                

                                                <td class="align-top white-space-nowrap text-start" ng-class="{'disabled-link':(!tab_approver_active)}">
                                                    <div class="col-md-12 p-1 ps-3" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)" >
                                                            <textarea class="form-control rounded-1" 
                                                                    id="floatingTextarea2" 
                                                                    placeholder="{{ accessInfo.canAccess ? 'Enter your comment' : '' }}"
                                                                    ng-if="accessInfo.canAccess || accessInfo.isTA2 || accessInfo.isTA3"
                                                                    ng-model="item.comment"></textarea>
                                                        <div id="valid-approver-comment-{{item.seq}}" class="invalid-feedback text-danger">
                                                            Please select a valid comment.
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 p-1 ps-3" ng-if="(item.approver_action_type == 2 || data_header[0].pha_status != 21 )">

                                                        <p class="fw-bold" ng-if="item.comment"
                                                           ng-class="{'disabled-link': !tab_approver_active || !canAccess}" >
                                                            <span>{{item.comment}}</span>
                                                        </p>
                                                    </div>
                                                </td>
                                                <td class="align-top px-1" style="min-width:200px;">
                                                    @* {{item.seq}} *@
                                                    <div class=" p-0 cursor-pointer " 
                                                         ng-repeat="item_x in data_drawing_approver  | toArray | filter:{id_approver : item.seq}  ">
                                                        <div class="d-flex flex-nowrap">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static me-1" 
                                                                ng-if="(accessInfo.canAccess || accessInfo.isTA2 ||accessInfo.isTA3) && (item.approver_action_type != 2)">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        ng-if="(accessInfo.canAccess || accessInfo.isTA2 || accessInfo.isTA3)"
                                                                        type="button" data-bs-toggle="dropdown" data-boundary="window"
                                                                        aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click=addDataApproverDrawing(item_x,item.seq,item.id_session)>
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider"></div>
                                                                    <a class="dropdown-item text-danger"
                                                                        ng-click=removeDataApproverDrawing(item_x,item_d.seq)>
                                                                        <span class="fas fa-times-circle"></span> 
                                                                         Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div class="btn-group my-2" >
                                                                <div class="icon-button border p-3" style="border-color: #0d6efd; background-color: #0d6efd;"
                                                                    ng-hide="!(accessInfo.canAccess || accessInfo.isTA2 || accessInfo.isTA3) && !item_x.document_file_size">
                                                                        <span ng-if="!item_x.document_file_size" class="fa-solid fa-arrow-up-from-bracket fa-lg" style="color: #ffffff;"></span>
                                                                        <span ng-if="item_x.document_file_size" class="fa-solid fa-file-pdf fa-lg" style="color: #ffffff;"></span>                                                                  </div>
                                                                <button class="Upload-button btn ps-3" 
                                                                        ng-show="(accessInfo.canAccess || accessInfo.isTA2 || accessInfo.isTA3) && !item_x.document_file_size">
                                                                    <span class="nametext ms-3 filename-text me-2 d-none" id="filename-approver-{{item_x.seq}}">
                                                                        {{(item_x.document_file_size>0? item_x.document_file_name + '('+  item_x.document_file_size + 'KB)' : '')}}
                                                                    </span>
                                                                    <label class="dz-message-text fw-bold p-1 " for="attfile-{{item_x.seq}}">
                                                                        Upload File (Max size 10mb)
                                                                    </label>
                                                                    <input type="file" id="attfile-{{item_x.seq}}"
                                                                        name="file{{item_x.seq}}"
                                                                        onchange="angular.element(this).scope().fileSelectApprover(this, 'approver')"
                                                                        style="display:none" />

                                                                </button>
                                                                <button class="Upload-button btn cursor-pointer" style="width:250px;" ng-if="item_x.document_file_size > 0">
                                                                    <div class="d-flex align-items-center">
                                                                        <span class="nametext filename-text me-2 cursor-pointer" ng-click="downloadFile(item_x)">
                                                                            {{ item_x.document_file_name }} ({{ item_x.document_file_size }} KB)
                                                                        </span>
                                                                    </div>
                                                                </button>
                                                            </div>                                                              
                                                        </div>
                                                    </div>
                                                    <div ng-class="{'invalid-feedback text-danger': !(form_valid.valid_document_file==true && item.seq == id_approver_select), 'feedback text-danger': form_valid.valid_document_file}">
                                                        Please provide a valid document file.
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.date_review_show}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top px-1 py-3" ng-class="{'disabled-link': (!tab_approver_active)}">
                                                    <div class="d-flex" ng-class="{ 'no-drop': !canAccess, 'cursor-pointer': canAccess }">
                                                        <button class="btn btn-outline text-primary p-1 m-2 me-0"
                                                                style="background-color: #f1f2f4; width:50px;"
                                                                ng-click="confirmDialogApprover(item, 'save')"
                                                                ng-show="(accessInfo.canAccess || accessInfo.isTA2 || accessInfo.isTA3) && item.approver_action_type != 2">
                                                            <span class="fa fa-save text-primary fa-lg"></span><br />
                                                            <span style="font-size:8px">Save</span>
                                                        </button>
                                                        <button class="btn btn-outline text-success p-1 m-2 ms-1"
                                                                style="background-color: #f1f2f4; width:80px;"
                                                                ng-click="confirmDialogApprover(item, 'submit')"
                                                                ng-show="(accessInfo.canAccess || accessInfo.isTA2 || accessInfo.isTA3) && item.approver_action_type != 2"
                                                                ng-disabled="!accessInfo.canAccess || accessInfo.isTA3">
                                                            <span class="fa fa-save text-success fa-lg"></span><br />
                                                            <span style="font-size:8px">Submit</span>
                                                        </button>
                                                    </div>
                                                </td>


                                            </tr>

                                        </tbody>

                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ta2 approver -->

                    <!-- report start-->
                    <div class="" 
                        ng-class="{
                            'tab-pane fade show active':(action_part==8),
                            'tab-pane fade show active':(tabs[7].isActive),
                            'tab-pane fade':(action_part!==8)}"
                         id="tab-report" role="tabpanel" aria-labelledby="report-tab" ng-if="export_type==true">

                        <div class="m-3 row  gx-0 align-items-center">
                            <div class="bg-white position-relative top-1">
                                <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                                    <table class="table table-sm fs--1 mb-0">
                                        <thead class=" text-uppercase">
                                            <tr>
                                                <th class="white-space-nowrap fs--1 align-middle ps-0" style="width:5%;"></th>
                                                <th class=" align-middle pe-5" scope="col" data-sort="email" style="width:70%">
                                                    Report
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class=" list text-uppercase" id="customers-table-body">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2 d-none" ng-click="confirmExport('whatif_report','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('whatif_report','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('whatif_report','none-word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    WHAT'S IF REPORT
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('whatif_worksheet','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('whatif_worksheet','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('whatif_worksheet','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    WHAT'S IF WORKSHEET &
                                                    RECOMMENDATION RESPONSE SHEET
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('whatif_recommendation','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('whatif_recommendation','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('whatif_recommendation','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    WHAT'S IF RECOMMENDATION
                                                    RESPONSE SHEET & RECCOMENDATION STATUS TRACKING TABLE
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">

                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('whatif_ram','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('whatif_ram','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('whatif_ram','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    Risk Assessment Matrix (RAM)
                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>

                            </div>

                            <div class="bg-white position-relative top-1 d-none" ng-repeat="item_doc in exportfile "
                                 ng-if="(item_doc.DownloadPath !='' || item_doc.DownloadPath != null)">
                                <h5 class="modal-title" id="modalExportFileLabel">Download File</h5>
                                <a href="{{item_doc.DownloadPath}}" id="exportfile" name="exportfile" target="_blank">
                                    {{item_doc.DownloadPath}}-{{item_doc.Name}}
                                </a>
                            </div>


                        </div>

                    </div>
                    <!-- report end-->

                </div>

            </div>
        </div>
    </div>




    @* ************************************************************** *@


    <!--Modal Employee Add Start-->
    <div class="modal fade modal-xl" id="modalEmployeeAdd" tabindex="-1" aria-labelledby="modalEmployeeAddLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content scrollbar" style="max-height: calc(100vh - 100px); overflow-y:auto;">
                <div class="modal-header" ng-if="selectDatFormType === 'member' || selectDatFormType === 'approver' || selectDatFormType === 'specialist' ||params === 'edit_approver'">
                     <!-- For form_type === 'member' or 'approver' -->
                    <div > <!------ng-if="selectDatFormType === 'member' || selectDatFormType === 'approver'"----->
                        <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalEmployeeCheckLabel">
                            <span class="me-2 text-primary"><B>|</B></span> Search Employee/Contract
                        </h5>
                    </div>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close" ng-click="clearFormData()">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                                data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                                data-fa-i2svg="">
                            <path fill="currentColor"
                                    d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>
                <div class="modal-header ps-0 pb-0" ng-if="selectDatFormType === 'owner' && params != 'edit_approver'">
                    <!-- For form_type === 'owner' -->
                    <nav class="navbar navbar-expand-lg navbar-light ps-0 pb-0">
                        <div class="container-fluid ps-0">
                            <ul class="nav nav-underline border-3  " id="myTab"
                                role="tablist" style="position: relative;">
                                <li class="mx-2" ng-if="tab.isShow || true"><!-----btn-outline-primary------->
                                    <a ng-click="selectTab('employee')"
                                       class="btn border border-0 "
                                       ng-class="{'btn border border-bottom border-primary border-0 text-primary active': (owner_status === 'employee'),'btn border border-0 ': (owner_status === 'teams') }"
                                        style="border-radius: 10px 10px 0px 0px !important;"
                                       aria-selected="tab.isActive">Search Employee/Contract</a>
                                </li>
                                <li class="mx-2" ng-if="tab.isShow || true">
                                    <a ng-click="selectTab('teams')"
                                       class="btn border border-0 "
                                       ng-class="{'btn border border-0 border-bottom border-primary text-primary active': (owner_status === 'teams'),'btn border border-0 ': (owner_status === 'employee') }"
                                       style="border-radius: 10px 10px 0px 0px !important;"
                                       aria-selected="tab.isActive">Add Teams</a>
                                </li>
                            </ul>
                        </div>
                    </nav>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close" ng-click="clearFormData()">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                                data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                                data-fa-i2svg="">
                            <path fill="currentColor"
                                    d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" >
                    <div ng-show="selectDatFormType && owner_status !== 'teams'">
                        <div class="mb-4">
                            <div class="row g-3">
                                @*<div class="col-auto">
                                    <label for="" style="font-size: 14px; font-weight: bold; padding-left: 4px;">Employee</label>
                                    <div class="search-box form-floating position-relative">
                                        <input class="form-control search-input search"
                                            ng-model="searchText" 
                                            placeholder="Search Employee"
                                            ng-change="fillterDataEmployeeAdd()" />
                                        <label class="ms-3" for="floatingInput">Employee</label>
                                        <span class="fas fa-search search-box-icon"></span>
                                    </div>                                  
                                </div>
                                <div class="col-auto">*@
                                    @*<label for="" style="font-size: 14px; font-weight: bold; padding-left: 4px;">Indicator</label>
                                    <div class="search-box form-floating position-relative">
                                        <input class="form-control search-input search"
                                            ng-model="searchIndicator.text" 
                                            placeholder="Search Indicator"
                                            ng-change="fillterDataEmployeeAdd()" />
                                        <label class="ms-3" for="floatingInput">Indicator</label>    
                                        <span class="fas fa-search search-box-icon"></span>
                                    </div>                                      
                                </div>*@
                                <div class="col-auto">
                                    <label for="" style="font-size: 14px; font-weight: bold; padding-left: 4px;">Indicator</label>
                                    <div class="search-box position-relative">
                                        <input class="form-control search-input search"
                                            ng-model="searchIndicator.text" 
                                            placeholder="Search"
                                            ng-change="fillterDataEmployeeAdd()" />
                                        <span class="fas fa-search search-box-icon"></span>
                                    </div>
                                </div>
                                <div class="col-auto d-flex align-items-end justify-content-end" ng-show="selectDatFormType !== 'approver' && selectDatFormType !== 'approver_ta3' && params !== 'edit_approver'">
                                    <button class="btn text-light btn-sm" style="background-color: #e90f8b;" 
                                            ng-class="{'button-fade': showContractor}"
                                            ng-click="showContractor = !showContractor">
                                        <span class="fa-solid fa-user-pen"></span> Contractor/Outsource
                                    </button>
                                </div>
                            </div>
                        </div>

                        @* start แสดงข้อมูลที่ ค้นหาตาม textsearch*@
                        <div class="bg-white border-top border-bottom border-200 position-relative top-1" >
                            <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                                <table class="table table-sm fs--1 mb-0">
                                    <thead class=" text-uppercase">
                                        <tr class="text-center">
                                            <th class=""> </th>
                                            <th class="pe-5" scope="col">Employee</th>
                                            <th class="" scope="col">Section</th>
                                            <th class="" scope="col">Indicator</th>
                                            <th class="" scope="col">E-Mail</th>
                                            @*<th class="" scope="col">Employee Type</th>*@
                                        </tr>
                                    </thead>
                                    <tbody class=" list">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static text-center"
                                                ng-class="{'row-faded': clickedStates[item.employee_name] || (selectDatFormType === 'approver_ta3' && data_approver_ta3[0].user_name === item.employee_name)}"
                                                ng-repeat="item in employeelist_show">
                                                
                                                <!-----------ng-if="employeelist_show.length > 0 && employeelist_show[0].employee_displayname !== null" ------->
                                                <td class="">
                                                    <span class="mx-1">
                                                        <button class="btn btn-outline-secondary p-1 cursor-pointer"
                                                                ng-class="{'btn-clicked': clickedStates[item.employee_name],'skeleton': loadingData}" 
                                                                style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                                data-toggle="tooltip" 
                                                                data-placement="top" 
                                                                title="choose Employee"
                                                                ng-click="choosDataEmployee(item)">
                                                            <span class="fa-solid fa-user-plus" ng-if="selectDatFormType !== 'owner' && selectDatFormType !== 'approver_ta3' && params !== 'edit_approver'">Add</span>
                                                            <span class="fa-solid fa-user-check" ng-if="selectDatFormType === 'owner' || params === 'edit_approver'">Select</span>
                                                            <span class="fa-solid fa-paper-plane" ng-if="selectDatFormType === 'approver_ta3'">Select</span>
                                                        </button>
                                                    </span>
                                                </td>
                                                <td class="">
                                                    <a class=" text-decoration-none d-flex align-items-center">
                                                        <div class="avatar avatar-m" style="height: 20px; width: 20px;">
                                                            <img ng-if="item.employee_img " class="rounded-circle" 
                                                                 ng-class="{ 'skeleton': loadingData }"
                                                                 ng-src="../../{{ item.employee_img }}" alt="">
                                                        </div>
                                                        <p class="mb-0 ms-3 text-1100 fw-bold"
                                                            ng-class="{ 'skeleton skeleton-text skeleton-text__body': loadingData }">
                                                            {{item.employee_displayname}} 
                                                        </p>
                                                    </a>
                                                </td>
                                                <td class="text-center m-0">
                                                    <p class="m-0" ng-class="{ 'skeleton skeleton-text skeleton-text__body': loadingData }">{{ item.employee_position }}</p>
                                                </td>
                                                <td class="text-center m-0">
                                                    <p class="m-0" ng-class="{ 'skeleton skeleton-text skeleton-text__body': loadingData }">{{ item.employee_position + '-' + item.employee_displayname.split(' ')[0] }}</p>
                                                </td>
                                                <td class="text-center">
                                                    <p class="m-0" ng-class="{ 'skeleton skeleton-text skeleton-text__body': loadingData }">{{ item.employee_email }}</p>
                                                </td>

                                            </tr>
                                                <!-- Show "please enter" message  -->
                                            <tr ng-if="!searchText && !searchIndicator.text && employeelist_show.length < 1">
                                                <td colspan="5">
                                                    <p class="mb-0 ms-3 text-muted fw-bold text-center"> Enter employee details to search. </p>
                                                </td>
                                            </tr>

                                                <!-- Show "Not Found" message when employeelist_show is empty or the first item is null -->
                                            <tr ng-if="employeelist_show[0].employee_displayname === null">
                                                <td colspan="5">
                                                    <p class="mb-0 ms-3 text-1100 fw-bold text-center"> Not Found </p>
                                                </td>
                                            </tr>                                   
                                    </tbody>
                                </table>
                                <div class="pagination-container" ng-show="employeelist_show.length > 1">
                                    <button class="pagination-button" ng-disabled="currentPage === 1" ng-click="action_changepage('prevPage')">Previous</button>
                                    <!-- Page numbers -->
                                    <span class="pagination-info">Page {{currentPage }} of {{ totalPages}}</span>
                                    <!-- Next page button -->
                                    <button class="pagination-button" ng-disabled="currentPage === totalPages" ng-click="action_changepage('nextPage')">Next</button>
                                </div>

                            </div>
                        </div>
                        @* end แสดงข้อมูลที่ ค้นหาตาม textsearch*@
        
                    </div>

                    <div ng-show="selectDatFormType === 'owner' && owner_status === 'teams'">
                        <!-- For form_type === 'owner'  action_project_team if teams ==== 1-->
                        <div>                    
                            <div class="mb-3">
                                <input type="text" class="form-control" id="employee_position" ng-model="owner_teams">
                            </div>
                            <button type="button" class="btn btn-primary" ng-click="choosDataEmployee()">Apply</button>                        
                        </div>
                    </div>
                </div>

            <!-------------- Show b=name after add------------------------------->
                <div class="modal-header bg-soft" ng-if="formData.length > 1">
                    <h5 class="text-900 mb-0" >
                        <span class=" me-2 text-primary"><B>|</B></span>
                        <span ng-switch="selectDatFormType">
                            <span ng-switch-when="member">Member Teams</span>
                            <span ng-switch-when="approver">Safety Reviewer</span>
                            @*<span ng-switch-when="attendees">ผู้จัดทำ (Attendees)</span>*@
                            <span ng-switch-when="specialist">ผู้เชี่ยวชาญเฉพาะด้าน (ถ้ามี)</span>
                        </span>
                    </h5>
                </div>

                <div class="modal-body" ng-if="!(selectDatFormType =='owner' && formData.length > 1)"><!---------------ng-if="!(selectDatFormType =='approver'|| selectDatFormType =='reviewer')"----------->
                    <div class="col-auto py-1 repeated-item"
                        ng-repeat="item2 in formData | toArray | filter:{id_session: selectdata_session }" 
                        ng-if="item2.user_displayname">
                        
                        <div class="d-flex align-items-center p-1">
                            @* <button id="del-{{item2.seq}}" class="btn btn-link text-danger" 
                                ng-class="{'d-none':(!tab_general_active)}" 
                                ng-click="removeData(item2.seq, selectdata_session, selectDatFormType)">
                                Remove
                            </button> *@
                             <button class="btn btn-outline-secondary p-1" 
                                    style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828; width: 25px; height:25px;"
                                    data-toggle="tooltip" 
                                    data-placement="top" 
                                    title="Remove"
                                    ng-click="removeData(item2.seq, selectdata_session, selectDatFormType)">
                                <span class="fa-regular fa-trash-can"></span>
                            </button>
                            <div class="form-check mb-0 ms-2 text-1100 fw-bold d-flex align-contents-center" ng-if="selectDatFormType == 'approver'">
                                <input class="form-check-input disabled-link rounded-2 cursor-pointer" 
                                    style="width: 24px; height:24px;"
                                    type="checkbox" 
                                    ng-if="item2.approver_type =='approver'" 
                                    checked 
                                    ng-click="actionChangeSafety(item2, item2.seq)">
                                <input class="form-check-input rounded-2 cursor-pointer" 
                                    type="checkbox" 
                                    style="width: 24px; height:24px;"
                                    ng-if="!(item2.approver_type =='approver')" 
                                    ng-click="actionChangeSafetyUnCheck(item2, item2.seq)">
                                <label class="form-check-label m-auto fw-bold" for="approver_safety">(safety)</label>
                            </div>
                            <label class="mb-0 ms-3 text-1100 fw-bold" style="width: 25%; border-color: #f1f2f4;">{{ item2.user_displayname }}</label>
                            <label class="mb-0 text-1100 fw-bold" style="width: 25%; border-color: #f1f2f4;">{{ item2.user_title }}</label>
                        </div>
                    </div>
                </div>

                <!------------contractor/out source-------------->
                <div class="modal-header bg-soft" ng-if="!(selectDatFormType =='approver'|| selectDatFormType =='reviewer') && (showContractor || (data_relatedpeople_outsider | toArray | filter:{user_type: selectDatFormType}).length > 1)">
                    <h5 class="text-900 mb-0"> 
                        <span class=" me-2 text-primary"><B>|</B></span>Contracter/Outsouce (if concern)
                    </h5>
                </div>
                <div class="modal-body" 
                    ng-show="(selectDatFormType == 'attendees' || selectDatFormType == 'specialist' || selectDatFormType == 'member') && (showContractor || (data_relatedpeople_outsider | toArray | filter:{user_type: selectDatFormType}).length > 1)">
                    <div class="bg-white border-top border-bottom border-200 position-relative top-1">
                        <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                            <table class="table table-sm fs--1 mb-0">
                                <thead class="text-uppercase">
                                    <tr>
                                        <th style="width: 90px;"></th>
                                        <th class="pe-5">Name (ชื่อ-นามสกุล)</th>
                                        <th class="pe-5">Title (ตำแหน่ง)</th>
                                    </tr>
                                </thead>
                                <tbody class="list">
                                    @*Free text*@
                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static repeated-item"
                                        ng-repeat="itemRel in data_relatedpeople_outsider | toArray | filter:{id_session: selectdata_session, user_type: selectDatFormType}"> <!--------------------, user_type:selectDatFormType--------->
                                        <td class="d-flex  justify-content-start">
                                            @* <button id="del-{{item2.seq}}" class="btn btn-link text-danger p-0 text-end" style="width:140px;"
                                                    ng-class="{'d-none':(!tab_general_active)}"
                                                    ng-click="removeDataRelatedpeopleOutsider(itemRel.seq)">
                                                Remove
                                            </button> *@
                                            <span class="mx-1">
                                                <button class="btn btn-outline-secondary p-2" 
                                                        style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                        data-toggle="tooltip" 
                                                        data-placement="top" 
                                                        title="Remove"
                                                        ng-click=removeDataRelatedpeopleOutsider(itemRel.seq,itemRel.id_session)>
                                                    <span class="fa-regular fa-trash-can fa-lg"></span>
                                                </button>
                                            </span>
                                            <span class="mx-1">
                                                <button class="btn btn-outline-secondary p-2" 
                                                        style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                        data-toggle="tooltip" 
                                                        data-placement="top" 
                                                        title="Add Other Contract"
                                                        ng-click=addnewFreebox(itemRel.seq)>
                                                    <span class="fa-solid fa-user-plus fa-lg"></span>
                                                </button>
                                            </span>

                                            @* <button id="add-{{item2.seq}}" class="btn btn-link text-primary p-0 text-end" style="width:140px;"
                                                    ng-class="{'d-none':(!tab_general_active)}"
                                                    ng-click="addnewFreebox(itemRel.seq)"
                                                    ng-if="$last">
                                                Add Other Contract
                                            </button> *@
                                        </td>
                                        <td class="">
                                            <input type="text" class="form-control form-control-sm" placeholder="Name"
                                                style="width: 100%;"
                                                ng-model="itemRel.user_displayname"
                                                ng-change="actionChange(itemRel,itemRel.seq,'')">
                                        </td>
                                        <td class="">
                                            <input type="text" class="form-control form-control-sm" placeholder="Title"
                                                    style="width: 100%;"
                                                    ng-model="itemRel.user_title"
                                                    ng-change="actionChange(itemRel,itemRel.seq,'')">
                                        </td>
                                    </tr>                                    
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Employee Check End--> 

    @* Save *@
    <!--Modal Save Start-->
    <div class="modal fade" id="modalMsg" tabindex="-1" aria-labelledby="modalMsgLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center" style="display: flex !important;"
                     ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? false :true) }">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-triangle-exclamation fa-lg" ng-if="Action_Msg_Header == 'Warning'"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                        <i class="fa-solid fa-circle-check fa-lg" ng-if="Action_Msg_Header != 'Warning'"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body" ng-if="Action_Msg_Header == 'Success'">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <h5 class="mb-0 text-center " style="font-size: 40px; font-weight: bold;" data-anchor="data-anchor" id="modalMsgLabel">
                            {{Action_Msg_Header}}
                        </h5>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 mb-3">
                        <p class="lh-lg mb-0 text-center" style="font-size: 16px;">
                            {{ Action_Msg_Detail}}
                        </p>
                    </div>

                </div>
                <div class="modal-footer" ng-if="Action_Msg_Header == 'Success'">
                    <div class="d-flex flex-column align-items-center bg-primary" ng-if="!Action_Msg_Confirm">
                        <button class="btn p-2 px-8 text-white" type="button" data-bs-dismiss="modal" aria-label="Close">
                            OK
                        </button>
                    </div>
                </div>
                <div class="modal-body" ng-if="Action_Msg_Header == 'Warning'">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <h5 class="mb-0 text-center ms-5" style="font-size: 40px; font-weight: bold;" data-anchor="data-anchor" id="modalMsgLabel">
                            {{Action_Msg_Header}}
                        </h5>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 mb-3">
                        <p class="lh-lg mb-0 text-center" style="font-size: 16px;">
                            {{ Action_Msg_Detail}}
                        </p>
                    </div>
                    <div class="d-flex flex-column align-items-center" ng-if="!Action_Msg_Confirm">
                        <button class="btn p-2 px-8 text-white" type="button" data-bs-dismiss="modal" aria-label="Close"
                                ng-click="goBackToTab()"
                                ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? false :true) }">
                            {{ Action_Msg_Header == 'Warning' ? 'Go back' : 'OK' }}
                        </button>
                    </div>
                </div>
                <div class="modal-body d-flex flex-column justify-content-center mb-4"
                     ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        Do you want to continue?
                    </h5>
                </div>
                <div class="modal-footer" ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <div class="d-flex justify-content-center align-items-center">
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmSubmit('yes')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-check"></span> Yes
                            </a>
                        </button>
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmSubmit('no')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-times"></span> No
                            </a>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Save End-->
    <div class="modal fade" id="modalMsg2" tabindex="-1" aria-labelledby="modalMsg2Label"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? true :false) }">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsg2Label">
                        <span class=" me-2" ng-class="{ 'text-danger' : (Action_Msg_Header == 'Warning'? true :false),'text-primary' : (Action_Msg_Header == 'Warning'? true :false) }"><B>|</B></span> {{Action_Msg_Header}}
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" ng-if="!Action_Msg_Confirm">
                    <p class="text-700 lh-lg mb-0">{{Action_Msg_Detail}}</p>
                </div>

                <div class="modal-body">

                    <div class="d-flex justify-content-center">
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmMailtoMemberReview('yes')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-check"></span> Yes
                            </a>
                        </button>
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmMailtoMemberReview('no')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-times"></span> No
                            </a>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!--Modal Export & Import Data Start-->
    <div class="modal fade modal-xl" id="modalExportImport" tabindex="-1" aria-labelledby="modalExportImportLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportImportLabel">Export & Import Data</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                </div>

            </div>
        </div>
    </div>
    @* Modal Export & Import Data End *@

    @* Modal RAM Start *@
    <div class="modal fade modal-xl shadow-sm p-3 mb-5  rounded" id="modalRAM" tabindex="-1"
         aria-labelledby="modalRAMLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">

            <div class="modal-content">
                <div class="modal-header">

                    <h5 class="modal-title" id="modalRAMLabel">Risk Assessment Matrix (RAM){{(selectedDataNodeWorksheetRamType =='s'?' : Security':(selectedDataNodeWorksheetRamType =='l'?' : Likelihood':''))}}</h5>


                    <div class="col-auto ms-auto" style="zoom:1.5">
                        <b class="pe-1 me-1"> Security : {{cal_ram_action_security}}</b>
                        <b class="pe-1 me-1"> Likelihood : {{cal_ram_action_likelihood}}</b>
                        <b class="pe-1 me-1">  Risk : </b>
                        <label class="pe-1 me-1 text-center" style="width:100px"
                               ng-style=" { 'background-color' : ((cal_ram_action_risk == 'H') ? 'red' : ((cal_ram_action_risk == 'M') ? 'yellow' : ((cal_ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }">{{cal_ram_action_risk}}</label>
                    </div>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close" ng-click="closeModalDataRAM_Worksheet()">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                            data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                            data-fa-i2svg="">
                            <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>

                <div class="modal-body  ">

                    <div class="row" ng-if="data_general[0].id_ram==5">
                        <div class="row">
                            <div class="col-1"></div>
                            <div class="col-5 d-flex justify-content-start gap-10">
                                <span class="mx-1 d-flex pt-5">
                                    <a class="m-1 text-info cursor-pointer"
                                       href="{{y.document_definition_file_path}}" target="_blank"
                                       ng-repeat="y in master_ram | toArray | filter:{id: data_general[0].id_ram}">Definition Consequence Rating<span class="fas fa-file-pdf fa-lg ms-1"></span></a>
                                </span>
                            </div>
                            <div class="col-5 d-flex justify-content-center" style="padding: 10px 10px;gap: 65px;">
                                <div class="d-flex justify-content-end align-items-center flex-column"
                                     ng-repeat="item_ram in master_likelihood_level | toArray | filter:{id_ram:data_general[0].id_ram,columns_level:item_ram.columns_level}">
                                    <label for="likelihood"><b>{{item_ram.likelihood_level}}</b></label>
                                    <input type="radio"
                                           id="likelihood"
                                           name="likelihood"
                                           ng-checked="cal_ram_action_likelihood == item_ram.likelihood_level"
                                           ng-click="selectDataRAM('l',item_ram.likelihood_level)"
                                           style="cursor: pointer; width:25px; height:25px;">
                                </div>
                            </div>
                            <div class="col-1 d-flex justify-content-end"></div>
                        </div>

                        <div class="col-1 d-flex flex-column justify-content-end" style="gap: 40px; padding: 0px;  padding-bottom: 20px;">
                            <div class="d-flex justify-content-end align-items-center gap-2"
                                 ng-repeat="item_ram in master_security_level | toArray | filter:{id_ram:data_general[0].id_ram,category_type:item_ram.category_type}">
                                <label for="security_level"><b>{{item_ram.security_level}}</b></label>
                                <input type="radio"
                                       id="security_level"
                                       name="security_level"
                                       ng-checked="cal_ram_action_security == item_ram.security_level"
                                       ng-click="selectDataRAM('s',item_ram.security_level)"
                                       style="cursor: pointer; width:25px; height:25px;">
                            </div>
                        </div>

                        <div class="col-11">
                            <div class="cursor-pointer " ng-repeat="itemRam in master_ram | toArray | filter:{id: data_general[0].id_ram}">
                                <img ng-src="{{itemRam.document_file_path}}" style="width:100%;" />
                            </div>
                        </div>
                    </div>
                    <div class="row" ng-if="!(data_general[0].id_ram==5)">
                        <div class="row">
                            <div class="col-4 d-flex justify-content-end gap-10">
                            </div>
                            <div class="col-8 d-flex justify-content-center" style="padding: 20px 20px 20px 50px; gap: 160px">
                                <div class="d-flex justify-content-end align-items-center flex-column"
                                     ng-repeat="item_ram in master_likelihood_level | toArray | filter:{id_ram:data_general[0].id_ram,columns_level:item_ram.columns_level}">
                                    <label for="likelihood"><b>{{item_ram.likelihood_level}}</b></label>
                                    <input type="radio"
                                           id="likelihood" checked="{{cal_ram_action_likelihood == item_ram.likelihood_level}}"
                                           name="likelihood"
                                           ng-click="selectDataRAM('l',item_ram.likelihood_level)"
                                           style="cursor: pointer;width:30px; height:30px;">
                                    {{cal_ram_action_likelihood == item_ram.likelihood_level}}
                                </div>
                            </div>
                        </div>

                        <div class="col-1 d-flex flex-column justify-content-end" style="gap: 63px; padding-bottom: 20px;">
                            <div class="d-flex justify-content-end align-items-center gap-2"
                                 ng-repeat="item_ram in master_security_level | toArray | filter:{id_ram:data_general[0].id_ram,category_type:item_ram.category_type}">
                                <label for="security_level"><b>{{item_ram.security_level}}</b></label>
                                <input type="radio"
                                       id="security_level" checked="{{cal_ram_action_security == item_ram.security_level}}"
                                       name="security_level"
                                       ng-click="selectDataRAM('s',item_ram.security_level)"
                                       style="cursor: pointer;width:30px; height:30px;">
                                {{cal_ram_action_security == item_ram.security_level}}
                            </div>
                        </div>

                        <div class="col-11">
                            <div class="cursor-pointer " ng-repeat="itemRam in master_ram | toArray | filter:{id: data_general[0].id_ram}">
                                <img ng-src="{{itemRam.document_file_path}}" style="width:100%;" />
                            </div>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>
    @* Modal RAM End *@
    @* Modal New RAM *@
    <div class="modal fade" id="modalNewRAM" tabindex="-1" aria-labelledby="modalNewRAM"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalNewRAM">Risk Assessment Matrix</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3 flex-start mb-3">
                        <div class="col-md-8 ps-2">
                            <input class="form-control rounded-1 ps-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                   type="text" placeholder="Ram Name"
                                   name="ram_name"
                                   ng-model="item.ram_name"
                                   ng-keyup="actionChange_ram_name(item.ram_name)">
                        </div>
                    </div>

                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center ">
                            <select class="form-control" ng-model="ram_rows_level">
                                <option ng-repeat="itemNo in master_no">
                                    {{itemNo.name}}
                                </option>
                            </select>
                            <label class="form-label" style=" width:100px">X</label>
                            <select class="form-control" ng-model="ram_columns_level">
                                <option ng-repeat="itemNo in master_no">
                                    {{itemNo.name}}
                                </option>
                            </select>
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm" style="width: 100px;" ng-click="confirmAddRAM()">Add</button>
                            </span>
                        </div>
                        <div class="">
                            <label class="form-label">{{ram_msg_level}}</label>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    @* Modal New RAM *@


    @* Modal Notification Start*@
    @* <!--Modal Notification Start--> *@
    <div class="modal fade modal-xl" id="modalNotification" tabindex="-1" aria-labelledby="modalNotificationLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalNotificationLabel">Notification (SAP)</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3">
                        <div class="text-center cursor-pointer ">

                            <div class="table-responsive scrollbar-overlay mx-n1 px-1" style="zoom:0.7">
                                <table class="table table-sm fs--1 mb-0">
                                    <thead class=" text-uppercase">
                                        <tr>
                                            <th class="fs--1 align-middle ps-0 py-3">Notif Date </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Notif Time </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Notification </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Orders </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Type </th>
                                            <th class="fs--1 align-middle ps-0 py-3">P </th>
                                            <th class="fs--1 align-middle ps-0 py-3">PLS </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Functional Location </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Descriptions Func </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Descriptions </th>
                                            <th class="fs--1 align-middle ps-0 py-3">MN(wk)</th>
                                            <th class="fs--1 align-middle ps-0 py-3">Plnt </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Reported By </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Required Start </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Required End </th>
                                            <th class="fs--1 align-middle ps-0 py-3">User Status </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Date Update </th>
                                        </tr>
                                    </thead>
                                    <tbody class=" list" ng-repeat="itemMaster in master_functional | orderBy:seq">
                                        <tr class="hover-actions-trigger btn-reveal-trigger position-static ">
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notif_date}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notif_time}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notification}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.orders}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.typ}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.p}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.pls}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.functional_location}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.descriptions_func}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.descriptions}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.mn_wk}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.plnt}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.reported_by}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.required_start}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.required_end}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.user_status}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.date_update}}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    @* <!--Modal Notification End--> *@

    <!--Modal Export File Start-->
    <div class="modal fade" id="modalExportFile" tabindex="-1" aria-labelledby="modalExportFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportFileLabel">Download File</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="bg-white position-relative top-1">

                        <a href="{{exportfile[0].DownloadPath}}" id="exportfile" name="exportfile" target="_blank">
                            {{exportfile[0].Name}}
                        </a>

                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Export File End-->
    <!--Modal Cause Show-->
    <div class="modal fade modal-xl" id="modalCauseText" tabindex="-1" aria-labelledby="modalCauseTextLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalCauseTextLabel">Details</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3">
                        <div class="" ng-repeat="itms_show in data_listworksheet_show ">
                            {{itms_show.causes_no +'.'+ itms_show.cause}}
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Cause Show-->
    @*


    *@
    @* e-Mail *@
    <!--Modal Check Send e-Mail Task Register-->
    <div class="modal fade" id="modalSendMailRegister" tabindex="-1" aria-labelledby="modalSendMailRegisterLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalSendMailRegisterLabel" style="font-size: 40px; font-weight: bold;">
                            Task Register
                        </h5>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm col-auto" ng-click="confirmSave('confirm_submit_register')">Register with notify members</button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-success btn-sm col-auto" ng-click="confirmSave('confirm_submit_register_without')">Register without notify members</button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail Task Register-->
    <!--Modal กรณีที่ Draft เมื่อกด Tab HAZOP Worksheet-->
    <div class="modal fade" id="modalPleaseRegister" tabindex="-1"
         aria-labelledby="modalPleaseRegisterLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-end align-items-end bg-primary" style="display: flex !important;">
                    <div class="d-flex justify-content-end mb-2">
                        <i class="fa-solid fa-times" ng-click="closePleaseRegister()"
                           style="color: rgb(255, 255, 255); font-size: 20px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalPleaseRegisterLabel" style="font-size: 20px; font-weight: bold;">
                            Please register task before fill in What's If Worksheet.
                        </h5>

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm col-auto" ng-click="confirmSave('confirm_submit_register')">Register with notify members</button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-success btn-sm col-auto" ng-click="confirmSave('confirm_submit_register_without')">Register without notify members</button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal กรณีที่ Draft เมื่อกด Tab HAZOP Worksheet-->
    <!--Modal Check Send e-Mail ปุ่ม Submit ที่ Status WPC -->
    <div class="modal fade" id="modalSendMailConduct" tabindex="-1" aria-labelledby="modalSendMailConductLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h6 class="modal-title mb-0 text-center" id="modalSendMailConductLabel" style="font-size: 25px; font-weight: bold;">
                            Complete What's if Worksheet for all sessions?
                        </h6>
                    </div>
                    <div class="justify-content-center align-items-center mb-5" ng-if=" data_header[0].pha_status == 22">

                        <label class="form-label ps-0" for="expense_type">Note to Approver</label>
                        <textarea class="form-control rounded-1" placeholder="Note"
                                  ng-repeat="item in data_node | toArray | filter:{id:selectedItemNodeView}"
                                  ng-model="item.descriptions"
                                  ng-if=" data_header[0].pha_status == 22"
                                  style="height: 50px"></textarea>

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="data_general[0].expense_type == 'OPEX'">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_moc')">
                                    Submit TA2 Review and Approve for MOC
                                </button>
                                <b class="text-danger" ng-if="date_to_approve_moc_text">(Submit date :{{date_to_approve_moc_text}}</b>
                                <b class="text-danger" ng-if="date_approve_moc_text">(Submit date :{{date_approve_moc_text}}</b>
                            </span>
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_complete')">
                                    {{data_general[0].expense_type == 'OPEX'? 'Complete for e-MOC' : 'Complete and Submit to TA2' }}
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        style=" background-color: #c9c5c5;"
                                        ng-click="confirmSave('confirm_cancel_complete')">
                                    Cancel
                                </button>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Submit ที่ Status WPC -->
    <!--Modal Check Send e-Mail ปุ่ม Team Member Start-->
    <div class="modal fade" id="modalSendMailTeam" tabindex="-1" aria-labelledby="modalSendMailTeamLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h4 class="modal-title mb-0 text-center" id="modalSendMailTeamLabel" style="font-size: 25px; font-weight: bold;">
                            Confirm send email to member review?
                        </h4>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmMailtoMemberReview('confirm_submit_team')">
                                    Yes
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        ng-click="confirmMailtoMemberReview('confirm_cancel_team')"
                                        style=" background-color: #c9c5c5;">
                                    No
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Team Member Start-->
    <!--Modal Genarate Full Report -->
    <div class="modal fade" id="modalSendGenarateFullReport" tabindex="-1" aria-labelledby="modalSendGenarateFullReportLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary"
                     style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h4 class="modal-title mb-0 text-center" id="modalSendGenarateFullReportLabel"
                            style="font-size: 40px; font-weight: bold;">
                            Genarate Full Report?
                        </h4>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_genarate')">
                                    Genarate Full Report with notify members.
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_genarate_without')"
                                        style=" background-color: #c9c5c5;">
                                    Genarate Full Report without notify members.
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Genarate Full Report-->
    <!--Modal Check Send e-Mail ปุ่ม Submit TA2 Approver-->
    <div class="modal fade" id="modalSendMailApprover" tabindex="-1" aria-labelledby="modalSendMailApproverLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalSendMailApproverLabel" style="font-size: 40px; font-weight: bold;">
                            Submit What's if Worksheet for all sessions?
                        </h5>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_approver')">
                                    Submit
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        style=" background-color: #c9c5c5;"
                                        ng-click="confirmSave('confirm_cancel_approver')">
                                    Cancel
                                </button>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Submit TA2 Approver-->
    <!--Modal Export File Responder Start-->
    <div class="modal fade" id="modalExportResponderFile" tabindex="-1" aria-labelledby="modalExportResponderFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportResponderFileLabel">Download File Action Owner</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="bg-white position-relative top-1"
                         ng-repeat="item_x in data_drawingworksheet_responder | toArray | filter:{id_worksheet:id_worksheet_select}">
                        <a href="{{item_x.document_file_path}}" target="_blank">
                            {{item_x.document_file_name}}
                        </a>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Export File Responder End-->
    <!--Modal Export File Reviewer Start-->
    <div class="modal fade" id="modalExportReviewerFile" tabindex="-1" aria-labelledby="modalExportReviewerFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportReviewerFileLabel">Download File Reviewer</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="bg-white position-relative top-1"
                         ng-repeat="item_x in data_drawingworksheet_reviewer | toArray | filter:{id_worksheet:id_worksheet_select}">
                        <a href="{{item_x.document_file_path}}" target="_blank">
                            {{item_x.document_file_name}}
                        </a>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Export File Reviewer End-->
    @* Modal Confirm *@
    <div class="modal fade" id="modalEditConfirm" tabindex="-1" aria-labelledby="modalEditConfirm" aria-hidden="true"
         style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalEditConfirm">
                        <span class=" me-2 text-primary"><B>|</B></span> Do you want to confirm to change?
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false"
                             data-prefix="fas" data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg"
                             viewBox="0 0 320 512" data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 
                                  301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 
                                  0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 
                                  210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>
                <div class="modal-body">
                    <div class="col-auto" style="float:right">
                        <button style="width:100px;" class="btn btn-success me-1 mb-1" type="button" ng-click="confirmEdit()">Yes</button>
                        <button style="width:100px;" class="btn btn-outline-secondary me-1 mb-1" ng-click="cancelEdit()" type="button">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @* Modal matrix *@
    <div class="modal fade" id="modalMatrix" tabindex="-1" aria-labelledby="modalMatrix"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalMatrix">CAPEX Technical Review Matrix</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="w-100">
                        <img src="~/assets/images/messageImage.jpg" class="w-100" style="object-fit: cover;" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    @* Modal New RAM *@

    <!----------------------------------------------->
    <div class="modal fade" id="unsavedChangesModal" tabindex="-1" role="dialog" 
        aria-labelledby="unsavedChangesModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="unsavedChangesModalLabel">Unsaved Changes</h5>
                @*<button type="button border-0" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>*@
            </div>
            <div class="modal-body">
                You have unsaved changes. Are you sure you want to leave?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" type="button" data-bs-dismiss="modal" aria-label="Close" id="stayButton" 
                        ng-click="action_leavePage('stay')">Stay</button>
                <button type="button" class="btn btn-primary" id="leaveButton" ng-click="action_leavePage('leaveWithsave')">Leave with Save</button>
                <button type="button" class="btn btn-primary" id="leaveButton" ng-click="action_leavePage('leave')">Leave</button>
            </div>
            </div>
        </div>
    </div>


    @* Modal Confirm *@
    <div class="modal fade" id="modalConfirm" tabindex="-1" aria-labelledby="modalConfirm" aria-hidden="true"
         style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalConfirm">
                        <span class=" me-2 text-primary"><B>|</B></span> Invite collaborator?
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false"
                             data-prefix="fas" data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg"
                             viewBox="0 0 320 512" data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 
                                  301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 
                                  0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 
                                  210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>
                <div class="modal-body">
                    <p>Are you sure you want to invite <span class="fw-bold">{{selected_TA3.employee_displayname}}</span> to join and assist with tasks? Please confirm.</p>
                    <div class="col-auto" style="float:right">
                        <button style="width:100px;" class="btn btn-primary me-1 mb-1" type="button" ng-click="confirm()">Yes</button>
                        <button style="width:100px;" class="btn btn-outline-secondary me-1 mb-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal autosaveModal" id="autosaved" tabindex="-1" role="dialog" aria-labelledby="autosavedModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style="background-color: #dff0d8;">
                <div class="modal-body">
                    <strong>Success!</strong> Your work has been successfully saved.
                </div>
            </div>
        </div>
    </div>


</div>

@section Scripts {

    <script src="~/assets/js/angular.min.js"></script>
    <script src="~/assets/js/lodash.min.js"></script>
    <script src="~/assets/js/phoenix.js"></script>
    <script src="~/assets/js/choices.min.js"></script>
    <script src="~/assets/js/fakedata.js"></script>

    <script src="~/js/_flow/whatif.js"></script>

}
