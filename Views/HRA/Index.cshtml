@{
    ViewData["Title"] = "HRA Sub-Sofware";

    Layout = "~/Views/Shared/_LayoutWeb.cshtml";

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

    <link rel="stylesheet" href="~/assets/css/theme.min.css">

    <link rel="stylesheet" href="~/assets/css/tablefreezer.css">

    <link href="~/assets/css/theme.min.css" type="text/css" rel="stylesheet" id="style-default">

    <link href="~/assets/css/choices.min.css" type="text/css" rel="stylesheet">

    <script src="~/assets/js/config.js"></script>

    <link rel="stylesheet" href="~/css/autocomplete.css">

    <link rel="stylesheet" href="~/css/tooltips.css">

    <link rel="stylesheet" href="~/css/button.css">

    <link rel="stylesheet" href="~/css/scollbar.css">

    <link rel="stylesheet" href="~/css/myStyles.css">

    <script src="~/assets/js/all.min.js"></script>

}

<div class="content mt-1" style="font-size: 12px; min-height: auto !important; overflow-x:hidden;" id="divPage" ng-controller="ctrlAppPage">


    <div class="row g-0">

        <div class="col-6">
            <div class="card shadow-sm p-2 mb-3 bg-light rounded">
                <div class="card-body p-2">

                    <div class="row">
                        <div class="col-auto">
                            <b>PHA No.:</b> <br>
                            <span class="text-uppercase">{{ ( data_header[0].action_type =='update' ? data_header[0].pha_no : data_header[0].pha_sub_software + '-2023-00000XX')}}</span>

                        </div>
                        <div class="col-auto">
                            <b>Revision :</b> <br>
                            <span ng-if="data_header[0].pha_version>0 "> {{data_header[0].pha_version_text + '(' + data_header[0].pha_version_desc  +  ')'}}</span>
                            <span ng-if="data_header[0].pha_version==0 "> - </span>

                        </div>

                        <div class="col-auto">
                            <b>Request By :</b> <br>
                            <span>{{data_header[0].request_user_displayname}}</span>
                        </div>

                        <div class="col-auto">
                            <b>Request Status :</b> <br>
                            <span> {{data_header[0].pha_status_displayname}}</span>
                        </div>

                    </div>

                    <div class="row">
                    </div>

                </div>
            </div>

        </div>

        <div class="col-6 ">

            <div class="d-flex align-items-center py-2  justify-content-end">
                <span class="mx-2">
                    <button class="btn btn-outline-secondary btn-sm" style="width: 100px;" ng-click="confirmBack()">BACK</button>
                </span>
                <span class="mx-2" ng-if="cancle_type && data_header[0].action_change > 0">
                    <button class="btn btn-danger btn-sm" style="width: 100px;" ng-click="confirmCancle()">CANCEL</button>
                </span>
                <span class="mx-2" ng-if="save_type">
                    <button class="btn btn-primary btn-sm" style="width: 100px;" ng-click="confirmSave('save')">SAVE</button>
                </span>
                <span class="mx-2" ng-if="action_to_review_type">
                    <button class="btn btn-warning btn-sm" style="width: 200px;"
                            ng-click="confirmMailtoMemberReview('submit')">
                        <span style="font-size:9px">EMAIL TO MEMBER TEAM REVIEW</span>
                    </button>
                </span>
                <span class="mx-2" ng-if="submit_type">
                    <button class="btn btn-success btn-sm d-none" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 11" ng-click="confirmSave('submit_register')">
                        Save for PHA Conduct
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 12" ng-click="confirmSave('submit_conduct')">
                        Submit
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 22" ng-click="confirmSave('submit_conduct')">
                        Submit
                    </button>
                </span>
            </div>

            <div class="float-end pe-3">
                <div class="form-check form-switch  disabled-link">
                    <input class="form-check-input" id="flexSwitchCheckChecked" type="checkbox" />
                    <label class="form-check-label" for="flexSwitchCheckChecked">History tracking record</label>
                </div>
            </div>

        </div>

    </div>

    <div class="row g-0">
        <div class="col-12 ">

            <div class="card">

                <div class="card-header mb-0 pb-0 border border-bottom-0 ">

                    <ul class="nav nav-underline border-3 border-primary border-bottom p-0 m-0" id="myTab" role="tablist">

                        <li ng-repeat="tab in tabs" class="mx-2  p-0 m-0" ng-if="tab.isShow || true">
                            <a ng-click="changeTab(tab)"
                               class="btn btn-outline-primary border border-0 "
                               ng-class="{'btn btn-outline-primary border border-0 mx-2  p-1 m-0 active': (tab.isActive==true),'btn btn-outline-primary border border-0 mx-2  p-1 m-0': (tab.isActive==false) }"
                               style="border-radius: 10px 10px 0px 0px !important;"
                               id="{{tab.name}}-tab" name="{{tab.name}}-tab"
                               data-bs-toggle="tab" href="#tab-{{tab.name}}" role="tab"
                               aria-controls="tab-{{tab.name}}"
                               aria-selected="tab.isActive">{{ tab.title }}</a>
                        </li>
                    </ul>

                </div>


                <div class="card-body tab-content">
                    <!-- general information start -->
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==1),'tab-pane fade':(action_part!==1)}"
                         id="tab-general" role="tabpanel" aria-labelledby="general-tab">
                        @* General Start*@
                        <div class="m-3 row  gx-0 align-items-center ">
                            <div class="card border-0">
                                <div class="mx-1 row g-3 align-items-center" ng-repeat="item in data_general ">
                                    <!-- company -->
                                    <div class="col-md-2 ">
                                        <label class="form-label ps-0" for="expense_type">
                                            <b class="text-danger d-none"> * </b>
                                            departments
                                        </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip"
                                               data-bs-placement="top" 
                                               name="departments" 
                                               title="" 
                                               data-bs-html="true">
                                            </a>
                                        </label>
                                        <select class="form-control"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                @* ng-change="actionChange(item,item.seq,'')"  *@
                                                ng-model="item.id_departments">
                                            <option value="">Please select</option>
                                            <option ng-repeat="item2 in data_departments" 
                                                    ng-value="item2.id">
                                                {{item2.departments}}
                                            </option>
                                        </select>
                                    </div>
                                    <!-- company -->
                                    <!-- sections -->
                                    <div class="col-md-2 ">
                                        <label class="form-label ps-0" for="expense_type">
                                            <b class="text-danger d-none"> * </b>
                                            sections
                                        </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip"
                                               data-bs-placement="top" 
                                               name="sections" 
                                               title="" 
                                               data-bs-html="true">
                                            </a>
                                        </label>
                                        <select class="form-control"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                @* ng-change="actionChange(item,item.seq,'')"  *@
                                                ng-model="item.id_sections"
                                                >
                                            <option value="">Please select</option>
                                            <option ng-repeat="item2 in data_sections" 
                                                ng-value="item2.sections">
                                                {{item2.sections}}
                                            </option>
                                        </select>
                                    </div>
                                    <!-- sections -->

                                    <!-------Verified By--------->
                                    <div class="col-md-2 ">
                                        <label class="form-label ps-0" for="">
                                            <b class="text-danger d-none"> * </b>
                                            Verified By 
                                        </label>
                                        <select class="form-control"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                @* ng-model="" *@
                                                >
                                            <option 
                                                ng-value="">
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="mx-1 row g-3 align-items-center" ng-repeat="item in data_general ">

                                    <!-- company -->
                                    <div class="col-md-2 ">

                                        <label class="form-label ps-0" for="expense_type">
                                            <b class="text-danger d-none"> * </b>Company
                                        </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" name="company" title="" data-bs-html="true"></a>
                                        </label>

                                        <select class="form-control js-choice-company "
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')" ng-model="item.id_company">
                                            <option ng-repeat="item2 in master_company | orderBy:'id'" ng-value="item2.id">
                                                {{item2.name}}
                                            </option>
                                        </select>

                                    </div>
                                    <!-- company -->
                                    <!-- area -->
                                    <div class="col-md-auto p-1 " ng-if="item.id_company != '9999' ">
                                        <div class="row g-0 align-items-center">
                                            <div class="col-12 p-1  ">
                                                <label class="form-label ps-0" for="area"><b class="text-danger d-none"> * </b>Area Process Unit </label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" 
                                                       title=" Area Process Unit : A" 
                                                       data-bs-html="true">
                                                    </a>
                                                </label>
                                                <label class="form-label ps-0" for="area"></label>
                                                <select class="form-control js-choice-apu"
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        data-choices="data-choices"
                                                        data-options='{"removeItemButton":true,"placeholder":true}'
                                                        ng-change="actionChange(item,item.seq,'')" 
                                                        ng-model="item.id_apu">
                                                    <option ng-repeat="item2 in master_apu" ng-value="item2.id">
                                                        {{item2.name}}
                                                    </option>
                                                </select>

                                            </div>

                                        </div>
                                    </div>
                                    <!-- area -->
                                    <!-- toc -->
                                    <div class="col-md-auto p-1 d-none" ng-if="item.id_company != '9999' ">
                                        <div class="row g-0 align-items-center">
                                            <div class="col-12 p-1  ">

                                                <label class="form-label ps-0" for="toc"><b class="text-danger d-none"> * </b>Thaioil Complex </label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title="Thaioil Complex" data-bs-html="true"></a>
                                                </label>
                                                <label class="form-label ps-0" for="toc"></label>
                                                <select class="form-control js-choice-toc"
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        data-choices="data-choices"
                                                        data-options='{"removeItemButton":true,"placeholder":true}'
                                                        ng-change="actionChange(item,item.seq,'')" ng-model="item.id_toc">
                                                    <option ng-repeat="item2 in master_toc"
                                                            ng-value="item2.id"
                                                            value="item2.id"
                                                            ng-if="item2.id_company == item.id_company && item2.id_area == item.id_apu">
                                                        {{item2.name}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- toc -->
                                    <!-- Unit No -->
                                    <div class="col-md-3 p-1 align-items-top" ng-if="item.id_company != '9999' ">

                                        <label class="form-label ps-0" for="unit"><b class="text-danger"> * </b>Name of Area </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip"
                                                data-bs-placement="top" 
                                                title=" Name of Area" 
                                                data-bs-html="true">
                                               </a>
                                        </label>

                                        <select class="form-control col-auto js-choice-unit_no"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'unit_no')" 
                                                ng-model="item.id_unit_no">
                                            <option ng-selected="item.id_unit_no == item2.id"
                                                    ng-repeat="item2 in master_unit_no" 
                                                    ng-value="item2.id"
                                                    ng-if="item2.id_company == item.id_company &&
                                                            item2.id_apu == item.id_apu">
                                                {{item2.name}}
                                            </option>
                                        </select>

                                    </div>
                                    <!-- Unit No -->
                                    @* Project Type  *@
                                    <div class="col-md-2">
                                        <label class="form-label ps-0" for="expense_type"><b class="text-danger"> * </b>Project Type</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Project Type : OPEX" data-bs-html="true"></a>
                                        </label>

                                        <select class="form-select rounded-1"
                                                ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                id="expense_type" placeholder="Project Type"
                                                name="expense_type" ng-model="item.expense_type" ng-if="data_header[0].pha_status == 11"
                                                ng-change="actionChange(item,item.seq,'expense_type')">
                                            <option id="MOC">MOC</option>
                                            <option id="5YEAR">5YEAR</option>
                                        </select>
                                        <select class="form-select rounded-1 disabled-link" ng-if="data_header[0].pha_status>=12"
                                                ng-model="item.expense_type">
                                            <option id="MOC">MOC</option>
                                            <option id="5YEAR">5YEAR</option>
                                        </select>
                                    </div>
                                    @* Reference Number  *@
                                    <div class="col-md-3 ">
                                        <div class="row g-0 align-items-center">

                                            <div class="col-12 p-1">
                                                <label class="form-label ps-0" for="unit">{{(item.expense_type=='MOC'? 'e-MOC Reference Number' : 'MOC Reference Number')}} </label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title=" Reference MOC : PN-13081" data-bs-html="true"></a>
                                                </label>
                                                <input type="text" name="reference_moc" class="form-control rounded-1"
                                                       ng-class="{'disabled-link':(!tab_general_active)}"
                                                       ng-keyup="actionChange(item,item.seq,'')" ng-model="item.reference_moc"
                                                       placeholder="Input Data"
                                                       autocomplete="off"
                                                       value="PN-13089">
                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <div class="mx-1 row  g-3 align-items-center" ng-repeat="item in data_general"
                                     ng-class="{'disabled-link':(!tab_general_active)}">

                                    <!-- Project Name -->
                                    <div class="col-md-5 p-1">

                                        <label class="form-label ps-0">{{(item.expense_type=='MOC'? 'MOC Title' : 'Project Name')}}</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top"
                                               data-bs-html="true"></a>
                                        </label>

                                        <input class="form-control rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                               type="text" placeholder="Project Name"
                                               name="project_name"
                                               ng-model="item.pha_request_name"
                                               ng-keyup="filterResultGeneral(item.pha_request_name, 'pha_request_name')">
                                        <ul class="list-group mt-2 w-25" style="position: absolute;" ng-show="showResults">
                                            <li class="list-group-item "
                                                ng-repeat="result in filteredResults | filter:{field:'pha_request_name'}"
                                                ng-click="selectResult(result,item,'pha_request_name')">
                                                {{ result.name }}
                                            </li>
                                        </ul>

                                    </div>

                                    <!-- Target Date -->
                                    <div class="col-md-7 p-1">

                                        <div class="row g-0 align-items-center">
                                            <div class="col-md-3 p-1">
                                                <label class="form-label ps-0" for="tgs_date">Target Start Date</label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title=" Target Start Date :  " data-bs-html="true"></a>
                                                </label>
                                                <input type="date" ng-model="item.target_start_date"
                                                       ng-keyup="actionChange(item,item.seq,'')"
                                                       class="form-control rounded-1 datetimepicker"
                                                       ng-class="{'disabled-link':(!tab_general_active)}"
                                                       placeholder="dd/mm/yyyy">
                                            </div>

                                            <div class="col-md-auto p-1">
                                                <label class="form-label ps-0" for="tge_date">COMPLETION DATE (CLOSE OUT REPORT)</label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title=" Complete Date :  " data-bs-html="true"></a>
                                                </label>
                                                <input type="date" name="te_date" ng-model="item.target_end_date"
                                                       ng-keyup="actionChange(item,item.seq,'')"
                                                       class="form-control rounded-1 datetimepicker" ng-class="{'disabled-link':(!tab_general_active)}"
                                                       id="tgs_date"
                                                       placeholder="dd/mm/yyyy">
                                            </div>

                                        </div>
                                    </div>

                                </div>

                                <div class="mx-2 row  gx-0 align-items-center" ng-repeat="item in data_general"
                                     ng-class="{'disabled-link':(!tab_general_active)}">

                                    <div class="col-5 p-1">

                                        <label class="form-label ps-0" for="description_general">Description/Remark :</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Description/Remark :  " data-bs-html="true"></a>
                                        </label>

                                        <textarea class="form-control rounded-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                                  id="description_general" name="description_general"
                                                  placeholder="Description/Remark" style="height: 100px"
                                                  ng-model="item.descriptions">
                                        </textarea>

                                    </div>
                                </div>

                            </div>
                        </div>
                        @* General End*@

                        @* Session Start*@
                        <div class="m-3 row gx-0 align-items-center ">
                            <div class="card px-2">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Session</h5>
                                    </div>
                                </div>
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3 d-none">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>{{ sub_software }} Member</h5>
                                    </div>

                                    <div class="float-end align-top ms-1" ng-class="{'tab-pane fade show active':!(data_header[0].pha_status==11)}">
                                        <div class="float-end pe-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" id="switchEmailToMemberChecked"
                                                       type="checkbox"
                                                       ng-click="stamp_flow_mail_to_member_show()" />
                                                <label class="form-check-label" for="switchEmailToMemberChecked">Email Notification to Member Team</label>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-12 col-md mx-1">

                                    <div class="table-responsive scrollbar">

                                        <table class="table mb-0 table-borderless">

                                            <thead class="  text-uppercase text-start border-bottom">
                                                <tr>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">No</th>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">Member team {{!(data_general[0].expense_type=='MOC')?' and Assessment Team Leader':''}}</th>

                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">Session Date Time </th>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2"></th>
                                                </tr>
                                            </thead>

                                            <tbody class="" id="customer-rating-table-body">

                                                <tr ng-repeat="item in data_session | orderBy:no" class="">

                                                    <td class="align-top text-top" style="width: 30px;">
                                                        <h6 class="fw-semi-bold text-center pt-1">{{item.no}}</h6>
                                                    </td>

                                                    @* Member Team *@
                                                    <td class="align-top col-auto" style="min-width: 500px;">
                                                        <div class="row d-flex">
                                                            <div class="col-6">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">

                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'member')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>Add Member Team
                                                                    </button>

                                                                </div>

                                                                <div class="row" ng-repeat="item2 in data_memberteam | filter:{id_session:item.seq }">

                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>

                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="col-6" ng-if="!(data_general[0].expense_type=='MOC')">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'approver')">
                                                                        <span class="far fa-address-book fa-lg"></span>
                                                                        Add Assessment Team Leader
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_approver | filter:{id_session:item.seq }">
                                                                    <div class="row align-items-center  p-1">
                                                                        @* <label class="mb-0 text-1100 fw-bold" 
                                                                            style="width:80%;border-color: #f1f2f4;"
                                                                            ng-if=" (item2.approver_type=='approver' && item2.user_displayname)">
                                                                               {{ '(QMTS)' + item2.user_displayname}}
                                                                        </label> *@
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                            style="width:80%;border-color: #f1f2f4;"
                                                                            >
                                                                            {{ item2.verified ? '(Verified)' : '' }}
                                                                            {{ item2.approver_type == 'approver' && item2.user_displayname ? '(QMTS)' : ''}}  
                                                                            {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>


                                                    </td>

                                                    @* Session Date *@
                                                    <td class="align-top">

                                                        <div class="row g-2" ng-class="{'disabled-link':(!tab_general_active)}">

                                                            <span class="row ms-1 p-0">

                                                                <span class="col-md-4  p-1 ">
                                                                    <label class="form-label d-none" for="meeting_date">Meeting Date</label>

                                                                    <input type="date" class="form-control rounded-1 datetimepicker" id="meeting_date" name="meeting_date"
                                                                           ng-change="actionChange(item,item.seq,'meeting_date')"
                                                                           ng-model="item.meeting_date" placeholder="dd/mm/yyyy">

                                                                </span>

                                                                <span class="col-md-1 p-1 d-flex">
                                                                    <label class="form-label p-0 pt-2">Time</label>
                                                                </span>
                                                                <span class="col-md-3  p-1 d-flex">
                                                                    <label class="form-label d-none" for="timepicker1">Start Time</label>
                                                                    <label class="form-label d-none" style="font-size: 10px;">{{formatTo24Hour(item.meeting_start_time)}}</label>

                                                                    <input class="form-control  d-none" id="st_meet" name="st_meet"
                                                                           style="width:20px; height: 20px"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_start_time" value="{{formatTo24Hour(item.meeting_start_time)}}"
                                                                           type="time" placeholder="hour : minute" />

                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_start_time_hh"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_hours" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_start_time_mm"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_minutes" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>

                                                                </span>
                                                                <span class="col-md-1 p-1 d-flex">
                                                                    <label class="form-label p-0 pt-2">To</label>
                                                                </span>
                                                                <span class="col-md-3 p-1 d-flex">
                                                                    <label class="form-label d-none" for="timepicker2">End Time</label>
                                                                    <label class="form-label d-none" style="font-size: 10px;">{{formatTo24Hour(item.meeting_end_time)}}</label>
                                                                    <input class="form-control  d-none" id="et_meet" name="et_meet"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_end_time"
                                                                           type="time" placeholder="hour : minute" />

                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_end_time_hh"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_hours" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_end_time_mm"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_minutes" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                </span>

                                                            </span>

                                                        </div>
                                                    </td>

                                                    @* Buton Action *@
                                                    <td class="align-top " style="width: 158px;" ng-class="{'d-none': (!tab_general_active)}">

                                                        <div class="col-12" style="width: 158px;">
                                                            <div class="float-end">
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                                            ng-click=removeDataSession(item.seq,$index)>
                                                                        <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                                            ng-click=copyDataSession(item.seq,$index)>
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1 d-none">
                                                                    <button class="btn btn-outline-secondary p-2" style="color: #1336fc; background-color: #f1f2f4; border-color: #a8a8a8;"
                                                                            ng-click=copyDataSession(item.seq,$index)>
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                                            ng-click=addDataSession(item.seq,$index)>
                                                                        <span class="fas fa-square-plus fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                            </div>
                                                        </div>
                                                    </td>

                                                </tr>


                                            </tbody>

                                        </table>

                                    </div>

                                </div>
                            </div>

                        </div>
                        @* Session End*@

                        @* Drawing Start*@
                        <div class="m-3 row  gx-0 align-items-center">
                            <div class="card px-2">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Document & Reference</h5>
                                    </div>
                                </div>
                                <div class="col-12 col-md mx-1">

                                    <div class="table-responsive scrollbar">

                                        <table class="table fs--1 mb-0 table-borderless">
                                            <thead class=" text-uppercase border-bottom">
                                                <tr>
                                                    <th class="align-middle text-center" style="font-size: 10px;">No</th>
                                                    <th class="align-middle" style="font-size: 10px;">Document Name</th>
                                                    <th class="align-middle d-none" style="font-size: 10px;"><b class="text-danger"> * </b>Drawing No</th>
                                                    <th class="align-middle" style="font-size: 10px;"><b class="text-danger"> * </b>Document File</th>
                                                    <th class="align-middle" style="font-size: 10px;">Comment </th>
                                                    <th class="align-middle" style="font-size: 10px;"> </th>

                                                </tr>
                                            </thead>

                                            <tbody class="list" id="customer-rating-table-body ">
                                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                                    ng-repeat="item in data_drawing">
                                                    <td class="align-middle text-center">
                                                        <div class="p-1 ">
                                                            <h6 class="fw-semi-bold">{{item.no}}</h6>
                                                        </div>
                                                    </td>
                                                    <td class="align-middle white-space-nowrap ">
                                                        <textarea ng-keyup="actionChange(item,item.seq,'')" ng-model="item.document_name"
                                                                  class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                  ng-class="{'disabled-link':(!tab_general_active)}"
                                                                  placeholder="Document Name"
                                                                  style="font-size: 10px;"></textarea>
                                                    </td>
                                                    <td class="align-middle white-space-nowrap ">

                                                        <textarea ng-keyup="actionChange(item,item.seq,'')" ng-model="item.document_no"
                                                                  class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                  ng-class="{'disabled-link':(!tab_general_active)}"
                                                                  placeholder="Drawing No"
                                                                  style="font-size: 10px;"></textarea>

                                                    </td>

                                                    <td class="align-middle white-space col-3">
                                                        <div class="row uploadbox align-items-center" ng-if="tab_general_active">
                                                            <div class="btn-group">
                                                                <div class="icon-button border p-3" style="border-color: #0d6efd; background-color: #0d6efd;">
                                                                    <span class="fa-solid fa-arrow-up-from-bracket fa-lg" style="color: #ffffff;"></span>
                                                                </div>
                                                                <button class="Upload-button btn ps-3"  ng-if="!item.document_file_size">
                                                                    <label class="dz-message-text  fw-bold cursor-pointer"
                                                                        for="attfile-{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}">
                                                                        Upload File(Word, Excel, PDF, Image)
                                                                    </label>
                                                                    <input type="file" id="attfile-{{item.seq}}"
                                                                        name="file{{item.seq}}"
                                                                        onchange="angular.element(this).scope().fileSelect(this,'drawing')"
                                                                        style="display:none" />
                                                                </button>
                                                                <button class="Upload-button btn ps-3" ng-if="item.document_file_size > 0">
                                                                    <div class="d-flex align-items-center">
                                                                        <span class="mr-3 nametext"
                                                                            id="filename{{item.seq}}" 
                                                                            ng-class="{'d-none':(!tab_general_active)}"
                                                                            ng-click="downloadFile(item)"
                                                                            ng-if="item.document_file_size>0">
                                                                            <b style="font-size:x-small;">
                                                                                {{truncateFilename(item.document_file_name, 20)}} ({{item.document_file_size}} KB)
                                                                            </b>
                                                                        </span>
                                                                        <a id="deluploadfile-{{item.seq}}" class="btn btn-link text-danger p-0 ms-2"
                                                                                ng-class="{'d-none':(!tab_general_active)}"
                                                                                ng-click="clearFileName(item.seq)">
                                                                            <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                        </a>

                                                                    </div>
                                                                </button> 
                                                            </div>                                                                                                                                                                            
                                                            @*<div class=" align-items-center p-1 cursor-pointer ">

                                                                <br ng-if="item.document_file_size>0">
                                                                <label class="dz-message-text text-primary fw-bold cursor-pointer"
                                                                       for="attfile-{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-3"></i>Upload File(Word, Excel, PDF, Image)
                                                                </label>
                                                                <input type="file" id="attfile-{{item.seq}}"
                                                                       name="file{{item.seq}}"
                                                                       onchange="angular.element(this).scope().fileSelect(this,'drawing')"
                                                                       style="display:none" />
                                                                <button id="del-{{item.seq}}" class="btn btn-link text-danger"
                                                                        ng-class="{'d-none':(!tab_general_active)}"
                                                                        ng-click="clearFileName(item.seq)"
                                                                        ng-if="item.document_file_size>0">
                                                                    <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                </button>
                                                                <br>
                                                                <a class="nametext ms-3 filename-text me-2"
                                                                   ng-class="{'d-none':(tab_general_active)}"
                                                                   ng-click="downloadFile(item)">
                                                                    <i class="far fa-file-pdf text-danger"></i> 
                                                                    {{(item.document_file_size>0? item.document_file_name + '('+  item.document_file_size + 'KB)' : '')}}
                                                                </a>
                                                            </div>*@
                                                        </div>

                                                        <div id="drawing-document-file-{{item.seq}}"
                                                             class="invalid-feedback text-danger">
                                                            Please provide a valid Drawing.(Max size 10mb)
                                                        </div>

                                                    </td>

                                                    <td class="align-middle ">
                                                        <div class="col-12">
                                                            <textarea class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                      ng-class="{'disabled-link':(!tab_general_active)}"
                                                                      ng-keyup="actionChange(item,item.seq,'')"
                                                                      ng-model="item.descriptions"
                                                                      placeholder="Comment"
                                                                      style="font-size: 10px;"></textarea>
                                                        </div>

                                                    </td>
                                                    <td class="align-middle " style="width: 158px;" ng-class="{'d-none': (!tab_general_active)}">
                                                        <div class="col-12" style="width: 158px;">
                                                            <div class="float-end ">

                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                                            ng-click=removeDrawingDoc(item.seq,$index-1)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Remove">
                                                                        <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1 d-none">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #1336fc; background-color: #f1f2f4; border-color: #a8a8a8;"
                                                                            ng-click=copyDrawingDoc(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy">
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                                            ng-click=addDrawingDoc(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Add">
                                                                        <span class="fas fa-square-plus fa-lg"></span>
                                                                    </button>
                                                                </span>


                                                            </div>
                                                        </div>
                                                    </td>


                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                        @* Drawing End*@

                    </div>
                    @* general information end*@


                    @* List of Areas to Be Assessed and Health Hazards or Risk Factors start*@
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==2),'tab-pane fade':(action_part!==2)}"
                         id="tab-areas" role="tabpanel" aria-labelledby="areas-tab">

                        <div style="background-color: #ffffff;">
                            <div class="mx-3 row  g-3 align-items-top ">
                                <div class="d-flex gap-4">
                                    <p ng-repeat="item2 in master_apu | filter:{
                                        id: data_general[0].id_apu}">
                                         <b>AREA: &nbsp;</b>{{item2.name}}
                                    </p>
                                    <p ng-repeat="item2 in master_unit_no | filter:{
                                        id: data_general[0].id_unit_no, 
                                        id_apu: data_general[0].id_apu,
                                        id_company: data_general[0].id_company} ">
                                        <b>UNIT: &nbsp;</b>{{item2.name}}
                                    </p>
                                </div>
                                <!------ NAME OF SUB AREA :------>
                                <div class="table-responsive scrollbar mb-3" id="table-container">

                                    <table class="table fs--2 mb-0 table-bordered">
                                        <thead class=" text-uppercase  text-center bg-soft">
                                            <tr>
                                                <th class="sort align-middle text-center px-0" style="width: 6%;">

                                                </th>
                                                <th class="sort align-middle text-start px-1" style="width: 26%;">
                                                    NAME OF SUB AREA
                                                </th>
                                                <th class="sort align-middle px-0" style="width: 30%;">
                                                    TYPE OF HAZARD
                                                </th>
                                                <th class="sort align-middle px-0" style="width: 30%;">
                                                    HEALTH HAZARDS OR RISK FACTOR
                                                </th>
                                                <th class="sort align-middle px-0" style="width: 8%;">
                                                    HEALTH EFFECT RATING
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class="list">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static p-0"
                                                ng-repeat="item in data_subareas_list">
                                                 
                                                <td class="align-top text-center px-0">
                                                    <div class="p-1">
                                                        <div class="align-top ">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static ">
                                                                <span class="px-1">{{ item.no }}</span>
                                                            </div>
                                                        </div>

                                                        <div class="font-sans-serif btn-reveal-trigger position-static" ng-class="{'d-none': !(tab_general_active)}">
                                                            <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                type="button" 
                                                                data-bs-toggle="dropdown" 
                                                                data-boundary="window" 
                                                                aria-haspopup="true"
                                                                aria-expanded="false" 
                                                                data-bs-reference="parent">
                                                                <span class="fas fa-cog text-info"></span>
                                                            </button>
                                                            <div class="dropdown-menu dropdown-menu-end py-2">
                                                                <a class="dropdown-item text-success" ng-click="addDataSubAreasList(item,$index)">
                                                                    <span class="fas fa-copy"></span>
                                                                    Add
                                                                </a>
                                                                <div class="dropdown-divider" ng-if="!(item.no == 1)"></div>
                                                                <a class="dropdown-item text-danger" 
                                                                    ng-if="!(item.no == 1)"
                                                                    ng-click="removeDataSubAreasList(item, $index)">
                                                                   <span class="fas fa-times-circle"></span> 
                                                                   Remove
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>

                                                <td class="align-top px-1 text-center">
                                                    <div class="py-2">
                                                        <select class="form-control"
                                                                ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                                @* ng-change="actionChange(item,item.seq,'sub_area')" *@
                                                                ng-change="actionChangeTabArea('sub_area', item)"
                                                                ng-model="item.sub_area"
                                                                ng-if="tab_general_active">
                                                            <option value="" disabled>Please select</option>
                                                            <option ng-repeat="item_m in master_subarea" 
                                                                    ng-value="item_m.name">
                                                                {{item_m.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                    <textarea class="form-control rounded-1" 
                                                            ng-if="item.sub_area"
                                                            ng-class="{'disabled-link':(!tab_general_active) || !item.sub_area}"
                                                            id="description_general" 
                                                            name="description_general"
                                                            placeholder="Sub Area" 
                                                            style="height: 100px"
                                                            ng-change="actionChangeSubArae(item)"
                                                            ng-model="item.work_of_task">
                                                    </textarea>
                                                    @* <b class="p-2 d-flex align-items-start text-start px-">{{item.work_of_task}}</b> *@
                                                </td>

                                                <td class="align-top text-center px-1" colspan="3">
                                                    <div class="d-flex gap-2 py-2" 
                                                        style="width: 100%;"
                                                        ng-repeat="(index, item_list) in item.hazard">
                                                        @* number *@
                                                        <div class="" style="padding-left: 4px; width: 10%">
                                                            <div class="align-top ">
                                                                <div class="font-sans-serif btn-reveal-trigger position-static ">
                                                                    <span class="px-1">{{item_list.no_subareas}}.{{ item_list.no }}</span>
                                                                </div>
                                                            </div>

                                                            <div class="font-sans-serif btn-reveal-trigger position-static" ng-class="{'d-none': !(tab_general_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <a class="dropdown-item text-success" 
                                                                        ng-click="addDataHazardList(item, item_list, MaxSeqdataSubareas)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider" ng-if="!(item_list.no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" 
                                                                        ng-if="!(item_list.no == 1)"
                                                                        ng-click="removeDataHazardList(item, item_list, $index)">
                                                                        <span class="fas fa-times-circle"></span>
                                                                        Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        @* master_hazard_type *@
                                                        <select class="form-control"
                                                            style="width: 32%;"
                                                            ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                            ng-change="actionChangeTabArea('type_hazard', item, item_list)"
                                                            @* ng-click="actionChangeTabArea('disabled_type_hazard', item, item_list)" *@
                                                            ng-model="item_list.id_type_hazard"
                                                            ng-if="tab_general_active">
                                                            <option value="" disabled>Please select</option>
                                                            <option ng-repeat="item_m in master_hazard_type" 
                                                                    ng-if="!item_m.disabled"
                                                                    ng-value="item_m.id">
                                                                {{item_m.name}}
                                                            </option>
                                                        </select> 

                                                        @* number *@
                                                        <div class="" style="padding-left: 4px; width: 10%">
                                                            <div class="align-top">
                                                                <div class="font-sans-serif btn-reveal-trigger position-static ">
                                                                    <span class="px-1"> </span>
                                                                    @* <span class="px-1">{{item_list.no_subareas}}.{{ item_list.no }}</span> *@
                                                                </div>
                                                            </div>

                                                            <div class="font-sans-serif btn-reveal-trigger position-static" ng-class="{'d-none': !(tab_general_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <a class="dropdown-item text-success" 
                                                                        ng-click="addDataHazardList(item, item_list, MaxSeqdataSubareas)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider" ng-if="!(item_list.no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" 
                                                                        ng-if="!(item_list.no == 1)"
                                                                        ng-click="removeDataHazardList(item, item_list, $index)">
                                                                        <span class="fas fa-times-circle"></span>
                                                                        Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        @* master_hazard_riskfactors *@
                                                        <div class="mx-2"  style="width: 32%;">
                                                            <button ng-if="!item_list.health_hazard" 
                                                                ng-disabled="!item_list.id_type_hazard"
                                                                class="btn btn-outline-secondary btn-sm w-100 h-100" 
                                                                style="border: 1px solid #cbd0dd " 
                                                                ng-click="openModalRisk(item_list, index)">
                                                                Please select
                                                            </button>
                                                            <button ng-if="item_list.health_hazard" 
                                                                ng-disabled="!item_list.id_type_hazard"
                                                                class="btn btn-outline-secondary btn-sm w-100 h-100" 
                                                                style="border: 1px solid #cbd0dd " 
                                                                ng-click="openModalRisk(item_list, index)">
                                                                {{item_list.health_hazard}}
                                                            </button>
                                                        </div>

                                                        @* health_effect_rating *@
                                                        <div class="d-flex align-items-center justify-content-center gap-2"  
                                                                style="width: 8%;">
                                                            @* rating *@
                                                            <div class="effect-rating" 
                                                                @* ng-class="{'mr-27': (item_list.count_riskfactors <= 1)}" *@
                                                                ng-class="{
                                                                    'bg-success': (item_list.health_effect_rating == '1' || item_list.health_effect_rating == '2'),
                                                                    'bg-warning': (item_list.health_effect_rating == '3') 
                                                                }"  
                                                                ng-if="item_list.health_effect_rating"
                                                                ng-click="openModalRisk(item_list, index)">
                                                                {{item_list.health_effect_rating}}
                                                            </div>
                                                            @* icon *@
                                                            <div class="font-sans-serif btn-reveal-trigger position-static" 
                                                                ng-class="{'d-none': !(tab_general_active)}"
                                                                ng-if="item_list.health_effect_rating && item_list.count_riskfactors > 1">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        ng-click="chooseRiskRating(item_list)">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <div class="d-flex align-items-center justify-content-start px-2 gap-2 flex-wrap"
                                                                        style="max-width: 177px;">
                                                                        <div ng-repeat="item_sub in sub_hazard_riskfactors" 
                                                                            class="d-flex align-items-center justify-content-center">
                                                                            <div class="effect-rating"
                                                                                ng-class="{
                                                                                    'bg-success': (item_sub.hazards_rating == '1' || item_sub.hazards_rating == '2'),
                                                                                    'bg-warning': (item_sub.hazards_rating == '3') 
                                                                                }"  
                                                                                ng-click="changeRiskRating(item_list, item_sub)">
                                                                                {{item_sub.hazards_rating}}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                </div>

                            </div>
                        </div>
                    </div>
                    @* List of Areas to Be Assessed and Health Hazards or Risk Factors end*@

                    @* List of Worker Groups and Description of Tasks start*@
                    <div class="" 
                        ng-class="{'tab-pane fade show active':(action_part==3),'tab-pane fade':(action_part!==3)}"
                        id="tab-worker" 
                        role="tabpanel" 
                        aria-labelledby="worker-tab">
                        <div style="background-color: #ffffff;">
                            <div class="mx-3 row  g-3 align-items-top ">
                                <div class="d-flex gap-4">
                                    <p><b>DEPARTMENT: &nbsp;</b>{{data_general[0].id_departments}}</p>
                                    <p><b>SECTIONS: &nbsp;</b>{{data_general[0].id_sections}}</p>
                                </div>
                                <div class="table-responsive scrollbar" id="table-container">
                                    <table class="table fs--2 mb-0 table-bordered">
                                        <thead class=" text-uppercase  text-center bg-soft">
                                            <tr>
                                                <th class="sort align-middle" colspan="2" rowspan="1" style="width: 40%;">
                                                    NAME OF WORKER GROUP
                                                </th>
                                                <th class="sort align-middle text-center" colspan="1" rowspan="2" style="width: 5%;">
                                                    NUMBERS OF WORKERS
                                                </th>
                                                <th class="sort align-middle text-center" colspan="1" rowspan="2" style="width: 30%;">
                                                    DESCRIPTION OF WORK OR TASK
                                                </th>
                                                <th class="sort align-middle text-center" colspan="1" rowspan="2" style="width: 15%;">
                                                    ACTION
                                                </th>
                                            </tr>
                                            <tr>
                                                <th class=" align-middle text-start" style="width: 20%;">AREA</th>
                                                <th class=" align-middle text-start" style="width: 20%;">WORKER GROUP</th>
                                                @* <th class=" align-middle text-start">EMPLOYEES /STAFF MEMBERS</th> *@
                                            </tr>
                                        </thead>
                                        <tbody class="list" id="customer-rating-table-body">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static" 
                                                ng-repeat="(index, item) in data_tasks" 
                                                ng-if="item.tasks_type_other == 0">

                                                <td class="align-top rating white-space-nowrap px-1" 
                                                    style="width: 150px;" 
                                                    rowspan="{{data_tasks.length}}" 
                                                    ng-if="$index == 0"> 
                                                    <p class="text-1100 fw-bold p-3" ng-if="$index == 0">
                                                        {{selectedBusiness_Unit}}
                                                    </p>
                                                </td>

                                                <!----span work lenght rowspan=""----->
                                                <td class="align-top rating white-space-nowrap px-1" style="width: 250px;" > 
                                                    <div class="d-flex align-items-center mx-1 p-1">
                                                        <div style="padding-right: 8px;">
                                                            <div class="align-top text-center">
                                                                <div class="font-sans-serif btn-reveal-trigger position-static ">
                                                                    <span class="px-1">{{ item.no }}</span>
                                                                </div>
                                                            </div>
                                                            <div class="font-sans-serif btn-reveal-trigger position-static"
                                                                 ng-class="{'d-none': !(tab_general_active)}"
                                                                 ng-if="item.tasks_type_other == 0">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="addDataTasks(item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider" ng-if="!(item.no == 1)"></div>
                                                                    <a class="dropdown-item text-danger" 
                                                                        ng-if="!(item.no == 1)"
                                                                        ng-click="removeDataTasks(item,$index)">
                                                                       <span class="fas fa-times-circle"></span> 
                                                                       Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <select class="form-control"
                                                                ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                                ng-change="actionChangeWorkGroup(item)"
                                                                @* ng-change="actionChange(item,item.seq,'worker_group')" *@
                                                                ng-model="item.id_worker_group"
                                                                ng-if="item.tasks_type_other == 0">
                                                            <option ng-repeat="item_m in master_worker_group" ng-value="item_m.id">
                                                                {{item_m.name}}
                                                            </option>
                                                        </select>
                                                        <input type="text" class="form-control" 
                                                            placeholder="Name"
                                                            ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                            ng-model="item.worker_group"
                                                            ng-if="item.tasks_type_other == 1"
                                                            >
                                                    </div>
                                                </td>

                                                <!----span work/task lenght rowspan=""----->
                                                @* <td class="align-top rating px-1 d-flex flex-column align-items-center justify-content-start" >
                                                    <div class="d-flex justify-content-start w-100 ps-2" ng-show="item.id_worker_group">
                                                        <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                ng-click="openDataEmployeeAdd(item,'worker')">
                                                            <span class="far fa-address-book fa-lg pe-1"></span>Add Workers
                                                        </button>

                                                    </div>  
                                                    <div class="d-flex justify-content-start w-100 ps-2"
                                                         ng-repeat="workers in data_workers">
                                                        <p class="text-1100 text-start fw-bold">{{workers.user_displayname}}</p>
                                                    </div>
                                                </td> *@

                                                <!----span work/task lenght rowspan=""----->
                                                <td class="align-top status text-center px-1" ><!----span same id work group? same no. ----->
                                                    <p class="p-3">
                                                        <b>{{ item.numbers_of_workers }}</b>
                                                    </p>
                                                </td>

                                                <!----- work or task ==> can be add------->
                                                <td class="align-top pt-1">
                                                    <div class="d-flex align-items-center mx-1 p-1" ng-repeat="item_d in item.descriptions">
                                                        <div>
                                                            <div class="font-sans-serif btn-reveal-trigger position-static">
                                                                <span class="px-1">
                                                                    <div style="padding-right: 8px;">
                                                                        <div class="align-top text-center">
                                                                            <div class="font-sans-serif btn-reveal-trigger position-static ">
                                                                                <span class="px-1">{{index + 1}}.{{item_d.no}} </span>
                                                                            </div>
                                                                        </div>
                                                                        <div class="font-sans-serif btn-reveal-trigger position-static" 
                                                                            ng-class="{'d-none': !(tab_general_active && item.tasks_type_other == 0)}">
                                                                            <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1" 
                                                                                    type="button" 
                                                                                    data-bs-toggle="dropdown" 
                                                                                    data-boundary="window" 
                                                                                    aria-haspopup="true" 
                                                                                    aria-expanded="false" 
                                                                                    data-bs-reference="parent">
                                                                                <span class="fas fa-cog text-info"></span>
                                                                            </button>
                                                                            <div class="dropdown-menu dropdown-menu-end py-2">
                                                                                <a class="dropdown-item text-success" 
                                                                                    style="cursor: pointer;"
                                                                                    ng-click="addDescriptions(item, item_d)">
                                                                                    <span class="fas fa-copy"></span>
                                                                                    Add
                                                                                </a>
                                                                                <div class="dropdown-divider" ng-if="item_d.no != 1"></div>
                                                                                <a class="dropdown-item text-danger" 
                                                                                    style="cursor: pointer;"
                                                                                    ng-if="item_d.no != 1" 
                                                                                    ng-click="removeDescriptions(item, $index)">
                                                                                    <span class="fas fa-times-circle"></span> 
                                                                                    Remove
                                                                                </a>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <input class="form-control rounded-1" 
                                                                ng-class="{'disabled-link':(!tab_general_active)}" 
                                                                type="text" 
                                                                placeholder="Work or Task" 
                                                                ng-model="item_d.descriptions"
                                                                ng-change="changeDescription(item_d)" 
                                                                @* ng-keyup="filterResultGeneral(item_d.descriptions, 'work_or_task')" *@
                                                                >
                                                        @* <ul class="list-group mt-2 w-25" 
                                                            style="position: absolute;" 
                                                            ng-show="(showResults && tab_general_active)">
                                                            <li class="list-group-item" 
                                                                ng-repeat="result in filteredResults | filter:{field:'work_or_task'}" 
                                                                ng-click="selectResult(result, task, 'work_or_taske')">
                                                                {{ result.name }}
                                                            </li>
                                                        </ul> *@
                                                    </div>
                                                    @* <ng-container ng-if="item.work_or_task">
                                                        <div ng-repeat="task in item.work_or_task">
                                                            <ng-container ng-include="'workTaskInputTemplate'"></ng-container>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container ng-if="!item.work_or_task">
                                                        <ng-container ng-include="'workTaskInputTemplate'"></ng-container>
                                                    </ng-container>

                                                    <script type="text/ng-template" id="workTaskInputTemplate">
                                                        
                                                    </script> *@
                                                </td>

                                                <td class="align-top status text-center px-1" ><!----span same id work group? same no. ----->
                                                    <div class="d-flex justify-content-center gap-2">
                                                        <button class="btn btn-outline-primary p-2" 
                                                            data-toggle="tooltip" 
                                                            data-placement="top" 
                                                            title="Copy Description of Work or Tasks"
                                                            ng-click=copyDescription(item)>
                                                            <span class="fas fa-copy fa-lg"></span>
                                                            Copy
                                                        </button>
                                                        <button class="btn btn-outline-success p-2" 
                                                            data-toggle="tooltip" 
                                                            data-placement="top" 
                                                            title="Copy Description of Work or Tasks"
                                                            ng-click="pasteDescription(item)"
                                                            ng-disabled="!dec_copy_status">
                                                            <span class="fa-solid fa-clipboard fa-lg"></span>
                                                            Paste 
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    @* List of Worker Groups and Description of Tasks end*@

                    @* RAM start*@
                    <div class="d-none" 
                        ng-class="{'tab-pane fade show active':(action_part==4),'tab-pane fade':(action_part!==4)}"
                        id="tab-worksheet" 
                        role="tabpanel" 
                        aria-labelledby="worksheet-tab">
                    </div>

                    @* HRA Worksheet start*@
                    <div class="" 
                        ng-class="{'tab-pane fade show active':(action_part==5),'tab-pane fade':(action_part!==5)}"
                        id="tab-worksheet" 
                        role="tabpanel" 
                        aria-labelledby="worksheet-tab">
                        <div style="background-color: #ffffff;">
                            @* header *@
                            <div class="mx-3 row  g-3 align-items-top">
                                <div class="d-flex gap-4">
                                    <p><b>NAME OF AREA: &nbsp;</b>{{selectedBusiness_Unit}}</p>
                                </div>
                                <div class="col-7 ">
                                    <div class="col-12 float-end align-top text-end ">
                                        <div class=" align-top text-end d-none">
                                            <button class="float-end btn btn-outline btn-sm p-1 m-1" ng-click="toggleFullscreen()">
                                                <i class="fas fa-expand" style="color: #a1a1a6"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @* new table *@
                            <div class="border-bottom" id="fullscreenzone" style="background-color: #ffffff;">
                                <div class="table-responsive scrollbar tableFixHead" style="min-height:400px;">
                                    <div class="table-responsive scrollbar" id="table-container" style="max-height: 60vh;">
                                        <table class="table fs--2 mb-0 table-bordered">
                                            <thead class=" text-uppercase  text-center bg-soft" style="font-size: 10px;">
                                                <tr>
                                                    <th class=" align-top" >[3.1]</th>
                                                    <th class=" align-top" >[3.2]</th>
                                                    <th class=" align-top" >[3.3]</th>
                                                    <th class=" align-top" colspan="2">[3.4]</th>
                                                    <th class=" align-top" >[3.5]</th>
                                                    <th class=" align-top" >[3.6]</th>
                                                    <th class=" align-top" >[3.7]</th>
                                                    <th class=" align-top" >[3.8]</th>
                                                    <th class=" align-top" >[3.9]</th>
                                                    <th class=" align-top cursor-pointer" ng-click="Matrix_Exposure_Rating()">[3.10]</th>
                                                    <th class=" align-top cursor-pointer" ng-click="Matrix_Frequency_Rating()">[3.11]</th>
                                                    <th class=" align-top" >[3.12]</th>
                                                    <th class=" align-top" >[3.13]</th>
                                                    <th class=" align-top" >[3.14]</th>
                                                    <th class=" align-top" >[3.15]</th>                                                    
                                                </tr>
                                                <tr>
                                                    <th class=" align-top" >Job Type/Change Type</th>
                                                    <th class=" align-top" >Task or Activity</th>
                                                    <th class=" align-top" >Sub Area</th>
                                                    <th class=" align-top" colspan="2">Exposure Indicator</th>
                                                    <th class=" align-top" >Health Effect Rating</th>
                                                    <th class=" align-top" >Frequency Level</th>
                                                    <th class=" align-top" >Exposure Band</th>
                                                    <th class=" align-top" >TLV std</th>
                                                    <th class=" align-top" >
                                                        Exposure<br/>Level = [3.7] <br/>vs [3.8]
                                                    </th>
                                                    <th class=" align-top cursor-pointer">
                                                        Exposure<br/>Rating = [3.6] <br/>vs [3.9]
                                                        <a ng-click="Matrix_Exposure_Rating()" class="fa-solid fa-subtitles" style="color: #1985a1"></a>
                                                    </th>
                                                    <th class=" align-top cursor-pointer">
                                                        Initial Risk<br/>Rating = [3.5]<br/>vs [3.10]
                                                        <a ng-click="Matrix_Frequency_Rating()" class="fa-solid fa-subtitles" style="color: #fa6607"></a>
                                                    </th>
                                                    <th class=" align-top" >Hierarchy of Control (ALARP)</th>
                                                    <th class=" align-top" >Effective?</th>
                                                    <th class=" align-top" >Residual Risk Rating</th>
                                                    <th class=" align-top" >Comments</th>
                                                </tr>
                                            </thead>
                                            <tbody class="list" id="customer-rating-table-body">
                                                <tr ng-repeat="item in data_worksheet_list">
                                                    
                                                    <td>
                                                        <div class="box text-center">
                                                            {{ item.worker_group ? item.worker_group : 'Not found' }}
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="box" ng-repeat="item_dec in item.descriptions">
                                                              {{ item_dec.descriptions ? item_dec.descriptions : 'Not found' }}
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="d-flex flex-column box" ng-repeat="ws in item.worksheet" style="min-width: max-content;">
                                                            {{ ws.sub_area
                                                                ? item.worksheet[$index - 1].sub_area == ws.sub_area 
                                                                    ? '' 
                                                                    : ws.sub_area 
                                                                : 'Not found'}}
                                                        </div>
                                                    </td>
                                                    @* <td>
                                                        <div class="d-flex flex-column" ng-repeat="item_sub in item.sub_areas">
                                                            <div class="box" 
                                                                >
                                                                {{ item_sub.sub_area }}
                                                            </div>
                                                            <div class="box empty" ng-repeat="n in [].constructor(item_sub.hazard.length - 1) track by $index">
                                                                &nbsp;
                                                            </div>
                                                        </div>
                                                    </td> *@

                                                    <td>
                                                        <div class="d-flex flex-col box" ng-repeat="hazard in item.worksheet" style="min-width: max-content;">
                                                            {{ hazard.type_hazard ? hazard.type_hazard : 'Not found'}}
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class="d-flex flex-col box" ng-repeat="hazard in item.worksheet">
                                                           {{ hazard.health_hazard ? hazard.health_hazard  : 'Not found'}}
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class="d-flex justify-content-center box" 
                                                            ng-repeat="hazard in item.worksheet">
                                                            <div ng-if="hazard.health_effect_rating">
                                                                <div class="effect-rating "
                                                                    @* ng-click="openModalRisk(hazard, $index)" *@
                                                                    ng-class="{
                                                                    'bg-success': (hazard.health_effect_rating == '1' || hazard.health_effect_rating == '2'),
                                                                    'bg-warning': (hazard.health_effect_rating == '3') 
                                                                    }" >
                                                                {{ hazard.health_effect_rating }}
                                                            </div>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class=" box" 
                                                            ng-repeat="hazard in item.worksheet">
                                                            <select class="form-select form-select-sm rounded-1" 
                                                                    ng-if="tab_worksheet_active"
                                                                    ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                    ng-change="actionChangeFrequencyLevel(hazard)"
                                                                    ng-model="hazard.id_frequency_level" 
                                                                    style="min-width: 100px;">
                                                                <option ng-repeat="item_m in master_frequency_level" ng-value="item_m.id">
                                                                    {{item_m.name}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                       <div class=" box"  ng-repeat="hazard in item.worksheet">
                                                            <div class="d-flex align-items-center gap-2" style="font-size: 14px;">
                                                                <input class="form-control form-control-sm placeholder-right" 
                                                                    style="min-width: 80px;"
                                                                    type="text" 
                                                                    placeholder=""
                                                                    ng-keyup="processExposure(hazard)"
                                                                    ng-model="hazard.exposure_band"
                                                                >
                                                                ppm
                                                            </div>
                                                       </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class="d-flex flex-col box" 
                                                            style="min-width: max-content; padding-top: 7px; font-size: 14px;"
                                                            ng-repeat="hazard in item.worksheet">
                                                           {{ hazard.standard_value }} {{  hazard.standard_value ? 'ppm' : '' }}
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                       <div class="box text-center" 
                                                            style="min-width: max-content; padding-top: 7px; font-size: 13px; text-align: center;"
                                                            ng-repeat="hazard in item.worksheet">
                                                            <p ng-if="hazard.id_exposure_level"
                                                                ng-repeat="item_m in master_exposure_level | filter:{ id: hazard.id_exposure_level }">
                                                                {{ item_m.name }}
                                                            </p>
                                                        </div>
                                                        @* <div class="box" ng-repeat="hazard in item.hazards">
                                                            <select class="form-select form-select-sm rounded-1" 
                                                                ng-if="tab_worksheet_active"
                                                                ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                ng-change="actionChangeFrequencyLevel(hazard)"
                                                                ng-model="hazard.id_exposure_level" 
                                                                style="min-width: 100px;"
                                                                ng-disabled="!hazard.exposure_status">
                                                                <option ng-repeat="item_m in master_exposure_level" ng-value="item_m.id">
                                                                    {{item_m.name}}
                                                                </option>
                                                            </select>
                                                        </div> *@
                                                    </td>

                                                    <td>
                                                        <div class="box text-center" 
                                                            style="min-width: max-content; padding-top: 7px; font-size: 13px; text-align: center;"
                                                            ng-repeat="ws in item.worksheet">
                                                            {{ ws.exposure_rating }}
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class="box" 
                                                            style="min-width: max-content; padding-top: 7px; font-size: 13px; text-align: center;"
                                                            ng-repeat="ws in item.worksheet">
                                                            {{ ws.initial_risk_rating }}
                                                        </div>
                                                        @*<div class="box" ng-repeat="hazard in item.hazards">
                                                            <select class="form-select form-select-sm rounded-1" 
                                                                ng-if="tab_worksheet_active"
                                                                ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                ng-change="actionChangeWorksheet(item,item.seq,'frequency_level')"
                                                                ng-change="actionChangeFrequencyLevel(hazard)"
                                                                ng-model="hazard.initial_risk_rating" 
                                                                style="min-width: 100px;"
                                                                ng-disabled="!hazard.exposure_status">
                                                                <option ng-repeat="item_m in data_initial_risk" ng-value="item_m.id">
                                                                    {{item_m.name}}
                                                                </option>
                                                            </select>
                                                        </div>*@
                                                    </td>

                                                    <td class="" >
                                                        <div class="box" ng-repeat="hazard in item.worksheet">
                                                             <textarea class="form-control form-control-sm" 
                                                                rows="2" 
                                                                type="text" 
                                                                style="width: 200px;"
                                                                placeholder="Hierarchy of Control (ALARP)" 
                                                                ng-disabled="hazard.initial_risk_rating === 'Low'"
                                                                ng-style="{'background-color': hazard.initial_risk_rating === 'Low' ? '#f2f2f2' : 'inherit'}"
                                                                ng-change="actionChangeControl(hazard)"
                                                                ng-model="hazard.hierarchy_of_control">
                                                            </textarea>
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class="box" ng-repeat="(idx,hazard) in item.worksheet">
                                                            <div class="d-flex gap-2 mb-2" style="min-width: max-content;">
                                                                <input type="radio" 
                                                                    name="ef-{{item.index_rows}}-{{idx}}" 
                                                                    id="effective-{{item.index_rows}}-{{idx}}" 
                                                                    style="width: 20px;"
                                                                    value="0"
                                                                    ng-change="actionChangEffective(hazard)"
                                                                    ng-model="hazard.effective">
                                                                <label for="effective">Effective</label>
                                                            </div>
                                                            <div class="d-flex gap-2" style="min-width: max-content;">
                                                                <input type="radio" 
                                                                    name="ef-{{item.index_rows}}-{{idx}}" 
                                                                    id="ineffective-{{item.index_rows}}-{{idx}}" 
                                                                    style="width: 20px;"
                                                                    value="1"
                                                                    ng-change="actionChangEffective(hazard)"
                                                                    ng-model="hazard.effective">
                                                                <label for="ineffective">Ineffective</label>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="" >
                                                        <div class="box" ng-repeat="hazard in item.worksheet">
                                                            <select class="form-select form-select-sm rounded-1" 
                                                                ng-if="tab_worksheet_active"
                                                                ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                @* ng-change="actionChangeWorksheet(item,item.seq,'frequency_level')" *@
                                                                ng-change="actionChangeFrequencyLevel(hazard)"
                                                                ng-model="hazard.residual_risk_rating" 
                                                                style="min-width: 100px;"
                                                                ng-disabled="!hazard.exposure_status">
                                                                <option ng-repeat="item_m in data_residual_risk" ng-value="item_m.id">
                                                                    {{item_m.name}}
                                                                </option>
                                                                <option>Low</option>
                                                                <option>Medieum</option>
                                                                <option>High</option>
                                                            </select>
                                                        </div>
                                                        
                                                    </td>

                                                    <td class="" >
                                                        <div class="box" ng-repeat="hazard in item.worksheet">
                                                             @* <p class="pe-1 text-1100 fw-bold">{{ (hazard.recommendations_no +'.') }}</p> *@
                                                            <textarea class="form-control form-control-sm " 
                                                                rows="2" 
                                                                type="text"
                                                                style="width: 200px;"
                                                                placeholder="Comments"
                                                                ng-change="actionChangeComment(hazard)"
                                                                ng-model="hazard.recommendations">
                                                            </textarea>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            @* old table *@
                            @* <div class="border-bottom" id="fullscreenzone" style="background-color: #ffffff;">
                                <div class="table-responsive scrollbar tableFixHead" style="min-height:400px">
                                    <div class="table-responsive scrollbar" id="table-container">
                                        <table class="table fs--2 mb-0 table-bordered">
                                            <thead class=" text-uppercase  text-center bg-soft" style="font-size: 10px;">
                                                <tr>
                                                    <th class=" align-middle" colspan="1" rowspan="2">No</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2">Job Type/Change Type</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2">Task or Activity</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2">Sub Area</th>
                                                    <th class=" align-middle" colspan="2" rowspan="2">Exposure Indicator</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2">Health Effect Rating</th>

                                                    <th class=" align-middle" colspan="1" rowspan="2">Frequency Level</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2">Exposure Band</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2">TLV std</th>
                                                    <th class=" align-middle" colspan="1" rowspan="2"
                                                        title="(Exposure Band  vs TLV std)">
                                                        <div class="d-flex">
                                                            Exposure Level
                                                        </div>
                                                    </th>

                                                    <th class=" align-middle text-center bg-light-secondary " colspan="1" rowspan="2"
                                                        title="(Frequency Level vs Exposure Level)">
                                                        <div class="d-flex">
                                                            Exposure Rating
                                                        </div>
                                                    </th>
                                                    <th class="align-middle text-center bg-light-secondary " colspan="1" rowspan="2"
                                                        title="(Health Effect Rating vs Exposure Rating)">
                                                        <div class="d-flex">
                                                            Initial Risk Rating
                                                        </div>
                                                    </th>

                                                    <th class=" align-middle  text-center " colspan="1" rowspan="2">Hierarchy of Control (ALARP)</th>
                                                    <th class=" align-middle  text-center " colspan="1" rowspan="2">Effective?</th>
                                                    <th class=" align-middle  text-center " colspan="1" rowspan="2">Residual Risk Rating</th>
                                                    <th class=" align-middle  text-center " colspan="1" rowspan="2">Comments</th>

                                                </tr>
                                            </thead>
                                            <tbody class="list" id="customer-rating-table-body">

                                                <tr ng-repeat="item in data_worksheet">
                                                    <td class="align-top product white-space-nowrap px-0" ng-if="item.row_type == 'tasks'"
                                                        rowspan="{{item.row_span_tasks}}">
                                                        <div class="align-items-center ">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static  ">
                                                                <p class=" m-0  text-center text-1100 fw-bold">{{ item.tasks_no  }}</p>
                                                            </div>
                                                        </div>
                                                    </td>
              
                                                    <td class="align-top product white-space-nowrap px-0" ng-if="item.row_type == 'tasks'"
                                                        rowspan="{{item.row_span_tasks}}">

                                                        <div class="align-items-center ">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static  ">
                                                                <p class=" m-0  text-center text-1100 fw-bold"
                                                                   ng-repeat="item_ret in data_tasks | filter:{id:item.id_tasks}">{{  item_ret.worker_group  }}</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                               
                                                    <td class="align-top product white-space-nowrap px-0" ng-if="item.row_type == 'tasks'"
                                                        rowspan="{{item.row_span_tasks}}">
                                                        <div class="align-items-center ">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static mx-1 ">

                                                                <select class="form-select form-select-sm rounded-1" ng-if="tab_worksheet_active"
                                                                        ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                        ng-change="actionChangeWorksheet(item,item.seq,'activity')"
                                                                        ng-model="item.id_activity" style="width: 200px;">
                                                                    <option ng-repeat="item_m in master_activities" ng-value="item_m.id">
                                                                        {{item_m.name}}
                                                                    </option>
                                                                </select>
                                                                <p class=" m-0  text-center text-1100 fw-bold" ng-if="!tab_worksheet_active"
                                                                   ng-repeat="item_ret in master_activities | filter:{id:item.id_activity}">{{  item_ret.name  }}</p>

                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-0" ng-if="item.row_type == 'tasks'"
                                                        rowspan="{{item.row_span_tasks}}">
                                                        <div class="align-items-center ">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static  ">
                                                                <p class="px-1 m-0  text-center text-1100 fw-bold">{{ selectedBusiness_Unit  }}</p>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-0" ng-if="item.row_type == 'tasks' || item.row_type == 'hazard'"
                                                        rowspan="{{item.row_span_hazard}}">
                                                        <div class="align-items-center ">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static  ">
                                                                <p class="px-1 m-0  text-center text-1100 fw-bold"
                                                                   ng-repeat="item_ret in data_hazard | filter:{id:item.id_hazard}">{{  item_ret.type_hazard  }}</p>

                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-1" style="width: 200px;">
                                                        <div>
                                                            <p class="text-1100 fw-bold ps-2" style="width: 150px;">{{ item.responder_user_displayname  }}</p>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap  px-1" ng-if="item.row_type == 'tasks' || item.row_type == 'hazard'"
                                                        rowspan="{{item.row_span_hazard}}">
                                                        <div class="d-flex align-items-center ">
                                                            <div class="d-flex mx-1 font-sans-serif btn-reveal-trigger position-static  ">
                                                                <p class=" m-0  text-center text-1100 fw-bold" ng-repeat="item_ret in data_hazard | filter:{id:item.id_hazard}">{{  item_ret.health_effect_rating  }}</p>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-1">
                                                        <div class="d-flex align-items-center  ">

                                                            <select class="form-select form-select-sm rounded-1" ng-if="tab_worksheet_active"
                                                                    ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                    ng-change="actionChangeWorksheet(item,item.seq,'frequency_level')"
                                                                    ng-model="item.id_frequency_level" style="width: 200px;">
                                                                <option ng-repeat="item_m in master_frequency_level" ng-value="item_m.id">
                                                                    {{item_m.name}}
                                                                </option>
                                                            </select>
                                                            <p class=" m-0  text-center text-1100 fw-bold" ng-if="!tab_worksheet_active"
                                                               ng-repeat="item_ret in master_frequency_level | filter:{id:item.id_frequency_level}">{{  item_ret.name  }}</p>


                                                            <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto d-none"
                                                                    style="color: gold; background-color: #ffffff; border-color: #ffffff; width: 20px;"
                                                                    ng-click="cloneFrequencyLevel(item)"
                                                                    title="Copy ผลการประเมิณ ไปยัง ของพนักงาน อื่นๆ">
                                                                <span class="far fa-clone fa-lg pe-1"></span>
                                                            </button>

                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-1">
                                                        <div class="d-flex align-items-center  ">
                                                            <div class="row mx-1" style="width: 130px;">
                                                                <input class="form-control form-control-sm" type="text" ng-model="item.exposure_band">
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-1">
                                                        <div class="d-flex align-items-center justify-content-center" style="width: 100px;">
                                                            <div class="text-1100 fw-bold">{{item.tlv_standard}}</div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-1">
                                                        <div class="d-flex align-items-center justify-content-center">
                                                            <select class="form-select form-select-sm rounded-1" ng-if="tab_worksheet_active"
                                                                    ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                    ng-change="actionChangeWorksheet(item,item.seq,'exposure_level')"
                                                                    ng-model="item.id_exposure_level" style="width: 200px;">
                                                                <option ng-repeat="item_m in master_exposure_level" ng-value="item_m.id">
                                                                    {{item_m.name}}
                                                                </option>
                                                            </select>
                                                            <p class=" m-0  text-center text-1100 fw-bold" ng-if="!tab_worksheet_active"
                                                               ng-repeat="item_ret in master_exposure_level | filter:{id:item.id_exposure_level}">{{  item_ret.name  }}</p>

                                                        </div>
                                                    </td>
                 
                                                    <td class="align-top product white-space-nowrap px-0">
                                                        <div class="align-items-center justify-content-center">
                                                            <div><p class="mb-0 text-center ms-3 text-1100 fw-bold">{{item.exposure_rating}}</p></div>
                                                        </div>
                                                    </td>
                                               
                                                    <td class="align-top product white-space-nowrap px-0">
                                                        <div class="align-items-center">
                                                            <div ng-style="{'color': item.initial_risk_rating === 'Low' ? '#ccc' : 'inherit'}">
                                                                <p class="mb-0 ms-3 text-center text-1100 fw-bold">{{ item.initial_risk_rating }}</p>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-0">
                                                        <div class="d-flex align-items-center">
                                                            <div class="mx-1">
                                                                <textarea class="form-control form-control-sm" rows="3" type="text" style="width: 200px;"
                                                                          placeholder="Hierarchy of Control (ALARP)" ng-disabled="item.initial_risk_rating === 'Low'"
                                                                          ng-style="{'background-color': item.initial_risk_rating === 'Low' ? '#f2f2f2' : 'inherit'}"
                                                                          ng-model="item.hierarchy_of_control"></textarea>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="align-top product white-space-nowrap px-0">
                                                        <div class="d-flex align-items-center">
                                                            <div class="mx-1">
                                                                <textarea class="form-control form-control-sm" rows="3" type="text" style="width: 200px;"
                                                                          placeholder="Effective?" ng-disabled="item.initial_risk_rating === 'Low'"
                                                                          ng-style="{'background-color': item.initial_risk_rating === 'Low' ? '#f2f2f2' : 'inherit'}"
                                                                          ng-model="item.effective"></textarea>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="align-top product white-space-nowrap px-0">
                                                        <div class="d-flex align-items-center">
                                                            <div class="mx-1">
                                                                <textarea class="form-control form-control-sm" rows="3" type="text" style="width: 200px;"
                                                                          placeholder="Residual Risk Rating" ng-disabled="item.initial_risk_rating === 'Low'"
                                                                          ng-style="{'background-color': item.initial_risk_rating === 'Low' ? '#f2f2f2' : 'inherit'}"
                                                                          ng-model="item.residual_risk_rating"></textarea>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td class="align-top product white-space-nowrap px-1">
                                                        <div class="d-flex align-items-center ">
                                                            <div class="d-flex mx-1">
                                                                <p class="pe-1 text-1100 fw-bold">{{ (item.recommendations_no +'.') }}</p>
                                                                <textarea class="form-control form-control-sm " rows="3" type="text"
                                                                          style="width: 200px;"
                                                                          placeholder="Comments"
                                                                          ng-model="item.recommendations"></textarea>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>

                                            </tbody>

                                        </table>
                                    </div>
                                </div>
                            </div> *@
                        </div>
                    </div>

                    @* <!-- manage recment start--> *@
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==6),'tab-pane fade':(action_part!==6)}"
                         id="tab-manage" role="tabpanel" aria-labelledby="manage-tab">

                        <div class=" border-bottom border-200 my-0" id="NodeTable">
                            <div class="table-responsive scrollbar">
                                <table class="table fs--2 mb-0">
                                    <thead class=" text-uppercase text-center">
                                        <tr>
                                            <th class=" align-middle" colspan="1" rowspan="2">JOB TYPE/CHANGE TYPE</th>
                                            <th class=" align-middle" colspan="1" rowspan="2">TASK OR ACTIVITY</th>
                                            <th class=" align-middle" colspan="1" rowspan="2">SUB AREA</th>
                                            <th class=" align-middle" colspan="1" rowspan="2">Exposure Indicator</th>
                                            <th class=" align-middle" colspan="1" rowspan="2">HEALTH EFFECT RATING</th>
                                            <th class=" align-middle text-center" colspan="2" rowspan="1">
                                                <b class="text-danger"> * </b>RISK RATING
                                            </th>
                                            <th class=" align-middle" colspan="1" rowspan="2" ng-if="data_header[0].pha_status >12">Document File</th>
                                            <th class=" align-middle text-center" colspan="1" rowspan="2">Recommendation</th>
                                            <th class=" align-middle text-center" colspan="1" rowspan="2">Action Owner</th>
                                            <th class=" align-middle text-center" colspan="1" rowspan="2">Action<br />Status<br />(Items)</th>
                                            <th class=" align-middle text-center" colspan="2" rowspan="1">
                                                <b class="text-danger"> * </b>Recommendations Close Plan
                                            </th>
                                            <th class=" align-middle" colspan="1" rowspan="2">Action Close Date</th>
                                        </tr>
                                        <tr>
                                            <th class=" align-middle" scope="col" >INITIAL RISK RATING</th>
                                            <th class=" align-middle" scope="col" >RESIDUAL RISK RATING</th>
                                            <th class=" align-middle" scope="col" >Start Date</th>
                                            <th class=" align-middle" scope="col" >End Date</th>
                                        </tr>

                                    </thead>

                                    <tbody class="list" id="customer-rating-table-body">
                                        <tr ng-repeat="item in data_worksheet_list | orderBy:['index_rows']" 
                                            class="hover-actions-trigger btn-reveal-trigger position-static text-center">

                                            <td class="align-top rating white-space-nowrap text-start">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.worker_group}} 
                                                    </label>
                                                </div>
                                            </td>
                                            
                                            <td class="align-top rating white-space-nowrap">
                                                <div class="box"  
                                                    style="border: none; margin-bottom: 0px;"
                                                    ng-repeat="item_dec in item.descriptions">
                                                        {{ item_dec.descriptions ? item_dec.descriptions : 'Not found' }}
                                                </div>
                                            </td>
                                            
                                            <td>
                                                <div class="d-flex flex-column" ng-repeat="item_sub in item.sub_areas">
                                                    <div class="box" 
                                                        @* ng-style="{'margin-bottom': (item_sub.hazard.length * 56) + 'px'}" *@
                                                        >
                                                        {{ item_sub.sub_area }}
                                                    </div>
                                                    <div class="box empty" ng-repeat="n in [].constructor(item_sub.hazard.length - 1) track by $index">
                                                        &nbsp;
                                                    </div>
                                                </div>
                                            </td>

                                            <td>
                                                <div class="d-flex flex-col"  ng-repeat="hazard in item.hazards">
                                                    <div class="box" >
                                                        {{ hazard.type_hazard }}
                                                    </div>
                                                </div>
                                            </td>

                                            <td>
                                                <div class="d-flex justify-content-center box" 
                                                    ng-repeat="hazard in item.hazards">
                                                    <div ng-if="hazard.health_effect_rating">
                                                        <div class="effect-rating "
                                                            @* ng-click="openModalRisk(hazard, $index)" *@
                                                            ng-class="{
                                                                    'bg-success': (hazard.health_effect_rating == '1' || hazard.health_effect_rating == '2'),
                                                                    'bg-warning': (hazard.health_effect_rating == '3') 
                                                            }" >
                                                            {{ hazard.health_effect_rating }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>

                                            <td class="align-top rating white-space-nowrap text-start">
                                                @* <div class="d-flex justify-content-center box" >
                                                    <div ng-if="hazard.health_effect_rating">
                                                        <div class="effect-rating "
                                                            ng-class="{
                                                                    'bg-success': (item.initial_risk_rating == 'Low' ),
                                                                    'bg-warning': (item.initial_risk_rating == 'Medium')
                                                                    'bg-danger': (item.initial_risk_rating == 'High') 
                                                            }" >
                                                            {{item.initial_risk_rating }}
                                                        </div>
                                                    </div>
                                                </div>     *@

                                                <div class="box" 
                                                    style="min-width: max-content; padding-top: 7px; font-size: 13px; text-align: center;"
                                                    ng-repeat="ws in item.worksheet">
                                                    {{ ws.initial_risk_rating }}
                                                </div>                                            
                                            </td>
  
                                            <!-- if status close show this --->
                                            <td class="align-top rating white-space-nowrap text-start">
                                                @* <div class="d-flex justify-content-center box" >
                                                    <div ng-if="hazard.health_effect_rating">
                                                        <div class="effect-rating "
                                                            ng-class="{
                                                                    'bg-success': (item.residual_risk_rating == 'Low' ),
                                                                    'bg-warning': (item.residual_risk_rating == 'Medium')
                                                                    'bg-danger': (item.residual_risk_rating == 'High') 
                                                            }" >
                                                            {{item.initial_risk_rating }}
                                                        </div>
                                                    </div>
                                                </div>    *@
                                                 <div class="box" 
                                                    style="min-width: max-content; padding-top: 7px; font-size: 13px; text-align: center;"
                                                    ng-repeat="ws in item.worksheet">
                                                    {{ ws.residual_risk_rating }}
                                                </div>                                                 
                                            </td>


                                            <td class="" >
                                                <div class="box" ng-repeat="hazard in item.hazards">
                                                             @* <p class="pe-1 text-1100 fw-bold">{{ (hazard.recommendations_no +'.') }}</p> *@
                                                    <textarea class="form-control form-control-sm " 
                                                            rows="2" 
                                                            type="text"
                                                            style="width: 200px;"
                                                            placeholder="Comments"
                                                            ng-model="hazard.recommendations">
                                                    </textarea>
                                                </div>
                                            </td>                                            

                                            @*action owb=ner*@
                                            <td class="align-top rating white-space-nowrap">
                                                <div class="box">
                                                    <div class="d-flex justify-content-start w-100" ng-show="item.id_worker_group">
                                                        <button class="btn btn-outline-secondary p-1 cursor-pointer col-auto" 
                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                            ng-click="openDataEmployeeAdd(item,'manage')">
                                                            <span class="far fa-address-book fa-lg pe-1"></span>
                                                            Add action owner
                                                        </button>
                                                    </div>  
                                                    <div class="d-flex justify-content-start w-100 ps-2">
                                                        <p class="text-1100 text-start fw-bold">{{item.user_displayname}}</p>
                                                    </div>
                                                </div>
                                            </td>

                                            <td class="align-top rating white-space-nowrap" ng-if="data_header[0].pha_status >12">
                                                <div class="ms-3 text-start d-none">
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileOwner(item)"
                                                       ng-if="!(item.document_file_path =='' || item.document_file_path == null)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Responder has attached the file.
                                                    </a>
                                                    <br ng-if="!(item.document_file_admin_path =='')" />
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileReviewer(item)"
                                                       ng-if="!(item.document_file_admin_path =='' || item.document_file_path == null)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Reviewer has attached the file.
                                                    </a>
                                                </div>
                                                <div class="ms-3 text-start"
                                                     ng-repeat="item_x in data_drawingworksheet_responder | filter:{id_worksheet:item.seq}"
                                                     ng-click="downloadFileOwner(item)"
                                                     ng-if="$index == 0">
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileOwner(item)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Responder has attached the file.
                                                    </a>
                                                </div>
                                                <div class="ms-3 text-start"
                                                     ng-repeat="item_x in data_drawingworksheet_reviewer | filter:{id_worksheet:item.seq}"
                                                     ng-click="downloadFileReviewer(item)"
                                                     ng-if="$index == 0">
                                                    <a class="nametext ms-3 filename-text me-2 cursor-pointer" ng-click="downloadFileReviewer(item)">
                                                        <i class="far fa-file-pdf text-danger"></i>The Reviewer has attached the file.
                                                    </a>
                                                </div>

                                            </td>

                                            <td class="align-top rating white-space-nowrap">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.recommendations}} 
                                                    </label>
                                                </div>
                                            </td>

                                            <td class="align-top rating white-space-nowrap">
                                                <div class="ms-3">
                                                    <label>
                                                        {{item.action_status}}
                                                    </label>
                                                </div>
                                            </td>

                                            <td class="align-top rating white-space-nowrap">
                                                <input type="date" class="form-control datetimepicker rounded-1" ng-class="{'disabled-link':(!tab_managerecom_active)}"
                                                       placeholder="Start Date dd/mm/yyyy"
                                                       ng-model="item.estimated_start_date"
                                                       ng-change="actionChangeWorksheet(item,item.seq,'')">


                                                <div id="valid-nodeworksheet-estimated-start-{{item.seq}}"
                                                     class="invalid-feedback text-danger">
                                                    Please provide a valid Estimated Start Date.
                                                </div>
                                            </td>

                                            <td class="align-top rating white-space-nowrap">
                                                <input type="date" class="form-control  datetimepicker rounded-1" ng-class="{'disabled-link':(!tab_managerecom_active)}"
                                                       placeholder="End Date dd/mm/yyyy"
                                                       ng-model="item.estimated_end_date"
                                                       ng-change="actionChangeWorksheet(item,item.seq,'')">
                                                <div id="valid-nodeworksheet-estimated-end-{{item.seq}}"
                                                     class="invalid-feedback text-danger">
                                                    Please provide a valid Estimated End Date.
                                                </div>
                                            </td>

                                            <td class="align-top  px-0" style=" width: 80px;">
                                                <div class="align-items-center ">
                                                    <p><b>{{item.reviewer_date}}</b></p>
                                                </div>
                                            </td>

                                        </tr>
                                    </tbody>

                                </table>
                            </div>
                        </div>

                    </div>

                    @* Name List *@
                    <div class=""
                        id="tab-name"
                        role="tabpanel" 
                        aria-labelledby="name-tab"
                        ng-class="{'tab-pane fade show active':(action_part==7),'tab-pane fade':(action_part!==4)}">
                        <div style="background-color: #ffffff;">
                            <div class="mx-3 row  g-3 align-items-top ">
                                <div class="d-flex gap-4">
                                    <p><b>DEPARTMENT: &nbsp;</b>{{data_general[0].id_departments}}</p>
                                    <p><b>SECTIONS: &nbsp;</b>{{data_general[0].id_sections}}</p>
                                </div>
                                <div class="table-responsive scrollbar" id="table-container">
                                    <table class="table fs--2 mb-0 table-bordered">
                                        <thead class=" text-uppercase  text-center bg-soft">
                                            <tr>
                                                <th class="sort align-middle" colspan="2" rowspan="1" style="width: 55%;">
                                                    NAME OF WORKER GROUP
                                                </th>

                                                <th class="sort align-middle text-center" colspan="1" rowspan="2" style="width: 30%;">
                                                    EMPLOYEES /STAFF MEMBERS
                                                </th>

                                                <th class="sort align-middle text-center" colspan="1" rowspan="2" style="width: 15%;">
                                                    NUMBERS OF WORKERS
                                                </th>
                                            </tr>
                                            <tr>
                                                <th class=" align-middle text-start" style="width: 27%;">AREA</th>
                                                <th class=" align-middle text-start" style="width: 27%;">WORKER GROUP</th>
                                                @* <th class=" align-middle text-start" style="width: 18%;"></th>
                                                <th class=" align-middle text-start" style="width: 28%;">EMPLOYEES /STAFF MEMBERS</th> *@
                                            </tr>
                                        </thead>
                                        <tbody class="list" id="customer-rating-table-body">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static" 
                                                ng-repeat="(index, item) in data_tasks" 
                                                ng-if="item.tasks_type_other == 0">

                                                <td class="align-top rating white-space-nowrap px-1" 
                                                    style="width: 150px;" 
                                                    rowspan="{{data_tasks.length}}" 
                                                    ng-if="$index == 0"> 
                                                    <p class="text-1100 fw-bold p-3" ng-if="$index == 0">
                                                        {{selectedBusiness_Unit}}
                                                    </p>
                                                </td>

                                                <td class="align-top rating white-space-nowrap px-1" style="width: 250px;" > 
                                                    <div class="d-flex align-items-center mx-1 p-1">
                                                        <div style="padding-right: 8px;">
                                                            <div class="align-top text-center">
                                                                <div class="font-sans-serif btn-reveal-trigger position-static ">
                                                                    <span class="px-1">{{ item.no }}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <select class="form-control"
                                                                ng-class="{'disabled-link':(!tab_general_active || !(tab_general_active && data_header[0].pha_status<=12 ))}"
                                                                ng-change="actionChangeWorkGroup(item)"
                                                                disabled
                                                                ng-model="item.id_worker_group"
                                                                ng-if="item.tasks_type_other == 0">
                                                            <option ng-repeat="item_m in master_worker_group" ng-value="item_m.id">
                                                                {{item_m.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </td>

                                                @* <td>
                                                    <div class="d-flex justify-content-center ps-2 py-1">
                                                        <button class="btn btn-outline-secondary p-2 cursor-pointer col-auto" 
                                                                ng-disabled="item.worker_list.length == 0 && item.worker_group != 'Other'"
                                                                style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                                ng-click="openDataEmployeeAdd(item,'worker')">
                                                            <span class="far fa-address-book fa-lg pe-1"></span>
                                                            Add Workers
                                                        </button>

                                                    </div>  
                                                </td> *@

                                                <td class="align-top rating px-1 d-flex flex-column align-items-center justify-content-start" >
                                                    <div class="d-flex justify-content-start flex-column px-4 w-100">
                                                        <div class="py-1 mb-3">
                                                            <button class="btn btn-outline-secondary p-1 cursor-pointer col-auto" 
                                                                style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                ng-click="openDataEmployeeAdd(item,'worker')">
                                                                <span class="far fa-address-book fa-lg pe-1"></span>
                                                                Add action owner
                                                            </button>
                                                        </div>
                                                        <div class="d-flex justify-content-start w-100 ps-2 py-1"
                                                            ng-repeat="workers in item.worker_list">
                                                            <p class="text-1100 fw-bold">{{workers.user_displayname}}</p>
                                                        </div>
                                                    </div>
                                                </td>

                                                <td class="align-top status text-center px-1" >
                                                    <p class="p-3">
                                                        <b>{{ item.numbers_of_workers }}</b>
                                                    </p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    @* <!-- Assessment Team Leader (QMTS) Appeover start--> *@
                    @* <div class="" ng-class="{'tab-pane fade show active':(action_part==7),'tab-pane fade':(action_part!==7)}"
                         id="tab-approver" role="tabpanel" aria-labelledby="approver-tab">
                        <div class="m-3 row  gx-0 align-items-center">
                            <div class=" border-bottom border-200 my-0" id="ApproverTable">
                                <div class="table-responsive scrollbar">
                                    <table class="table fs--2 mb-0">
                                        <thead class=" text-uppercase text-center">
                                            <tr>
                                                <th class=" align-middle">No</th>
                                                <th class=" align-middle">Approver</th>
                                                <th class=" align-middle">Status</th>
                                                <th class=" align-middle text-start"><b class="text-danger" ng-if="item.action_status == 'reject'"> * </b>Comment</th>
                                                <th class=" align-middle text-start">Document File</th>
                                                <th class=" align-middle">Action Date</th>
                                                <th class=" align-middle"></th>
                                            </tr>
                                        </thead>
                                        <tbody class="list" id="customer-rating-table-body">
                                            <tr ng-repeat="item in data_approver | orderBy:['no']"
                                                ng-if="(item.user_name == user_name ) || (flow_role_type == 'admin')"
                                                class="hover-actions-trigger btn-reveal-trigger position-static text-center">
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.no}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.user_displayname}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap  text-start">
                                                    <div class="col-md-12 p-1 ps-3 text-start" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)   ">
                                                        <div class="form-check form-check-inline cursor-pointer p-0">
                                                            <span class="fa-solid far fa-file-pdf text-danger" style="font-size:15px;" ng-click="confirmExport('hra_report','pdf')"></span>
                                                            <b>
                                                                HRA Report
                                                            </b>
                                                        </div><br />
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" id="inlineRadio-{{item.seq}}" type="radio"
                                                                   name="inlineRadioOptions-{{item.seq}}"
                                                                   value="approve" checked ng-model="item.action_status" />
                                                            <label class="form-check-label" for="inlineRadioApprove-{{item.seq}}"> Approve</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" id="inlineRadioOptions-{{item.seq}}" type="radio"
                                                                   name="inlineRadioOptions-{{item.seq}}"
                                                                   value="reject" ng-model="item.action_status" />
                                                            <label class="form-check-label" for="inlineRadioReject-{{item.seq}}"> Send back with Comment</label>
                                                        </div>
                                                        <div id="valid-approver-status-{{item.seq}}" class="invalid-feedback text-danger">
                                                            Please select a valid status.
                                                        </div>
                                                    </div>

                                                    <div class="col-md-12 p-1 text-center" ng-if="(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.action_status =='approve' ? 'Approve' : 'Send back with Comment' }}
                                                        </label>
                                                    </div>

                                                </td>
                                                <td class="align-top white-space-nowrap text-start">

                                                    <div class="col-md-12 p-1 ps-3" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                        <textarea class="form-control rounded-1" id="floatingTextarea2" placeholder="Enter your comment"
                                                                  ng-model="item.comment">  </textarea>

                                                        <div id="valid-approver-comment-{{item.seq}}" class="invalid-feedback text-danger">
                                                            Please select a valid comment.
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 p-1 ps-3 text-start" ng-if="(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.comment}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top px-1 text-start" style="min-width:200px;">
                                                    <div class=" p-0 cursor-pointer "
                                                         ng-repeat="item_x in data_drawing_approver  | filter:{id_approver : item.seq}  ">
                                                        <div class="d-flex flex-nowrap" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static me-1">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        type="button" data-bs-toggle="dropdown" data-boundary="window"
                                                                        aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click=addDataApproverDrawing(item_x,item.seq,item.id_session)>
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider"></div><a class="dropdown-item text-danger"
                                                                                                           ng-click=removeDataApproverDrawing(item_x,item_d.seq)>
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div class="btn-group my-2" ng-class="{ 'no-drop': !canAccess(item), 'cursor-pointer': canAccess(item) }">
                                                                <div class="icon-button border p-3" style="border-color: #0d6efd; background-color: #0d6efd;">
                                                                    <span class="fa-solid fa-arrow-up-from-bracket fa-lg" style="color: #ffffff;"></span>
                                                                </div>
                                                                <button class="Upload-button btn ps-3 cursor-pointer" 
                                                                        ng-class="{ 'no-drop': !canAccess(item), 'cursor-pointer': canAccess(item) }" 
                                                                        ng-if="!item_x.document_file_size">
                                                                    <span class="nametext ms-3 filename-text me-2 d-none" id="filename-approver-{{item_x.seq}}">
                                                                        {{(item_x.document_file_size>0? item_x.document_file_name + '('+  item_x.document_file_size + 'KB)' : '')}}
                                                                    </span>
                                                                    <label class="dz-message-text fw-bold p-1 cursor-pointer" for="attfile-{{item_x.seq}}">
                                                                        Upload File (Max size 10mb)
                                                                    </label>
                                                                    <input type="file" id="attfile-{{item_x.seq}}"
                                                                           class="cursor-pointer"
                                                                           name="file{{item_x.seq}}"
                                                                           ng-class="{ 'cant-Access': !canAccess(item) }"
                                                                           onchange="angular.element(this).scope().fileSelectApprover(this,'approver')"
                                                                           style="display:none" />
                                                                </button>
                                                                <button class="Upload-button btn cursor-pointer" style="width:250px;" ng-if="item_x.document_file_size > 0">
                                                                    <div class="d-flex align-items-center">
                                                                        <span class="nametext filename-text me-2 cursor-pointer">
                                                                            {{truncateFilename(item_x.document_file_name, 20)}} ({{item_x.document_file_size}} KB)
                                                                        </span>
                                                                    </div>
                                                                </button>
                                                            </div>       
                                                        </div>
                                                        <div class="text-start p-0 cursor-pointer d-flex flex-nowrap" ng-if="item_x.document_file_size>0 ">
                                                            <a class="nametext ms-3 filename-text me-2" ng-click="downloadFile(item_x)">
                                                                <i class="far fa-file-pdf text-danger"></i> {{(item_x.document_file_size>0? item_x.document_file_name + '('+  item_x.document_file_size + 'KB)' : '')}}
                                                            </a>
                                                        </div>

                                                    </div>
                                                    <div ng-class="{'invalid-feedback text-danger': !(form_valid.valid_document_file==true && item.seq == id_approver_select), 'feedback text-danger': form_valid.valid_document_file}">
                                                        Please provide a valid document file.
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.date_review_show}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top px-0 pt-0 ">
                                                    <div class="d-flex">

                                                        <button class="btn btn-outline text-primary  p-1 m-2 me-0" style=" background-color: #f1f2f4; width:50px;"
                                                                ng-click="confirmDialogApprover(item,'save')"
                                                                ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                            <span class="fa fa-save text-primary fa-lg"></span><br /><span style="font-size:8px">Save</span>
                                                        </button>

                                                        <button class="btn btn-outline text-success  p-1 m-2 ms-1"
                                                                style="background-color: #f1f2f4; width:80px; "
                                                                ng-click="confirmDialogApprover(item,'submit')"
                                                                ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                            <span class="fa fa-save text-success fa-lg"></span><br /><span style="font-size:8px">Submit</span>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div> *@

                    @* Report start *@
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==8),'tab-pane fade':(action_part!==8)}"
                         id="tab-report" role="tabpanel" aria-labelledby="report-tab" ng-if="export_type==true">

                        <div class="m-3 row  gx-0 align-items-center">
                            <div class="bg-white position-relative top-1">
                                <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                                    <table class="table table-sm fs--1 mb-0">
                                        <thead class=" text-uppercase">
                                            <tr>
                                                <th class="white-space-nowrap fs--1 align-middle ps-0" style="width:5%;"></th>
                                                <th class=" align-middle pe-5" style="width:70%">
                                                    Report
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class=" list text-uppercase" id="customers-table-body">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2 d-none" ng-click="confirmExport('hra_report','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('hra_report','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('hra_report','none-word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    HRA Report
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('hra_worksheet','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('hra_worksheet','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('hra_worksheet','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    HRA Worksheet and Associate Worksheet
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('hra_recommendation','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('hra_recommendation','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('hra_recommendation','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    HRA RECOMMENDATION RESPONSE SHEET
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">

                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('hra_template_moc','excel')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    HEALTH Check List for Management of Change (MOC)
                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="bg-white position-relative top-1 d-none" ng-repeat="item_doc in exportfile "
                                 ng-if="(item_doc.DownloadPath !='' || item_doc.DownloadPath != null)">
                                <h5 class="modal-title" id="modalExportFileLabel">Download File</h5>
                                <a href="{{item_doc.DownloadPath}}" id="exportfile" name="exportfile" target="_blank">
                                    {{item_doc.DownloadPath}}-{{item_doc.Name}}
                                </a>
                            </div>


                        </div>

                    </div>

                </div>

            </div>
        </div>
    </div>


    @* ************************************************************** *@

    <div class="modal fade modal-xl" id="modalMatrix_Frequency_Rating" tabindex="-1" aria-labelledby="modalMatrix_Frequency_RatingLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered" style="height:300px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMatrix_Frequency_RatingLabel">
                        <span class=" me-2 text-primary"><B>|</B></span> Frequency Rating
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>
                <div class="modal-body">

                    <img src="~/assets/img/risk_rating.png" style="height:300px;" />

                </div>

            </div>
        </div>
    </div>

    <div class="modal fade modal-xl" id="modalMatrix_Exposure_Rating" tabindex="-1" aria-labelledby="modalMatrix_Exposure_RatingLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered"  >
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMatrix_Exposure_RatingLabel">
                        <span class=" me-2 text-primary"><B>|</B></span> Exposure Rating
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>
                <div class="modal-body">

                    <img src="~/assets/img/exposure_rating.png" style="width: 400px; " />

                </div>

            </div>
        </div>
    </div>
    @* ************************************************************** *@


    <!--Modal Risk-->
    <div class="modal fade modal-xl" id="modalRisk" tabindex="-1" aria-labelledby="modalEmployeeAddLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalEmployeeCheckLabel">
                        <span class=" me-2 text-primary"><B>|</B></span> 
                        HEALTH HAZARDS OR RISK FACTOR
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>

                </div>

                <div class="modal-body">

                    <div class="mb-4">

                        <div class="row g-3">

                            <div class="col-auto">

                                <div class="search-box position-relative">

                                    <input class="form-control search-input search"
                                           ng-model="keywords.text" placeholder="Search"
                                           ng-change="fillterRisk()" />
                                    <span class="fas fa-search search-box-icon"></span>
                                </div>

                            </div>

                        </div>

                    </div>

                    <div class="bg-white border-top border-bottom border-200 position-relative top-1">
                        <div class="table-responsive scrollbar-overlay mx-n1 px-1" style="max-height: 320px; min-height:320px;">
                            <table class="table table-sm fs--1 mb-0">
                                <thead class=" text-uppercase bg-white">
                                    <tr class="text-center">
                                        <th class="text-center" style="width: 10%;">Select</th>
                                        <th class="text-start" style="width: 70%;">RISK FACTOR ({{master_hazard_riskfactors_list.length}})</th>
                                        <th class="text-center" style="width: 10%;">Rating</th>
                                        <th class="text-center" style="width: 10%;">TLV STD</th>
                                        @* <th class="text-center" style="width: 10%;">Type</th> *@
                                    </tr>
                                </thead>
                                <tbody class=" list">
                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static text-center"
                                        ng-repeat="item in master_hazard_riskfactors_list">

                                        <td class="text-center" style="width: 10%;">
                                            <input type="radio" 
                                                id="risk"
                                                name="risk"  
                                                ng-model="select_hazard.id_health_hazard"
                                                ng-value="item.id"
                                                style="cursor: pointer; width: 22px; height: 22px;"
                                                ng-change="changeRisk(select_hazard, $index)"
                                                @* ng-click="changeRisk(select_hazard, $index)" *@
                                            >
                                       </td>

                                        <td class="text-start" style="width: 70%;">{{item.name}}</td>

                                        <td class="text-center" style="width: 10%;">
                                            <div class="d-flex align-items-center justify-content-center" style="width: 100%;">
                                                <div ng-if="item.hazards_rating">
                                                    <div class="effect-rating"
                                                        ng-class="{
                                                            'bg-success': (item.hazards_rating == '1' || item.hazards_rating == '2'),
                                                            'bg-warning': (item.hazards_rating == '3') 
                                                        }" 
                                                        ng-click="chooseRating(select_hazard.health_hazard, $index)"
                                                        >
                                                        {{item.hazards_rating}}
                                                    </div>
                                                </div>
                                            </div>
                                        </td>

                                        <td class="text-center" style="width: 10%;">{{item.standard_value}} {{item.standard_unit}}</td>
                                        
                                        @* <td class="text-center" style="width: 10%;">{{item.standard_type_text}}</td> *@

                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--Modal Employee Add Start-->
    <div class="modal fade modal-xl" id="modalEmployeeAdd" tabindex="-1" aria-labelledby="modalEmployeeAddLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content scrollbar" style="max-height: calc(100vh - 100px); overflow-y:auto;"">
                <div class="modal-header">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalEmployeeCheckLabel">
                        <span class=" me-2 text-primary"><B>|</B></span> 
                        Search Employee/Contract
                    </h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body">
                    <div class="mb-4">
                        <div class="row g-3">
                            @*<div class="col-auto">
                                <label for="" style="font-size: 14px; font-weight: bold; padding-left: 4px;">Employee</label>
                                <div class="search-box position-relative">
                                    <input class="form-control search-input search"
                                           ng-model="searchText" 
                                           placeholder="Search"
                                           ng-change="fillterDataEmployeeAdd()" />
                                    <span class="fas fa-search search-box-icon"></span>
                                </div>
                            </div>
                            <div class="col-auto">
                                <label for="" style="font-size: 14px; font-weight: bold; padding-left: 4px;">Indicator</label>
                                <div class="search-box position-relative">
                                    <input class="form-control search-input search"
                                           ng-model="searchIndicator.text" 
                                           placeholder="Search"
                                           ng-change="fillterDataEmployeeAdd()" />
                                    <span class="fas fa-search search-box-icon"></span>
                                </div>
                            </div>*@
                            <div class="col-auto">
                                <label for="" style="font-size: 14px; font-weight: bold; padding-left: 4px;">Indicator</label>
                                <div class="search-box position-relative">
                                    <input class="form-control search-input search"
                                           ng-model="searchIndicator.text" 
                                           placeholder="Search"
                                           ng-change="fillterDataEmployeeAdd()" />
                                    <span class="fas fa-search search-box-icon"></span>
                                </div>
                            </div>
                            <div class="col-auto d-flex align-items-end justify-content-end" ng-show="selectDatFormType !== 'approver'">
                                <button class="btn text-light btn-sm" style="background-color: #e90f8b;" 
                                        ng-class="{'button-fade': showContractor}"
                                        ng-click="showContractor = !showContractor">
                                    <span class="fa-solid fa-user-pen"></span> Contractor/Outsource
                                </button>
                            </div>
                        </div>
                    </div>
                        @* start แสดงข้อมูลที่ ค้นหาตาม textsearch*@
                        <div class="bg-white border-top border-bottom border-200 position-relative top-1" >
                            <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                                <table class="table table-sm fs--1 mb-0">
                                    <thead class=" text-uppercase">
                                        <tr class="text-center">
                                            <th class=""> </th>
                                            <th class="pe-5" scope="col">Employee</th>
                                            <th class="" scope="col">Section</th>
                                            <th class="" scope="col">Indicator</th>
                                            <th class="" scope="col">E-Mail</th>
                                            @*<th class="" scope="col">Employee Type</th>*@
                                        </tr>
                                    </thead>
                                    <tbody class=" list">
                                        <tr class="hover-actions-trigger btn-reveal-trigger position-static text-center"
                                            ng-class="{'row-faded': clickedStates[item.employee_name]}"
                                            ng-repeat="item in employeelist_show">
                                            <td class="">
                                                <span class="mx-1">
                                                    <button class="btn btn-outline-secondary p-1 cursor-pointer"
                                                            ng-class="{'btn-clicked': clickedStates[item.employee_name]}" 
                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                            data-toggle="tooltip" 
                                                            data-placement="top" 
                                                            title="choose Employee"
                                                            ng-click="choosDataEmployee(item)">
                                                        <span class="fa-solid fa-user-plus" ng-if="selectDatFormType !== 'owner'">Add</span>
                                                        <span class="fa-solid fa-user-check" ng-if="selectDatFormType === 'owner'">selecte</span>
                                                    </button>
                                                </span>
                                            </td>

                                            <td class="">
                                                <a class=" text-decoration-none d-flex align-items-center">
                                                    <div class="avatar avatar-m" style="height: 20px; width: 20px;">
                                                        <img ng-if="item.employee_img " class="rounded-circle" 
                                                            
                                                                ng-src="../../{{ item.employee_img }}" alt=""><!--- ng-class="{ 'skeleton': loadingData }"---->
                                                    </div>
                                                    <p class="mb-0 ms-3 text-1100 fw-bold"><!---ng-class="{ 'skeleton skeleton-text skeleton-text__body': loadingData }"---->
                                                        {{item.employee_displayname}} 
                                                    </p>
                                                </a>
                                            </td>

                                            <td class="text-center m-0">
                                                <p class="m-0">{{ item.employee_position }}</p>
                                            </td>

                                            <td class="text-center m-0">
                                                <p class="m-0">{{ item.employee_position + '-' + item.employee_displayname.split(' ')[0] }}</p>
                                            </td>

                                            <td class="text-center">
                                                <p class="m-0">{{ item.employee_email }}</p>
                                            </td>
                                        </tr>

                                        <tr ng-if="!searchText && !searchIndicator.text && employeelist_show.length < 1">
                                            <td colspan="5">
                                                <p class="mb-0 ms-3 text-muted fw-bold text-center"> Enter employee details to search. </p>
                                            </td>
                                        </tr>

                                        <tr ng-if="employeelist_show[0].employee_displayname === null">
                                            <td colspan="5">
                                                <p class="mb-0 ms-3 text-1100 fw-bold text-center"> Not Found </p>
                                            </td>
                                        </tr>                                   
                                    </tbody>
                                </table>
                                <div class="pagination-container" ng-show="employeelist_page.length > 10">
                                    <button class="pagination-button" ng-disabled="currentPage === 1" ng-click="action_changepage('prevPage')">Previous</button>
                                    <!-- Page numbers -->
                                    <span class="pagination-info">Page {{currentPage }} of {{ totalPages}}</span>
                                    <!-- Next page button -->
                                    <button class="pagination-button" ng-disabled="currentPage === totalPages" ng-click="action_changepage('nextPage')">Next</button>
                                </div>

                            </div>
                        </div>
                        @* end แสดงข้อมูลที่ ค้นหาตาม textsearch*@
                </div>

                <div class="modal-header bg-soft" ng-if="(selectDatFormType !== 'owner' && (data_memberteam || data_approver || data_workers).length > 1 )">
                    <h5 class="text-900 mb-0">
                        <span class="me-2 text-primary"><B>|</B></span> 
                        {{ selectDatFormType === 'member' ? 'Member Team' :  selectDatFormType === 'worker' ? 'Worker':'Assessment Team Leader' }}
                    </h5>
                </div>
              
                <div class="modal-body" 
                    ng-if="(selectDatFormType !== 'owner' && (data_memberteam.length > 1 || data_approver.length > 1 || data_worker_list.length > 1))">
                    
                    <div class="body-default" ng-if="selectDatFormType != 'worker'">
                        <div class="col-auto py-2" 
                            ng-repeat="item2 in (
                                selectDatFormType === 'member' 
                                    ? data_memberteam 
                                    : data_approver
                                ) | filter:{id_session: selectdata_session }"
                            ng-if="!(item2.user_displayname == '' || item2.user_displayname == null)">
                            <div class="d-flex align-items-center p-1" style="height: 20px;">
                                <button class="btn btn-outline-secondary p-1" 
                                        style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828; width: 25px; height:25px;"
                                        data-toggle="tooltip" 
                                        data-placement="top" 
                                        title="Remove"
                                        ng-click="removeDataEmployee(item2.seq, selectdata_session)">
                                    <span class="fa-regular fa-trash-can fa-lg"></span>
                                </button> 
                                <div class="form-check mb-0 ms-2 text-1100 fw-bold d-flex align-contents-center gap-2" ng-if="selectDatFormType == 'approver'">
                                    <input class="form-check-input rounded-2 cursor-pointer" 
                                        type="checkbox" 
                                        style="width: 24px; height:24px;"
                                        ng-model="item2.verified"
                                        ng-checked="item2.verified"
                                        ng-click="actionVerified(item2)">
                                    <label class="form-check-label m-auto fw-bold" for="">(Verrified)</label>
                                </div>                           
                                <label class="mb-0 ms-3 text-1100 fw-bold" style="width: 80%; border-color: #f1f2f4;">
                                    {{ item2.user_displayname }}
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="body-worker"  ng-if="selectDatFormType == 'worker'">
                        <div class="col-auto py-2" 
                            ng-repeat="item2 in data_worker_list"
                            ng-if="!(item2.user_displayname == '' || item2.user_displayname == null)">
                            <div class="d-flex align-items-center p-1" style="height: 20px;">
                                <button class="btn btn-outline-secondary p-1" 
                                        style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828; width: 25px; height:25px;"
                                        data-toggle="tooltip" 
                                        data-placement="top" 
                                        title="Remove"
                                        ng-click="removeDataEmployee(item2, selectdata_session)"
                                        ng-if="item2.id_tasks">
                                    <span class="fa-regular fa-trash-can fa-lg"></span>
                                </button> 
                                <div ng-if="!item2.id_tasks" style=" width: 25px; height:25px;"></div>
                                <div class="form-check mb-0 ms-2 text-1100 fw-bold d-flex align-contents-center gap-2" ng-if="selectDatFormType == 'approver'">
                                    <input class="form-check-input rounded-2 cursor-pointer" 
                                        type="checkbox" 
                                        style="width: 24px; height:24px;"
                                        ng-model="item2.verified"
                                        ng-checked="item2.verified"
                                        ng-click="actionVerified(item2)">
                                    <label class="form-check-label m-auto fw-bold" for="">(Verrified)</label>
                                </div>                           
                                <label class="mb-0 ms-3 text-1100 fw-bold" style="width: 80%; border-color: #f1f2f4;">
                                    {{ item2.user_displayname }}
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                @*<div class="modal-header bg-soft" ng-if="!(selectDatFormType =='owner' )">

                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='member'"> <span class=" me-2 text-primary"><B>|</B></span>Member Team</h5>
                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='approver'"> <span class=" me-2 text-primary"><B>|</B></span>Assessment Team Leader</h5>

                </div>*@

                @* member 
                <div class="modal-body" ng-if="selectDatFormType =='member'">
                    <div class="col-auto" ng-repeat="item2 in data_memberteam | filter:{id_session: selectdata_session }"
                         ng-if="!(item2.user_displayname ==''  || item2.user_displayname == null)">
                        <div class="d-flex align-items-center p-1" style="height: 20px;">
                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                    ng-class="{'d-none':(!tab_general_active)}"
                                    ng-click="removeDataEmployee(item2.seq, selectdata_session)">
                                Remove
                            </button>
                            <label class="mb-0 ms-3 text-1100 fw-bold"
                                   style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>

                        </div>
                    </div>

                </div>

                @* approver 
                <div class="modal-body" ng-if="selectDatFormType =='approver'">
                    @* start ข้อมูลเดียวกันกับตรง session Approver
                    <div class="col-auto" ng-repeat="item2 in data_approver | filter:{id_session: selectdata_session }"
                         ng-if="!(item2.user_displayname ==''  || item2.user_displayname == null)">
                        <div class="d-flex align-items-center p-1" style="height: 20px;">
                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                    ng-class="{'d-none':(!tab_general_active)}"
                                    ng-click="removeDataApprover(item2.seq, selectdata_session)">
                                Remove
                            </button>
                            <div class="form-check mt-1 mb-0 text-1100 fw-bold">
                                <input class="form-check-input disabled-link" type="checkbox"
                                       ng-if="item2.approver_type =='approver'" checked
                                       ng-click="actionChangeSafety(item2,item2.seq)">
                                <input class="form-check-input" type="checkbox"
                                       ng-if="!(item2.approver_type =='approver')"
                                       ng-click="actionChangeSafetyUnCheck(item2,item2.seq)">
                                <label class="form-check-label fw-bold" for="approver_safety">
                                    (QMTS)
                                </label>
                            </div>
                            <label class="mb-0 ms-3 text-1100 fw-bold"
                                   style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>


                        </div>
                    </div>
                    @* end ข้อมูลเดียวกันกับตรง session
                </div>*@

            </div>
        </div>
    </div>
    <!--Modal Employee Check End-->
    @*


    *@
    @* Save *@
    <!--Modal File Start-->
    <div class="modal fade" id="modalMsgFile" tabindex="-1" aria-labelledby="modalMsgFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header bg-warning">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsgFileLabel">
                        <span class=" me-2"><B>|</B></span>Warning
                    </h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body d-flex flex-column justify-content-center mb-4">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        Upload Data Success.
                    </h5>
                </div>
            </div>
        </div>
    </div>
    @* msg error file *@
    <div class="modal fade" id="modalMsgFileError" tabindex="-1" aria-labelledby="modalMsgFileErrorLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header bg-warning">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsgFileErrorLabel">
                        <span class=" me-2"><B>|</B></span>Warning
                    </h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body d-flex flex-column justify-content-center mb-4"
                     ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        File type not allowed for attachment.<br />
                        Please select a PDF, Word or Excel, Image file.<br />
                        (.PDF, .DOC, .DOCX, .XLS, .XLSX, .JPG, .PNG, .GIF)
                    </h5>
                </div>
            </div>
        </div>
    </div>
    <!--Modal File End-->
    <!--Modal Save Start-->
    <div class="modal fade" id="modalMsg" tabindex="-1" aria-labelledby="modalMsgLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center" style="display: flex !important;"
                     ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? false :true) }">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-triangle-exclamation fa-lg" ng-if="Action_Msg_Header == 'Warning'"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                        <i class="fa-solid fa-circle-check fa-lg" ng-if="Action_Msg_Header != 'Warning'"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body" ng-if="Action_Msg_Header == 'Success'">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <h5 class="mb-0 text-center " style="font-size: 40px; font-weight: bold;" data-anchor="data-anchor" id="modalMsgLabel">
                            {{Action_Msg_Header}}
                        </h5>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 mb-3">
                        <p class="lh-lg mb-0 text-center" style="font-size: 16px;">
                            {{ Action_Msg_Detail}}
                        </p>
                    </div>

                </div>
                <div class="modal-footer" ng-if="Action_Msg_Header == 'Success'">
                    <div class="d-flex flex-column align-items-center bg-primary"
                         ng-if="!Action_Msg_Confirm">
                        <button class="btn p-2 px-8 text-white" type="button" data-bs-dismiss="modal" aria-label="Close">
                            OK
                        </button>
                    </div>
                </div>

                <div class="modal-body" ng-if="Action_Msg_Header == 'Warning'">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <h5 class="mb-0 text-center ms-5" style="font-size: 40px; font-weight: bold;" data-anchor="data-anchor" id="modalMsgLabel">
                            {{Action_Msg_Header}}
                        </h5>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 mb-3">
                        <p class="lh-lg mb-0 text-center" style="font-size: 16px;">
                            {{ Action_Msg_Detail}}
                        </p>
                    </div>
                    <div class="d-flex flex-column align-items-center" ng-if="!Action_Msg_Confirm">
                        <button class="btn p-2 px-8 text-white" type="button" data-bs-dismiss="modal" aria-label="Close"
                                ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? false :true) }">
                            {{ Action_Msg_Header == 'Warning' ? 'Go back' : 'OK' }}
                        </button>
                    </div>
                </div>

                <div class="modal-body d-flex flex-column justify-content-center mb-4"
                     ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        Do you want to continue?
                    </h5>
                </div>
                <div class="modal-footer" ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <div class="d-flex justify-content-center align-items-center">
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmSubmit('yes')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-check"></span> Yes
                            </a>
                        </button>
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmSubmit('no')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-times"></span> No
                            </a>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Save End-->
    <div class="modal fade" id="modalMsg2" tabindex="-1" aria-labelledby="modalMsg2Label"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? true :false) }">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsg2Label">
                        <span class=" me-2" ng-class="{ 'text-danger' : (Action_Msg_Header == 'Warning'? true :false),'text-primary' : (Action_Msg_Header == 'Warning'? true :false) }"><B>|</B></span> {{Action_Msg_Header}}
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" ng-if="!Action_Msg_Confirm">
                    <p class="text-700 lh-lg mb-0">{{Action_Msg_Detail}}</p>
                </div>

                <div class="modal-body">

                    <div class="d-flex justify-content-center">
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmMailtoMemberReview('yes')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-check"></span> Yes
                            </a>
                        </button>
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmMailtoMemberReview('no')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-times"></span> No
                            </a>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!--Modal Export & Import Data Start-->
    <div class="modal fade modal-xl" id="modalExportImport" tabindex="-1" aria-labelledby="modalExportImportLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportImportLabel">Export & Import Data</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                </div>

            </div>
        </div>
    </div>
    <!--Modal Export & Import Data End-->
    @*


    *@
    @* RAM *@

    <!--Modal RAM Start-->
    <div class="modal fade modal-xl shadow-sm p-3 mb-5  rounded" id="modalRAM" tabindex="-1"
         aria-labelledby="modalRAMLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered"
             ng-style=" { 'width' :  (select_columns_level !=5 && (selectedDataNodeWorksheetRamType == 's' || selectedDataNodeWorksheetRamType == 'l')  ) ?'500px' :  '100%' }">

            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalRAMLabel">Risk Assessment Matrix (RAM){{(selectedDataNodeWorksheetRamType =='s'?' : Security':(selectedDataNodeWorksheetRamType =='l'?' : Likelihood':''))}}</h5>


                    <div class="col-auto ms-auto" style="zoom:1.5">
                        <b class="pe-1 me-1"> Security : {{cal_ram_action_security}}</b>
                        <b class="pe-1 me-1"> Likelihood : {{cal_ram_action_likelihood}}</b>
                        <b class="pe-1 me-1">  Risk : </b>
                        <label class="pe-1 me-1 text-center" style="width:100px"
                               ng-style=" { 'background-color' : ((cal_ram_action_risk == 'H') ? 'red' : ((cal_ram_action_risk == 'M') ? 'yellow' : ((cal_ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }">{{cal_ram_action_risk}}</label>
                    </div>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body">

                    <div class="row">
                        @*
                        <div class="col-12 mb-1">
                        <b class="pe-1 me-1"> Security : {{cal_ram_action_security}}</b>
                        <b class="pe-1 me-1"> Likelihood : {{cal_ram_action_likelihood}}</b>
                        <b class="pe-1 me-1">  Risk : </b>
                        <label class="pe-1 me-1 text-center" style="width:200px"
                        ng-style=" { 'background-color' : ((cal_ram_action_risk == 'H') ? 'red' : ((cal_ram_action_risk == 'M') ? 'yellow' : ((cal_ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }">{{cal_ram_action_risk}}</label>
                        </div> *@

                        <div class="col-6" ng-if="!previewRam">

                            <table class="table table-sm fs--1 mb-0 col-auto ">
                                <thead class="bg-light-primary">
                                    <tr>
                                        <td rowspan="2" class="text-center"></td>
                                        <th rowspan="1" colspan="3" class="text-center" ng-if="select_columns_level != 5">Security</th>
                                        <th rowspan="1" colspan="6" class="text-center" ng-if="select_columns_level == 5">Security</th>
                                    </tr>
                                    <tr ng-if="select_columns_level != 5">
                                        <td class="text-center">Level</td>
                                        <td>Description</td>
                                    </tr>
                                    <tr ng-if="select_columns_level == 5">
                                        <td class="text-center">Level</td>
                                        <td>People</td>
                                        <td>Assets</td>
                                        <td>Enhancement</td>
                                        <td>Reputation</td>
                                        <td>Product Quality</td>
                                    </tr>
                                </thead>

                                <tbody class=" align-top text-start">
                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                        ng-repeat="item_ram in master_security_level | filter:{id_ram:data_general[0].id_ram,category_type:item_ram.category_type}">
                                        <td class=" text-end" style="width: 80px;">
                                            <a class="pointer" ng-click="selectDataRAM('s',item_ram.security_level)"
                                               aria-label="Close">Select</a>
                                        </td>
                                        <td class="text-center">{{item_ram.security_level}}</td>
                                        <td ng-if="item_ram.category_type !== 5">{{item_ram.security_text}}</td>
                                        <td ng-if="item_ram.category_type == 5">{{item_ram.people_text}}</td>
                                        <td ng-if="item_ram.category_type == 5">{{item_ram.assets_text}}</td>
                                        <td ng-if="item_ram.category_type == 5">{{item_ram.enhancement_text}}</td>
                                        <td ng-if="item_ram.category_type == 5">{{item_ram.reputation_text}}</td>
                                        <td ng-if="item_ram.category_type == 5">{{item_ram.product_quality_text}}</td>
                                    </tr>
                                </tbody>
                            </table>


                        </div>
                        <div class="col-6" ng-if="!previewRam">

                            <table class="table table-sm fs--1 mb-0 col-auto ">
                                <thead class="bg-light-primary">
                                    <tr>
                                        <td  class="text-center"></td>
                                        <th rowspan="2" colspan="3" ng-if="select_columns_level != 5">Likelihood</th>
                                        <th rowspan="2" colspan="5" ng-if="select_columns_level == 5">Likelihood</th>
                                    </tr>
                                    <tr ng-if="select_columns_level != 5">
                                        <td class="text-center">Level</td>
                                        <td>Description</td>
                                    </tr>
                                    <tr ng-if="select_columns_level == 5">
                                        <td class="text-center">Level</td>
                                        <td>Description</td>
                                        <td>Description(2)</td>
                                        <td>Criterion</td>
                                    </tr>
                                </thead>

                                <tbody class=" align-top text-start">
                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                        ng-repeat="item_ram in master_likelihood_level | filter:{id_ram:data_general[0].id_ram,columns_level:item_ram.columns_level}">
                                        <td class="text-end pointer" style="width: 80px;">
                                            <a class="pointer" ng-click="selectDataRAM('l',item_ram.likelihood_level)"
                                               aria-label="Close">Select</a>
                                        </td>
                                        <td class="text-center">{{item_ram.likelihood_level}}</td>
                                        <td ng-if="item_ram.columns_level !== 5">{{item_ram.likelihood_show}}</td>

                                        <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_text}}</td>
                                        <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_desc}}</td>
                                        <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_criterion}}</td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>

                        <div class="col-12 mt-1 pt-1" style="zoom:0.7;">

                            <div class="text-center cursor-pointer " ng-repeat="itemRam in master_ram | filter:{id: data_general[0].id_ram}">
                                <img src="{{itemRam.document_file_path}}" style="width: 400px;  height:300px;" />
                            </div>

                        </div>
                    </div>

                </div>

                <div class="modal-body d-none">
                    <div class="row">

                        <div class="col-12 mb-1">
                            <b class="pe-1 me-1"> Security : {{cal_ram_action_security}}</b>
                            <b class="pe-1 me-1"> Likelihood : {{cal_ram_action_likelihood}}</b>
                            <b class="pe-1 me-1">  Risk : </b>
                            <label class="pe-1 me-1 text-center" style="width:200px"
                                   ng-style=" { 'background-color' : ((cal_ram_action_risk == 'H') ? 'red' : ((cal_ram_action_risk == 'M') ? 'yellow' : ((cal_ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }">{{cal_ram_action_risk}}</label>
                        </div>


                    </div>


                    <div ng-if="(selectedDataNodeWorksheetRamType == 'r' || selectedDataNodeWorksheetRamType == 'ram')">


                        <div class="text-center cursor-pointer " ng-repeat="itemRam in master_ram | filter:{id: data_general[0].id_ram}">
                            <img src="{{itemRam.document_file_path}}" style="width: 400px;  height:300px;" />
                        </div>


                    </div>
                    <div ng-if="selectedDataNodeWorksheetRamType == 's'">

                        <table class="table table-sm fs--1 mb-0 col-auto ">
                            <thead class="bg-light-primary">
                                <tr>
                                    <td rowspan="2" class="text-center"></td>
                                    <th rowspan="1" colspan="3" class="text-center" ng-if="select_columns_level != 5">Security</th>
                                    <th rowspan="1" colspan="6" class="text-center" ng-if="select_columns_level == 5">Security</th>
                                </tr>
                                <tr ng-if="select_columns_level != 5">
                                    <td class="text-center">Level</td>
                                    <td>Description</td>
                                </tr>
                                <tr ng-if="select_columns_level == 5">
                                    <td class="text-center">Level</td>
                                    <td>People</td>
                                    <td>Assets</td>
                                    <td>Enhancement</td>
                                    <td>Reputation</td>
                                    <td>Product Quality</td>
                                </tr>
                            </thead>

                            <tbody class=" align-top text-start">
                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                    ng-repeat="item_ram in master_security_level | filter:{id_ram:data_general[0].id_ram,category_type:item_ram.category_type}">
                                    <td class=" text-end" style="width: 80px;">
                                        <a class="pointer" ng-click="selectDataRAM('s',item_ram.security_level)"
                                           data-bs-dismiss="modal" aria-label="Close">Select</a>
                                    </td>
                                    <td class="text-center">{{item_ram.security_level}}</td>
                                    <td ng-if="item_ram.category_type !== 5">{{item_ram.security_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.people_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.assets_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.enhancement_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.reputation_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.product_quality_text}}</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <div ng-if="selectedDataNodeWorksheetRamType == 'l'">

                        <table class="table table-sm fs--1 mb-0 col-auto ">
                            <thead class="bg-light-primary">
                                <tr>
                                    <td rowspan="2" class="text-center"></td>
                                    <th rowspan="1" colspan="3" ng-if="select_columns_level != 5">Likelihood</th>
                                    <th rowspan="1" colspan="5" ng-if="select_columns_level == 5">Likelihood</th>
                                </tr>
                                <tr ng-if="select_columns_level != 5">
                                    <td class="text-center">Level</td>
                                    <td>Description</td>
                                </tr>
                                <tr ng-if="select_columns_level == 5">
                                    <td class="text-center">Level</td>
                                    <td>Description</td>
                                    <td>Description(2)</td>
                                    <td>Criterion</td>
                                </tr>
                            </thead>

                            <tbody class=" align-top text-start">
                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                    ng-repeat="item_ram in master_likelihood_level | filter:{id_ram:data_general[0].id_ram,columns_level:item_ram.columns_level}">
                                    <td class="text-end pointer" style="width: 80px;">
                                        <a class="pointer" ng-click="selectDataRAM('l',item_ram.likelihood_level)"
                                           data-bs-dismiss="modal" aria-label="Close">Select</a>
                                    </td>
                                    <td class="text-center">{{item_ram.likelihood_level}}</td>
                                    <td ng-if="item_ram.columns_level !== 5">{{item_ram.likelihood_show}}</td>

                                    <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_text}}</td>
                                    <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_desc}}</td>
                                    <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_criterion}}</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>

                </div>

            </div>

        </div>
    </div>
    <!--Modal RAM End-->
    <!--Modal New RAM-->
    <div class="modal fade" id="modalNewRAM" tabindex="-1" aria-labelledby="modalNewRAM"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalNewRAM">Risk Assessment Matrix</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3 flex-start mb-3">
                        <div class="col-md-8 ps-2">
                            <input class="form-control rounded-1 ps-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                   type="text" placeholder="Ram Name"
                                   name="ram_name"
                                   ng-model="item.ram_name"
                                   ng-keyup="actionChange_ram_name(item.ram_name)">
                        </div>
                    </div>

                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center ">
                            <select class="form-control" ng-model="ram_rows_level">
                                <option ng-repeat="itemNo in master_no">
                                    {{itemNo.name}}
                                </option>
                            </select>
                            <label class="form-label" style=" width:100px">X</label>
                            <select class="form-control" ng-model="ram_columns_level">
                                <option ng-repeat="itemNo in master_no">
                                    {{itemNo.name}}
                                </option>
                            </select>
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm" style="width: 100px;" ng-click="confirmAddRAM()">Add</button>
                            </span>
                        </div>
                        <div class="">
                            <label class="form-label">{{ram_msg_level}}</label>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal New RAM-->
    @*


    *@
    @* Notification *@
    @* <!--Modal Notification Start--> *@
    <div class="modal fade modal-xl" id="modalNotification" tabindex="-1" aria-labelledby="modalNotificationLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalNotificationLabel">Notification (SAP)</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3">
                        <div class="text-center cursor-pointer ">

                            <div class="table-responsive scrollbar-overlay mx-n1 px-1" style="zoom:0.7">
                                <table class="table table-sm fs--1 mb-0">
                                    <thead class=" text-uppercase">
                                        <tr>
                                            <th class="fs--1 align-middle ps-0 py-3">Notif Date </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Notif Time </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Notification </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Orders </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Type </th>
                                            <th class="fs--1 align-middle ps-0 py-3">P </th>
                                            <th class="fs--1 align-middle ps-0 py-3">PLS </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Functional Location </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Descriptions Func </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Descriptions </th>
                                            <th class="fs--1 align-middle ps-0 py-3">MN(wk)</th>
                                            <th class="fs--1 align-middle ps-0 py-3">Plnt </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Reported By </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Required Start </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Required End </th>
                                            <th class="fs--1 align-middle ps-0 py-3">User Status </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Date Update </th>
                                        </tr>
                                    </thead>
                                    <tbody class=" list" ng-repeat="itemMaster in master_functional | orderBy:seq">
                                        <tr class="hover-actions-trigger btn-reveal-trigger position-static ">
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notif_date}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notif_time}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notification}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.orders}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.typ}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.p}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.pls}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.functional_location}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.descriptions_func}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.descriptions}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.mn_wk}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.plnt}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.reported_by}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.required_start}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.required_end}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.user_status}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.date_update}}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    @* <!--Modal Notification End--> *@

    <!--Modal Export File Start-->
    <div class="modal fade" id="modalExportFile" tabindex="-1" aria-labelledby="modalExportFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportFileLabel">Download File</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="bg-white position-relative top-1">

                        <a href="{{exportfile[0].DownloadPath}}" id="exportfile" name="exportfile" target="_blank">
                            {{exportfile[0].Name}}
                        </a>

                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Export File End-->
    <!--Modal Cause Show-->
    <div class="modal fade modal-xl" id="modalCauseText" tabindex="-1" aria-labelledby="modalCauseTextLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalCauseTextLabel">Details</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3">
                        <div class="" ng-repeat="itms_show in data_listworksheet_show ">
                            {{itms_show.workstep_no +'.'+ itms_show.cause}}
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Cause Show-->
    @*


    *@
    @* e-Mail *@
    <!--Modal Check Send e-Mail Case Save for PHA Conduct -->
    <div class="modal fade" id="modalSendMailRegister" tabindex="-1" aria-labelledby="modalSendMailRegisterLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_register_without')">
                                    Save for PHA Conduct
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail Case Save for PHA Conduct -->
    <!--Modal กรณีที่ Draft เมื่อกด Tab JSEA Worksheet-->
    <div class="modal fade" id="modalPleaseRegister" tabindex="-1"
         aria-labelledby="modalPleaseRegisterLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-end align-items-end bg-primary" style="display: flex !important;">
                    <div class="d-flex justify-content-end mb-2">
                        <i class="fa-solid fa-times" ng-click="closePleaseRegister()"
                           style="color: rgb(255, 255, 255); font-size: 20px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalPleaseRegisterLabel" style="font-size: 20px; font-weight: bold;">
                            Please register task before fill in JSEA Worksheet.
                        </h5>

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm col-auto" ng-click="confirmSave('confirm_submit_register')">Register with notify members</button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-success btn-sm col-auto" ng-click="confirmSave('confirm_submit_register_without')">Register without notify members</button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal กรณีที่ Draft เมื่อกด Tab JSEA Worksheet-->
    <!--Modal Check Send e-Mail ปุ่ม Submit ที่ Status WPC -->
    <div class="modal fade" id="modalSendMailConduct" tabindex="-1" aria-labelledby="modalSendMailConductLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h6 class="modal-title mb-0 text-center" id="modalSendMailConductLabel" style="font-size: 40px; font-weight: bold;">
                            Complete JSEA Worksheet for all sessions?
                        </h6>
                    </div>
                    <div class="justify-content-center align-items-center mb-5" ng-if=" data_header[0].pha_status == 22">

                        <label class="form-label ps-0" for="expense_type">Note to Approver</label>
                        <textarea class="form-control rounded-1" placeholder="Note"
                                  ng-repeat="item in data_node | filter:{id:selectedItemNodeView}"
                                  ng-model="item.descriptions"
                                  ng-if=" data_header[0].pha_status == 22"
                                  style="height: 50px"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">

                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_complete')">
                                    Complete and Submit to Safety Reviewer
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        style=" background-color: #c9c5c5;"
                                        ng-click="confirmSave('confirm_cancel_complete')">
                                    Cancel
                                </button>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Submit ที่ Status WPC -->
    <!--Modal Check Send e-Mail ปุ่ม Team Member Start-->
    <div class="modal fade" id="modalSendMailTeam" tabindex="-1" aria-labelledby="modalSendMailTeamLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h4 class="modal-title mb-0 text-center" id="modalSendMailTeamLabel" style="font-size: 40px; font-weight: bold;">
                            Confirm send email to member review?
                        </h4>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmMailtoMemberReview('confirm_submit_team')">
                                    Yes
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        ng-click="confirmMailtoMemberReview('confirm_cancel_team')"
                                        style=" background-color: #c9c5c5;">
                                    No
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Team Member Start-->
    <!--Modal Genarate Full Report -->
    <div class="modal fade" id="modalSendGenarateFullReport" tabindex="-1" aria-labelledby="modalSendGenarateFullReportLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary"
                     style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h4 class="modal-title mb-0 text-center" id="modalSendGenarateFullReportLabel"
                            style="font-size: 40px; font-weight: bold;">
                            Genarate Full Report?
                        </h4>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_genarate')">
                                    Genarate Full Report with notify members.
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_genarate_without')"
                                        style=" background-color: #c9c5c5;">
                                    Genarate Full Report without notify members.
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Genarate Full Report-->
    <!--Modal Check Send e-Mail ปุ่ม Submit TA2 Approver-->
    <div class="modal fade" id="modalSendMailApprover" tabindex="-1" aria-labelledby="modalSendMailApproverLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalSendMailApproverLabel" style="font-size: 40px; font-weight: bold;">
                            Submit JSEA Worksheet for all sessions?
                        </h5>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_approver')">
                                    Submit
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        style=" background-color: #c9c5c5;"
                                        ng-click="confirmSave('confirm_cancel_approver')">
                                    Cancel
                                </button>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Submit TA2 Approver-->
    
    <!----------------------------------------------->
    <div class="modal fade" id="unsavedChangesModal" tabindex="-1" role="dialog" 
        aria-labelledby="unsavedChangesModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="unsavedChangesModalLabel">Unsaved Changes</h5>
                @*<button type="button border-0" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>*@
            </div>
            <div class="modal-body">
                You have unsaved changes. Are you sure you want to leave?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" type="button" data-bs-dismiss="modal" aria-label="Close" id="stayButton" 
                        ng-click="action_leavePage('stay')">Stay</button>
                <button type="button" class="btn btn-primary" id="leaveButton" ng-click="action_leavePage('leaveWithsave')">Leave with Save</button>
                <button type="button" class="btn btn-primary" id="leaveButton" ng-click="action_leavePage('leave')">Leave</button>
            </div>
            </div>
        </div>
    </div>


</div>

@section Scripts {

    <script src="~/assets/js/angular.min.js"></script>
    <script src="~/assets/js/lodash.min.js"></script>
    <script src="~/assets/js/phoenix.js"></script>
    <script src="~/assets/js/choices.min.js"></script>
    <script src="~/assets/js/fakedata.js"></script>

    <script src="~/js/_flow/hra.js"></script>

}
