@{
    ViewData["Title"] = "JSEA Sub-Sofware";

    Layout = "~/Views/Shared/_LayoutWeb.cshtml";

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

    <link rel="stylesheet" href="~/assets/css/theme.min.css">

    <link rel="stylesheet" href="~/assets/css/tablefreezer.css">

    <link href="~/assets/css/theme.min.css" type="text/css" rel="stylesheet" id="style-default">

    <link href="~/assets/css/choices.min.css" type="text/css" rel="stylesheet">

    <script src="~/assets/js/config.js"></script>

    <link rel="stylesheet" href="~/css/autocomplete.css">

    <link rel="stylesheet" href="~/css/tooltips.css">

    <link rel="stylesheet" href="~/css/button.css">

    <link rel="stylesheet" href="~/css/scollbar.css">

    <script src="~/assets/js/all.min.js"></script>

    <link rel="stylesheet" href="~/css/myStyles.css">
}

<div class="content mt-1" style="font-size: 12px; min-height: auto !important; overflow-x:hidden;" id="divPage"
     ng-controller="ctrlAppPage"
     ng-click="toggleResultsVisibility()">


    <div class="row g-0">

        <div class="col-6">
            <div class="card shadow-sm p-2 mb-3 bg-light rounded">
                <div class="card-body p-2">
                   <div class="row justify-content-between">
                        <div class="col-auto d-flex gap-4 ">
                             <div class="col-auto">
                                <b>PHA No.:</b> <br>
                                <span class="text-uppercase">{{ ( data_header[0].action_type =='update' ? data_header[0].pha_no : data_header[0].pha_sub_software + '-2023-00000XX')}}</span>
                            </div>
                            <div class="col-auto">
                                <b>Revision :</b> <br>
                                <span ng-if="data_header[0].pha_version>0 "> {{data_header[0].pha_version_text + '(' + data_header[0].pha_version_desc  +  ')'}}</span>
                                <span ng-if="data_header[0].pha_version==0 "> - </span>

                            </div>
                            <div class="col-auto">
                                <b>Request By :</b> <br>
                                <span>{{data_header[0].request_user_displayname}}</span>
                            </div>
                            <div class="col-auto">
                                <b>Request Status :</b> <br>
                                <span> {{data_header[0].pha_status_displayname}}</span>
                            </div>
                        </div>
                        <div class="col-auto" ng-class="{ 'd-none': (minutes > 9) }">
                            <div class="col-auto">
                                <b>Expire Within :</b> <br>
                                <span ng-class="{ 'blinking-text': (minutes <= 10) }">{{counterText}} </span>
                            </div>
                       </div>
                    </div>

                    <div class="row">
                    </div>

                </div>
            </div>

        </div>

        <div class="col-6 ">

            <div class="d-flex align-items-center py-2  justify-content-end">
                <span class="mx-2">
                    <button class="btn btn-outline-secondary btn-sm" style="width: 100px;" ng-click="confirmBack()">BACK</button>
                </span>
                <span class="mx-2" ng-if="cancle_type && data_header[0].action_change > 0">
                    <button class="btn btn-danger btn-sm" style="width: 100px;" ng-click="confirmCancle()">CANCEL</button>
                </span>
                <span class="mx-2" ng-if="export_type && false">
                    <button class="btn text-light btn-sm" style="background-color: #e90f8b;" ng-click="clickExportReport()">EXPORT/IMPORT</button>
                </span>
                <span class="mx-2" ng-if="save_type">
                    <button class="btn btn-primary btn-sm" style="width: 100px;" ng-click="confirmSave('save')">SAVE</button>
                </span>
                <span class="mx-2" ng-if="action_to_review_type">
                    <button class="btn btn-warning btn-sm" style="width: 200px;"
                            ng-click="confirmMailtoMemberReview('submit')">
                        <span style="font-size:9px">EMAIL TO MEMBER TEAM REVIEW</span>
                    </button>
                </span>
                <span class="mx-2" ng-if="submit_type">
                    <button class="btn btn-success btn-sm d-none" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 11" ng-click="confirmSave('submit_register')">
                        Save for PHA Conduct
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 12" ng-click="confirmSave('submit_conduct')">
                        Submit
                    </button>
                    <button class="btn btn-success btn-sm" style="width: 150px;"
                            ng-if=" data_header[0].pha_status == 22" ng-click="confirmSave('submit_conduct')">
                        Submit
                    </button>
                </span>
            </div>

            <div class="float-end pe-3">
                <div class="form-check form-switch  disabled-link">
                    <input class="form-check-input" id="flexSwitchCheckChecked" type="checkbox" />
                    <label class="form-check-label" for="flexSwitchCheckChecked">History tracking record</label>
                </div>
            </div>

        </div>

    </div>

    <div class="row g-0">
        <div class="col-12 ">

            <div class="card">

                <div class="card-header mb-0 pb-0 border border-bottom-0 ">

                 @*    <ul class="nav nav-underline border-3 border-primary border-bottom " id="myTab" role="tablist">

                        <li ng-repeat="tab in tabs" class="mx-2 " ng-if="tab.isShow || true">
                            <a ng-click="changeTab(tab)"
                               class="btn btn-outline-primary border border-0 "
                               ng-class="{'btn btn-outline-primary border border-0 active': (tab.isActive==true),'btn btn-outline-primary border border-0 ': (tab.isActive==false) }"
                               style="border-radius: 10px 10px 0px 0px !important;"
                               id="{{tab.name}}-tab" name="{{tab.name}}-tab"
                               data-bs-toggle="tab" href="#tab-{{tab.name}}" role="tab"
                               aria-controls="tab-{{tab.name}}"
                               aria-selected="tab.isActive">{{ tab.title }}</a>
                        </li>
                    </ul> *@

                    <ul class="nav nav-underline border-3 border-primary border-bottom " id="myTab" role="tablist" style="position: relative;">

                        <li ng-repeat="tab in tabs" class="mx-2 " ng-if="tab.isShow || true">
                            <a ng-click="changeTab(tab)"
                               class="btn btn-outline-primary border border-0 "
                               ng-class="{'btn btn-outline-primary border border-0 active': (tab.isActive==true),'btn btn-outline-primary border border-0 ': (tab.isActive==false) }"
                               style="border-radius: 10px 10px 0px 0px !important;"
                               id="{{tab.name}}-tab" name="{{tab.name}}-tab"
                               data-bs-toggle="tab" href="#tab-{{tab.name}}" role="tab"
                               aria-controls="tab-{{tab.name}}"
                               aria-selected="tab.isActive">{{ tab.title }}</a>
                        </li>
                    </ul>

                </div>


                <div class="card-body tab-content">
                    <!-- general information start -->
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==1),'tab-pane fade':(action_part!==1)}"
                         id="tab-general" role="tabpanel" aria-labelledby="general-tab">

                        @*  general *@
                        <div class="m-3 row  gx-0 align-items-center ">
                            <div class="card border-0">
                                <div class="mx-1 row g-3 align-items-center" ng-repeat="item in data_general ">

                                    <!-- company -->
                                    <div class="col-md-2 ">
                                        <label class="form-label ps-0" for="expense_type">
                                            <b class="text-danger d-none"> * </b>Company
                                        </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" name="company" title="" data-bs-html="true"></a>
                                        </label>
                                        <select class="form-control js-choice-company "
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')" ng-model="item.id_company">
                                            <option ng-repeat="item2 in master_company | orderBy:'id'" ng-value="item2.id">
                                                {{item2.name}}
                                            </option>
                                        </select>
                                    </div>
 
                                    <!-- area -->
                                    <div class="col-md-auto p-1 " ng-if="item.id_company != '9999' ">
                                        <div class="row g-0 align-items-center">
                                            <div class="col-12 p-1  ">
                                                <label class="form-label ps-0" for="area"><b class="text-danger d-none"> * </b>Area Process Unit </label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title=" Area Process Unit : A" data-bs-html="true"></a>
                                                </label>
                                                <label class="form-label ps-0" for="area"></label>
                                                <select class="form-control js-choice-apu"
                                                        ng-class="{'disabled-\link':(!tab_general_active)}"
                                                        data-choices="data-choices"
                                                        data-options='{"removeItemButton":true,"placeholder":true}'
                                                        ng-change="actionChange(item,item.seq,'')" ng-model="item.id_apu">
                                                    <option ng-repeat="item2 in master_apu" ng-value="item2.id">
                                                        {{item2.name}}
                                                    </option>
                                                </select>

                                            </div>

                                        </div>
                                    </div>

                                    <!-- toc -->
                                    <div class="col-md-auto p-1" ng-if="item.id_company != '9999' ">
                                        <div class="row g-0 align-items-center">
                                            <div class="col-12 p-1  ">
                                                <label class="form-label ps-0" for="toc"><b class="text-danger d-none"> * </b>Thaioil Complex </label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title="Thaioil Complex" data-bs-html="true"></a>
                                                </label>
                                                <label class="form-label ps-0" for="toc"></label>
                                                <select class="form-control js-choice-toc"
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        data-choices="data-choices"
                                                        data-options='{"removeItemButton":true,"placeholder":true}'
                                                        ng-change="actionChange(item,item.seq,'')" ng-model="item.id_toc">
                                                    <option ng-repeat="item2 in master_toc"
                                                            ng-value="item2.id"
                                                            value="item2.id"
                                                            ng-if="item2.id_company == item.id_company && item2.id_area == item.id_apu">
                                                        {{item2.name}}
                                                    </option>
                                                </select>



                                            </div>
                                        </div>
                                    </div>
              
                                    <!-- Unit No -->
                                    <div class="col-md-3 p-1 align-items-top" ng-if="item.id_company != '9999' ">
                                        <label class="form-label ps-0" for="unit"><b class="text-danger d-none"> * </b>Unit No </label><spand class="text-danger" style="font-size:10px;">(กรณีที่ไม่มี Unit No ต้องเลือก TAG ID )</spand>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Unit No : ADIP Unit" data-bs-html="true"></a>
                                        </label>

                                        <select class="form-control col-auto js-choice-unit_no"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')" ng-model="item.id_unit_no">
                                            <option ng-selected="item.id_unit_no == item2.id"
                                                    ng-repeat="item2 in master_unit_no" ng-value="item2.id"
                                                    ng-if="item2.id_company == item.id_company && item2.id_area == item.id_apu">
                                                {{item2.name}}
                                            </option>
                                        </select>

                                    </div>
                                
                                    <!-- Tag ID -->
                                    <div class="col-md-auto p-1 align-items-top" ng-if="item.id_company != '9999' ">
                                        <label class="form-label ps-0" for="tagid"><b class="text-danger d-none"> * </b>Tag ID/ Equipment </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title="" data-bs-html="true"></a>
                                        </label>

                                        <select class="form-control js-choice-tagid"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')" ng-model="item.id_tagid">
                                            <option ng-selected="item.id_tagid == item2.id"
                                                    ng-repeat="item2 in master_tagid" ng-value="item2.id">
                                                {{item2.name}}
                                            </option>
                                        </select>

                                    </div>
                                  
                                    <!-- Tag ID Audition => tagid_audition -->
                                    <div class="col-md-auto p-1 align-items-top">
                                        <label class="form-label ps-0" for="tagid_audition">Tag ID/ Equipment Audition</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" data-bs-html="true"></a>
                                        </label>

                                        <select class="form-select align-bottom rounded-1 js-choice-tagid_audition"
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                style="height: 36px;" data-choices="data-choices" data-options='{"removeItemButton":true,"placeholder":true}'
                                                id="organizerMultiple"
                                                name="tagid_audition"
                                                multiple="multiple"
                                                ng-model="item.tagid_audition"
                                                ng-change="actionChange(item,item.seq,'')"
                                                ng-if="tab_general_active">
                                                 <option value="" disabled selected hidden>Please select</option>
                                            <option ng-repeat="item2 in master_tagid"
                                                    ng-selected="item.tagid_audition == item2.name"
                                                    value="{{item2.name}}">
                                                {{ item2.name }}
                                            </option>
                                        </select>

                                        <input class="form-control rounded-1 ps-1"
                                               ng-class="{'disabled-link':(!tab_general_active)}"
                                               ng-if="!tab_general_active"
                                               type="text"
                                               ng-model="item.tagid_audition" />

                                    </div>

                                    <!-- description -->
                                    <div class="col-md-auto p-1 align-items-top" ng-if="item.id_company == '9999' ">
                                        <label class="form-label ps-0">Description</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top" title=" Description :  " data-bs-html="true"></a>
                                        </label>
                                        <textarea class="form-control rounded-1"
                                                  ng-class="{'disabled-link':(!tab_general_active)}"
                                                  id="description_general" name="description_general"
                                                  placeholder="Description" style="height: 30px; width:150%;"></textarea>
                                    </div>

                                </div>
                                <!-- Tag ID Audition-->
                                <div class="mx-2 row g-3 align-items-center" ng-repeat="item in data_general"
                                     ng-class="{'disabled-link':(!tab_general_active)}">

                                    <!-- department -->
                                    <div class="col-1 p-1">
                                        <label class="form-label ps-0" for="departments">
                                            <b class="text-danger d-none"> * </b>
                                            Departments 
                                        </label>
                                        <select class="form-control js-choice-tagid"
                                                data-choices="data-choices-department"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')" 
                                                ng-model="item.id_department">
                                            <option value="" disabled selected hidden>Please select</option>
                                            <option ng-selected="item.id_department == item.id"
                                                    ng-repeat="item in data_departments" 
                                                    ng-value="item.id">
                                                {{item.name}}
                                            </option>
                                            
                                        </select>
                                    </div>

                                    <!-- Task Type -->
                                    <div class="col-1 p-1">
                                        <label class="form-label ps-0" for="tagid"><b class="text-danger d-none"> * </b>Task Type </label>
                                        <select class="form-control js-choice-tagid"
                                                data-choices="data-choices"
                                                data-options='{"removeItemButton":true,"placeholder":true}'
                                                ng-change="actionChange(item,item.seq,'')" 
                                                ng-model="item.id_request_type">
                                            <option value="" disabled selected hidden>Please select</option>
                                            <option ng-selected="item.id_request_type == item.id"
                                                    ng-repeat="item in data_request_type" 
                                                    ng-value="item.id">
                                                {{item.name}}
                                            </option>
                                        </select>
                                    </div>

                                    <!-- Task Name -->
                                    <div class="col-md-4 p-1">
                                        <label class="form-label ps-0"><b class="text-danger"> * </b>Task Name </label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                               data-bs-placement="top"
                                               data-bs-html="true"></a>
                                        </label>
                                        <input class="form-control rounded-1 ps-1"
                                               ng-class="{'disabled-link':(!tab_general_active)}"
                                               type="text" placeholder="Task Name"
                                               name="pha_request_name"
                                               ng-model="item.pha_request_name"
                                               ng-keyup="filterResultGeneral(item.pha_request_name, 'pha_request_name')">
                                        <ul class="list-group mt-2 w-25" style="position: absolute; z-index: 999" ng-show="showResults">
                                            <li class="list-group-item "
                                                ng-repeat="result in filteredResults | filter:{field:'pha_request_name'}"
                                                ng-click="selectResult(result,item,'pha_request_name')">
                                                {{ result.name }}
                                            </li>
                                        </ul>
                                    </div>

                                    <!-- Input Type -->
                                    <div class="col-auto p-1">

                                        <div class="row g-0 align-items-center">
                                            <div class="col-md-12 p-1">
                                                <label class="form-label ps-0" for="tgs_date"><b class="text-danger"> * </b>Input Type</label>
                                                <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                                    <a class="form-label far fa-comment-alt text-warning cursor-pointer" data-bs-toggle="tooltip"
                                                       data-bs-placement="top" title="Date :  " data-bs-html="true"></a>
                                                </label>

                                                <div class="col-md-12 p-1 ps-1">
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" id="inlineInputTypeForm" type="radio" name="inlineInputType"
                                                               value="option1" ng-model="selectInputTypeForm" ng-click="input_type_excel_show()" />
                                                        <label class="form-check-label" for="inlineInputTypeForm"> Form</label>
                                                    </div>
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" id="inlineInputTypeExcel" type="radio" name="inlineInputType"
                                                               value="option2" ng-model="selectInputTypeForm" ng-click="input_type_excel_show()" />
                                                        <label class="form-check-label" for="inlineInputTypeExcel"> Excel</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-auto p-1">

                                        <!-- upload file -->
                                        @* ii.	ผานการ Upload Excel file 1.	กรอกชื่อ Task และ Unit ก่อน upload *@
                                        <div class="row g-0 align-items-center" ng-if="selectInputTypeForm=='option2'">
                                            <div class="col-md-12 p-1 ng-scope">
                                                <div class=" btn-group position-static" role="group">
                                                    <button class="btn btn-phoenix-danger ps-3  " ng-click="export_template_data()">
                                                        <svg class="svg-inline--fa fa-download me-2" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="download"
                                                             role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                                                            <path fill="currentColor" d="M480 352h-133.5l-45.25 45.25C289.2 409.3 273.1 416 256 416s-33.16-6.656-45.25-18.75L165.5 352H32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h448c17.67 0 32-14.33 32-32v-96C512 366.3 497.7 352 480 352zM432 456c-13.2 0-24-10.8-24-24c0-13.2 10.8-24 24-24s24 10.8 24 24C456 445.2 445.2 456 432 456zM233.4 374.6C239.6 380.9 247.8 384 256 384s16.38-3.125 22.62-9.375l128-128c12.49-12.5 12.49-32.75 0-45.25c-12.5-12.5-32.76-12.5-45.25 0L288 274.8V32c0-17.67-14.33-32-32-32C238.3 0 224 14.33 224 32v242.8L150.6 201.4c-12.49-12.5-32.75-12.5-45.25 0c-12.49 12.5-12.49 32.75 0 45.25L233.4 374.6z">
                                                            </path>
                                                        </svg><span>
                                                            Download Excel Template
                                                        </span>
                                                    </button>
                                                    <div class="btn btn-phoenix ps-3  ">

                                                        <span class="mr-3 nametext text-primary" id="filename-template-{{item.seq}}"
                                                              ng-click="downloadFile(item)">
                                                            <b>{{(item.file_upload_size>0? item.file_upload_name + '('+  item.file_upload_size + 'KB)' : '')}}</b>
                                                        </span>
                                                        <br ng-if="!(item.file_upload_name =='' || item.file_upload_name == null)">
                                                        <label class="dz-message-text text-primary fw-bold cursor-pointer"
                                                               for="uploadfile-{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}">
                                                            <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-3"></i>Upload File(Excel)
                                                        </label>
                                                        <input type="file" id="uploadfile-{{item.seq}}"
                                                               name="uploadfile{{item.seq}}"
                                                               onchange="angular.element(this).scope().fileUploadSelectTemplate(this)"
                                                               style="display:none" />

                                                        <button id="deluploadfile-{{item.seq}}" class="btn btn-link text-danger"
                                                                ng-class="{'d-none':(!tab_general_active)}"
                                                                ng-click="clearFileUploadName(item.seq)"
                                                                ng-if="!(item.file_upload_name =='' || item.file_upload_name == null)">
                                                            <span class="fa-regular fa-trash-can fa-lg"></span>
                                                        </button>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="mx-2 row  gx-0 " ng-repeat="item in data_general"
                                     ng-class="{'disabled-link':(!tab_general_active)}">

                                    <div class="col-5 p-1 d-none">
                                        <label class="form-label ps-0" for="description_general">Study Objective and Work Scope :</label>
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip"
                                                data-bs-placement="top" 
                                                title="Study Objective and Work Scope :  " 
                                                data-bs-html="true">
                                            </a>
                                        </label>
                                        <textarea class="form-control rounded-1" 
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                id="work_scope"
                                                name="work_scope"
                                                placeholder="Study Objective and Work Scope" 
                                                style="height: 100px"
                                                ng-model="item.work_scope">
                                        </textarea>
                                    </div>

                                     <div class="col-5 p-1 mt-4 text-primary" style="border-right: 1px solid #e8e8e8;">
                                        <p>1. จะต้องได้รับใบอนุญาตการทำงานและต้องจัดให้มีการทำ Toolbox talk เพื่อแจ้งให้ผู้ทำงานทุกฝ่ายที่ข้องเกี่ยวกับอันตรายและข้อควรระวังด้านความปลอดภัย ได้รับทราบ</p>
                                        <p>2. ต้องสวมใส่อุปกรณ์ป้องกันภัยส่วนบุคคล เช่น หมวกนิรภัย แว่นตานิรภัย รองเท้านิรภัย ถุงมือ กางเกงขายาว และเสื้อแขนยาว ผ้า cotton 100% อย่างหนา หรือเป็นผ้าทนไฟ</p>
                                        <p>3. สถานที่ปฏิบัติงานต้องได้รับการดูแลให้อยู่ในสภาพที่ปลอดภัยและเป็นระเบียบอยู่เสมอ มีผู้ควบคุมงานอยู่ตลอดเวลา</p>
                                        <p>4. อุปกรณ์ เครื่องมือ หรืออุปกรณ์ที่เกี่ยวข้องกับงานยก ทั้งหมดต้องมั่นใจว่าสภาพดีและมีใบรับรองที่ถูกต้อง</p>
                                     </div>

                                    <div class="col-5 p-1 mt-4">
                                         <div class="form-check form-switch ">
                                            <input class="form-check-input" 
                                                    id="flexSwitchCheckChecked" 
                                                    type="checkbox" 
                                                    ng-model="isChecDescription" 
                                                    ng-change="toggleDescription()"/>

                                             <label class="form-check-label" for="description_general">Description/Remark</label>
                                        </div>
                                       
                                        <label class="form-label ps-0" ng-if="select_history_tracking_record">
                                            <a class="form-label far fa-comment-alt text-warning cursor-pointer" 
                                                data-bs-toggle="tooltip"
                                                data-bs-placement="top" 
                                                title=" Description/Remark :  " 
                                                data-bs-html="true">
                                            </a>
                                        </label>
                                        <textarea class="form-control rounded-1" 
                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                id="description_general" 
                                                name="description_general"
                                                placeholder="Description/Remark" 
                                                style="height: 100px"
                                                ng-model="item.descriptions"
                                                ng-if="isChecDescription">
                                        </textarea>
                                    </div>
                                </div>

                            </div>
                        </div>


                        @* Session Start*@
                        <div class="m-3 row gx-0 align-items-center ">
                            <div class="card px-2">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Session</h5>
                                    </div>
                                </div>
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3 d-none">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>{{ sub_software }} Member</h5>
                                    </div>

                                    <div class="float-end align-top ms-1" ng-class="{'tab-pane fade show active':!(data_header[0].pha_status==11)}">
                                        <div class="float-end pe-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" id="switchEmailToMemberChecked"
                                                       type="checkbox"
                                                       ng-click="flow_mail_to_member_show()" />
                                                <label class="form-check-label" for="switchEmailToMemberChecked">Email Notification to Member Team</label>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-12 col-md mx-1">

                                    <div class="table-responsive scrollbar">

                                        <table class="table mb-0 table-borderless">

                                            <thead class="  text-uppercase text-start border-bottom">
                                                <tr>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">No</th>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">Member team and Relatedpeople {{(data_general[0].expense_type=='CAPEX' && data_general[0].sub_expense_type=='Normal')?' and Approver':''}}</th>

                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2">Session Date Time </th>
                                                    <th class="align-middle text-center" style="font-size: 10px;" rowspan="2"></th>
                                                </tr>
                                            </thead>

                                            <tbody class="" id="customer-rating-table-body">

                                                <tr ng-repeat="item in data_session | orderBy:no" class="">

                                                    <td class="align-top text-top" style="width: 30px;">
                                                        <h6 class="fw-semi-bold text-center pt-1">{{item.no}}</h6>
                                                    </td>

                                                    @* Member Team *@
                                                    <td class="align-top col-auto" style="min-width: 420px;">
                                                        <div class="row d-flex">
                                                            <div class="col-6">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'member')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>
                                                                        Add Member Team/Attendees
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_memberteam ">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">
                                                                               {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-6">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'approver')" 
                                                                            title="ผู้ทบทวนหลัก">
                                                                        <span class="far fa-address-book fa-lg"></span>
                                                                        Add Safety Reviewer
                                                                    </button>

                                                                <div class="row" ng-repeat="item2 in data_approver"> 
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                                style="width:80%;border-color: #f1f2f4;"
                                                                                ng-if=" (item2.approver_type === 'approver')">
                                                                               {{ '(Main)' + item2.user_displayname}}
                                                                        </label>
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                                style="width:80%;border-color: #f1f2f4;"
                                                                                ng-if="!(item2.approver_type === 'safety')">
                                                                                {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            @* <b class="p-0 text-danger"> Note:This JSEA will be approved by AE or AGSI via Safety Permit</b> *@
                                                        </div>

                                                        <div class="row d-flex mt-4">
                                                             <div class="col-6 ">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'specialist')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>
                                                                        Add ผู้เชี่ยวชาญเฉพาะด้าน (ถ้ามี):
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople | filter:{id_session:item.seq, user_type:'specialist'}">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                            {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="row" ng-repeat="item2 in data_relatedpeople_outsider"><!------ | filter:{id_session:item.seq, user_type:'specialist'}----->
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">
                                                                               {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <b class="p-0 text-danger"> Note:This JSEA will be approved by AE or AGSI via Safety Permit</b>
                                                        </div>

                                                        <div class="row d-flex pt-2 d-none" style="background-color:#F8F8F8; zoom:0.8;">
                                                            <div class="col-6  mt-1">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'attendees')" 
                                                                            title=" ผู้จัดทำ">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>
                                                                        Add Attendees:
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople | filter:{id_session:item.seq, user_type:'attendees'}">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">{
                                                                            { item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople_outsider | filter:{id_session:item.seq, user_type:'attendees'}">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">
                                                                            {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="col-6  mt-1 d-none">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'reviewer')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>Add Approver AE or AGSI:
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople | filter:{id_session:item.seq, user_type:'reviewer'}">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">
                                                                               {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                            </div>

                                                            <div class="col-6  mt-1">
                                                                <div class="row" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <button class="btn btn-outline-secondary p-0 cursor-pointer col-auto" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #f1f2f4;"
                                                                            ng-click="openDataEmployeeAdd(item,'specialist')">
                                                                        <span class="far fa-address-book fa-lg pe-1"></span>
                                                                        Add ผู้เชี่ยวชาญเฉพาะด้าน (ถ้ามี):
                                                                    </button>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople | filter:{id_session:item.seq, user_type:'specialist'}">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold" 
                                                                                style="width:80%;border-color: #f1f2f4;">
                                                                            {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="row" ng-repeat="item2 in data_relatedpeople_outsider | filter:{id_session:item.seq, user_type:'specialist'}">
                                                                    <div class="row align-items-center  p-1">
                                                                        <label class="mb-0 text-1100 fw-bold"
                                                                               style="width:80%;border-color: #f1f2f4;">
                                                                               {{ item2.user_displayname}}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </td>

                                                    @* Session Date *@
                                                    <td class="align-top">

                                                        <div class="row g-2" ng-class="{'disabled-link':(!tab_general_active)}">

                                                            <span class="row ms-1 p-0">

                                                                <span class="col-md-4  p-1 ">
                                                                    <label class="form-label d-none" for="meeting_date">Meeting Date</label>

                                                                    <input type="date" class="form-control rounded-1 datetimepicker" id="meeting_date" name="meeting_date"
                                                                           ng-change="actionChange(item,item.seq,'meeting_date')"
                                                                           ng-model="item.meeting_date" placeholder="dd/mm/yyyy">

                                                                </span>

                                                                <span class="col-md-3  p-1 d-flex">
                                                                    <label class="form-label d-none" for="timepicker1">Start Time</label>
                                                                    <label class="form-label d-none" style="font-size: 10px;">{{formatTo24Hour(item.meeting_start_time)}}</label>

                                                                    <input class="form-control  d-none" id="st_meet" name="st_meet"
                                                                           style="width:20px; height: 20px"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_start_time" value="{{formatTo24Hour(item.meeting_start_time)}}"
                                                                           type="time" placeholder="hour : minute" />

                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_start_time_hh"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_hours" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_start_time_mm"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_minutes" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>

                                                                </span>
                                                                <span class="col-md-1 p-1 d-flex">
                                                                    <label class="form-label p-0 pt-2">To</label>
                                                                </span>
                                                                <span class="col-md-3 p-1 d-flex">
                                                                    <label class="form-label d-none" for="timepicker2">End Time</label>
                                                                    <label class="form-label d-none" style="font-size: 10px;">{{formatTo24Hour(item.meeting_end_time)}}</label>
                                                                    <input class="form-control  d-none" id="et_meet" name="et_meet"
                                                                           ng-change="actionChange(item,item.seq,'')"
                                                                           ng-model="item.meeting_end_time"
                                                                           type="time" placeholder="hour : minute" />

                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_end_time_hh"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_hours" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                    <select class="form-select rounded-1  me-1 p-1" ng-model="item.meeting_end_time_mm"
                                                                            style="width:60px" ng-change="actionChange(item,item.seq,'')">
                                                                        <option ng-repeat="item2 in master_minutes" ng-value="item2.id">
                                                                            {{item2.name}}
                                                                        </option>
                                                                    </select>
                                                                </span>

                                                            </span>

                                                        </div>
                                                    </td>

                                                    @* Buton Action *@
                                                    <td class="align-top " style="width: 158px;" ng-class="{'d-none': (!tab_general_active)}">

                                                        <div class="col-12" style="width: 158px;">
                                                            <div class="float-end">
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Remove"
                                                                            ng-click=removeDataSession(item.seq,$index)>
                                                                        <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #2445fc; background-color: #f1f2f4; border-color: #2445fc;"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy"
                                                                            ng-click=copyDataSession(item.seq,$index)>
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1 d-none">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #1336fc; background-color: #f1f2f4; border-color: #a8a8a8;"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy"
                                                                            ng-click=copyDataSession(item.seq,$index)>
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Add"
                                                                            ng-click=addDataSession(item.seq,$index)>
                                                                        <span class="fas fa-square-plus fa-lg"></span>
                                                                    </button>
                                                                </span>

                                                            </div>
                                                        </div>
                                                    </td>

                                                </tr>


                                            </tbody>

                                        </table>

                                    </div>

                                </div>
                            </div>

                        </div>
                        @* Session End*@


                        @* Drawing *@
                        <div class="m-3 row  gx-0 align-items-center">
                            <div class="card px-2">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Document & Reference</h5>
                                    </div>
                                </div>
                                <div class="col-12 col-md mx-1">

                                    <div class="table-responsive scrollbar">

                                        <table class="table fs--1 mb-0 table-borderless">
                                            <thead class=" text-uppercase border-bottom">
                                                <tr>
                                                    <th class="align-middle text-center" scope="col" style="font-size: 10px;">No</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;">Document Name</th>
                                                    <th class="align-middle d-none" scope="col" style="font-size: 10px;"><b class="text-danger"> * </b>Drawing No</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;"><b class="text-danger"> * </b>Document File</th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;">Comment </th>
                                                    <th class="align-middle" scope="col" style="font-size: 10px;"> </th>

                                                </tr>
                                            </thead>

                                            <tbody class="list" id="customer-rating-table-body ">
                                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                                    ng-repeat="item in data_drawing">
                                                    <td class="align-middle text-center">
                                                        <div class="p-1 ">
                                                            <h6 class="fw-semi-bold">{{item.no}}</h6>
                                                        </div>
                                                    </td>

                                                    <td class="align-middle white-space-nowrap ">
                                                        <textarea ng-keyup="actionChange(item,item.seq,'')" 
                                                                ng-model="item.document_name"
                                                                class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                                placeholder="Document Name"
                                                                style="font-size: 10px;">
                                                        </textarea>
                                                    </td>

                                                    <td class="align-middle white-space-nowrap d-none">
                                                        <textarea ng-keyup="actionChange(item,item.seq,'')" 
                                                                ng-model="item.document_no"
                                                                class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                ng-class="{'disabled-link':(!tab_general_active)}"
                                                                placeholder="Drawing No"
                                                                style="font-size: 10px;">
                                                        </textarea>
                                                    </td>

                                                    <td class="align-middle col-3">
                                                        <div class="d-flex align-items-center d-none ">
                                                            <input type="file" 
                                                                id="file-upload-1" 
                                                                ng-click="showFileName(1)" 
                                                                hidden />
                                                            <span id="fileNameDisplay-1"></span>
                                                            <button id="del1"
                                                                    class="btn btn-sm transition-none btn-reveal fs--2 p-1"
                                                                    ng-class="{'disabled-link':(!tab_general_active)}"
                                                                    style="display: none;"
                                                                    ng-click="clearFileName(item.seq)">
                                                                <a class="text-decoration-none text-danger">
                                                                    <span class="fas fa-times"></span>
                                                                </a>
                                                            </button>
                                                        </div>
                                                        <div class="row uploadbox align-items-center cursor-pointer" ng-if="tab_general_active">
                                                            <div class=" align-items-center p-1 cursor-pointer ">
                                                                <span class="mr-3 nametext text-primary"
                                                                      id="filename{{item.seq}}" 
                                                                      ng-class="{'d-none':(!tab_general_active)}"
                                                                      ng-click="downloadFile(item)"
                                                                      ng-if="item.document_file_size>0">
                                                                    <b style="font-size:x-small;">{{(item.document_file_size>0? item.document_file_name + '('+  item.document_file_size + 'KB)' : '')}}</b>
                                                                </span>
                                                                <br ng-if="item.document_file_size>0">
                                                                <label class="dz-message-text text-primary fw-bold cursor-pointer"
                                                                       for="attfile-{{item.seq}}" ng-class="{'d-none':(!tab_general_active)}">
                                                                    <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-3"></i>Upload File(Word, Excel, PDF, Image)
                                                                </label>
                                                                <input type="file" id="attfile-{{item.seq}}"
                                                                       name="file{{item.seq}}"
                                                                       onchange="angular.element(this).scope().fileSelect(this,'drawing')"
                                                                       style="display:none" />
                                                                <button id="del-{{item.seq}}" class="btn btn-link text-danger"
                                                                        ng-class="{'d-none':(!tab_general_active)}"
                                                                        ng-click="clearFileName(item.seq)"
                                                                        ng-if="item.document_file_size>0">
                                                                    <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                </button>
                                                                <br>
                                                                <a class="nametext ms-3 filename-text me-2"
                                                                   ng-class="{'d-none':(tab_general_active)}"
                                                                   ng-click="downloadFile(item)">
                                                                    <i class="far fa-file-pdf text-danger"></i> 
                                                                    {{(item.document_file_size>0? item.document_file_name + '('+  item.document_file_size + 'KB)' : '')}}
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class=" align-items-center p-1 cursor-pointer " ng-if="!tab_general_active">
                                                            <a class="nametext ms-3 filename-text me-2"
                                                               ng-class="{'d-none':(tab_general_active)}"
                                                               ng-click="downloadFile(item)">
                                                                <i class="far fa-file-pdf text-danger"></i> 
                                                                {{(item.document_file_size>0? item.document_file_name + '('+  item.document_file_size + 'KB)' : '')}}
                                                            </a>
                                                        </div>
                                                        <div id="drawing-document-file-{{item.seq}}"
                                                             class="invalid-feedback text-danger">
                                                            Please provide a valid Drawing.(Max size 10mb)
                                                        </div>
                                                    </td>

                                                    <td class="align-middle ">
                                                        <div class="col-12">
                                                            <textarea class="form-control form-control-sm  rounded-1 shadow-sm  bg-body-tertiary"
                                                                      ng-class="{'disabled-link':(!tab_general_active)}"
                                                                      ng-keyup="actionChange(item,item.seq,'')"
                                                                      ng-model="item.descriptions"
                                                                      placeholder="Comment"
                                                                      style="font-size: 10px;">
                                                            </textarea>
                                                        </div>
                                                    </td>

                                                    <td class="align-middle " style="width: 158px;" ng-class="{'d-none': (!tab_general_active)}">
                                                        <div class="col-12" style="width: 158px;">
                                                            <div class="float-end ">
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #ff2828; background-color: #f1f2f4; border-color: #ff2828;"
                                                                            ng-click=removeDrawingDoc(item.seq,$index-1)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Remove">
                                                                        <span class="fa-regular fa-trash-can fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1 d-none">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #1336fc; background-color: #f1f2f4; border-color: #a8a8a8;"
                                                                            ng-click=copyDrawingDoc(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Copy">
                                                                        <span class="fas fa-copy fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                                <span class="mx-1">
                                                                    <button class="btn btn-outline-secondary p-2" 
                                                                            style="color: #0abe0a; background-color: #f1f2f4; border-color: #0abe0a;"
                                                                            ng-click=addDrawingDoc(item.seq,$index)
                                                                            data-toggle="tooltip" 
                                                                            data-placement="top" 
                                                                            title="Add">
                                                                        <span class="fas fa-square-plus fa-lg"></span>
                                                                    </button>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- general information end-->
                    <!-- RAM start-->
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==2),'tab-pane fade':(action_part!==2)}"
                         id="tab-ram" role="tabpanel" aria-labelledby="ram-tab">

                        <div class="m-3 row  gx-0 align-items-center">

                            <div class="card px-2 pb-2" style="height: 100vh;">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-10">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span><b class="text-danger"> * </b> Risk Assessment Matrix 5X5</h5>
                                    </div>
                                     <div class="col-2">
                                        <span class="mx-1 d-flex" style="float:right;">
                                            <a class="m-1 text-info cursor-pointer"
                                               href="{{y.document_definition_file_path}}" target="_blank"
                                               ng-repeat="y in master_ram | filter:{id: data_general[0].id_ram}">Definition Consequence Rating<span class="fas fa-file-pdf fa-lg ms-1"></span></a>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md mx-1 pb-2  ">
                                    @* <div class="row ">
                                        <div class="d-flex flex-wrap">
                                            <div class="col-md-2 col-lg-1" ng-repeat="item in data_general">
                                                <select id="ddl-ram" 
                                                        class="form-control form-control-sm" 
                                                        ng-class="{'disabled-link':(!tab_general_active)}"
                                                        ng-change="actionChange(item,item.seq,'ChangeRAM')" 
                                                        ng-model="item.id_ram"
                                                        disabled>
                                                    <option ng-selected="item.id_ram == item2.id"
                                                            ng-repeat="item2 in master_ram" 
                                                            ng-value="item2.id">
                                                        {{ item2.name }}
                                                    </option>
                                                </select>
                                            </div>

                                            <div class="col-md-10 col-lg-11" ng-if="(!tab_general_active)">
                                                <h5 class="text-900 mb-0">
                                                    <a ng-click="openModalNewRAM()" style="font-size:10px;"
                                                       class="text-decoration-none cursor-pointer ps-3">
                                                        <span class="fas fa-edit"></span>Add Risk Assessment Matrix Type
                                                    </a>
                                                </h5>
                                            </div>
                                        </div>
                                    </div> *@

                                    <div class="row ps-2 mt-2">
                                        <div class="col-12 mt-4"
                                             ng-repeat="itemRam in master_ram | filter:{id: data_general[0].id_ram}">
                                                  <div class="row">
                                                    <div class="col-12 d-flex justify-content-center">
                                                        <div class="row" style="background-color : #F8F8F8 ; width:75%;">
                                                            <img src="{{itemRam.document_file_path}}" class="cursor-pointer" />
                                                        </div>
                                                    </div>
                                                </div>
                                            @* <div class="row">
                                                <div class="col-12">
                                                    <div class="p-0 cursor-pointer " ng-class="{'d-none':(!tab_node_active)}">

                                                        <div ng-if="!((select_rows_level==4 && select_columns_level==4) || (select_rows_level==5 && select_columns_level==5))">
                                                            <br>
                                                            <label class="dz-message-text text-primary fw-bold"
                                                                   for="attfile-ram-{{itemRam.seq}}">
                                                                <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-3"></i>Upload (image File)
                                                            </label>
                                                            <input type="file" id="attfile-ram-{{itemRam.seq}}"
                                                                   name="file_ram_{{itemRam.seq}}"
                                                                   onchange="angular.element(this).scope().fileSelectRAM(this)"
                                                                   style="display: none;" />

                                                            <span class="mr-3 dz-message-text text-primary fw-bold" id="filename_ram_{{itemRam.seq}}">
                                                                RAM File Name : {{(itemRam.document_file_size>0? itemRam.document_file_name + '('+  itemRam.document_file_size + 'KB)' :itemRam.document_file_name )}}
                                                            </span>

                                                            <button id="del-ram-{{itemRam.seq}}" class="btn btn-link text-danger"
                                                                    ng-click="clearFileNameRAM(itemRam.seq)">
                                                                <span class="fa-regular fa-trash-can fa-lg"></span>
                                                            </button>
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-12 d-flex justify-content-center">
                                                        <div class="row" style="background-color : #F8F8F8 ; width:75%;">
                                                            <img src="{{itemRam.document_file_path}}" class="cursor-pointer" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> *@
                                        </div>

                                        <div class="col-6 mt-4" style="background-color : #F8F8F8;  height:350px;"
                                             ng-if="!((select_rows_level==4 && select_columns_level==4) || (select_rows_level==5 && select_columns_level==5))">

                                            <table class="table table-sm fs--1 mb-0">
                                                <thead class="">
                                                    <tr>
                                                        <th rowspan="2" colspan="1" class="text-center">ระดับความรุนแรง (Security)</th>
                                                        <th rowspan="1" colspan="{{select_columns_level}}" class="text-center">โอกาสในการเกิดความเสี่ยง (Likelihood)</th>
                                                    </tr>
                                                    <tr ng-repeat="item_ram in master_ram_level  | filter:{rows_level : select_rows_level,columns_level: select_columns_level}"
                                                        ng-if="$index == 0">
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood1_text}}</th>
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood2_text}}</th>
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood3_text}}</th>
                                                        <th rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood4_text}}</th>
                                                        <th ng-if="select_columns_level >= 5" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood5_text}}</th>
                                                        <th ng-if="select_columns_level >= 6" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood6_text}}</th>
                                                        <th ng-if="select_columns_level >= 7" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood7_text}}</th>
                                                        <th ng-if="select_columns_level >= 8" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood8_text}}</th>
                                                        <th ng-if="select_columns_level >= 9" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood9_text}}</th>
                                                        <th ng-if="select_columns_level >= 10" rowspan="1" colspan="1" class="text-center">{{item_ram.likelihood10_text}}</th>
                                                    </tr>
                                                </thead>
                                                <tbody class=" list">
                                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                                        ng-repeat="item_ram in master_ram_level  | filter:{rows_level : select_rows_level,columns_level: select_columns_level}">
                                                        <td class="align-top text-center" style="width:150px;">{{item_ram.security_level}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram1_color}">{{item_ram.ram1_text}}<br />{{item_ram.ram1_priority}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram2_color}">{{item_ram.ram2_text}}<br />{{item_ram.ram2_priority}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram3_color}">{{item_ram.ram3_text}}<br />{{item_ram.ram3_priority}}</td>
                                                        <td class="align-top text-center" ng-style=" { 'background-color' : item_ram.ram4_color}">{{item_ram.ram4_text}}<br />{{item_ram.ram4_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 5" ng-style=" { 'background-color' : item_ram.ram5_color}">{{item_ram.ram5_text}}<br />{{item_ram.ram5_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 6" ng-style=" { 'background-color' : item_ram.ram6_color}">{{item_ram.ram6_text}}<br />{{item_ram.ram6_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 7" ng-style=" { 'background-color' : item_ram.ram7_color}">{{item_ram.ram7_text}}<br />{{item_ram.ram7_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 8" ng-style=" { 'background-color' : item_ram.ram8_color}">{{item_ram.ram8_text}}<br />{{item_ram.ram8_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 9" ng-style=" { 'background-color' : item_ram.ram9_color}">{{item_ram.ram9_text}}<br />{{item_ram.ram9_priority}}</td>
                                                        <td class="align-top text-center" ng-if="select_columns_level >= 10" ng-style=" { 'background-color' : item_ram.ram10_color}">{{item_ram.ram10_text}}<br />{{item_ram.ram10_priority}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card px-2 mt-2 pb-2" ng-if="!((select_rows_level==4 && select_columns_level==4) || (select_rows_level==5 && select_columns_level==5))">
                                <div class="row g-3 justify-content-between align-items-center pt-2 pb-3">
                                    <div class="col-12 col-md">
                                        <h5 class="text-900 mb-0"> <span class=" me-2 text-primary"><B>|</B></span>Set Risk Assessment Matrix</h5>
                                    </div>
                                </div>
                                <div class="col-12 col-md mx-1">
                                    <div class="row">

                                        <div class="col-12">

                                            <div class="mt-2 table-responsive scrollbar">
                                                @*    1. select format : 6x6, 7x7
                                                2. genarate table
                                                3. maintain S & L => Risk
                                                4. Attached RAM file *@
                                                <table class="table table-sm fs--1 mb-0">
                                                    <thead class="">
                                                        <tr>
                                                            <th rowspan="2" colspan="1" class="text-center">ระดับความรุนแรง (Security)</th>
                                                            <th rowspan="1" colspan="{{select_columns_level}}" class="text-center">โอกาสในการเกิดความเสี่ยง (Likelihood)</th>
                                                        </tr>
                                                        <tr ng-repeat="item_ram in master_ram_level | filter:{rows_level : select_rows_level,columns_level: select_columns_level}" ng-if="$index == 0">
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood1_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood1_desc" placeholder="Description">
                                                            </th>
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood2_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood2_desc" placeholder="Description">
                                                            </th>
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood3_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood3_desc" placeholder="Description">
                                                            </th>
                                                            <th rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood4_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood4_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 5 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood5_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood5_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 6 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood6_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood6_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 7 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood7_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood7_desc" placeholder="Description">
                                                            </th>
                                                            <th ng-if="select_columns_level >= 8 " rowspan="1" colspan="1" class="text-center">
                                                                <input class="form-control text-center" type="text" ng-model="item_ram.likelihood8_text" placeholder="Likelihood">
                                                                <input class="form-control mt-1" type="text" ng-model="item_ram.likelihood8_desc" placeholder="Description">
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class=" list">
                                                        <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                                            ng-repeat="item_ram in master_ram_level  | filter:{rows_level : select_rows_level,columns_level: select_columns_level}">
                                                            <td class="align-middle text-center" style="width:150px;">
                                                                <b>{{item_ram.security_level}}</b>
                                                            </td>
                                                            
                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram1_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram1_priority"
                                                                        placeholder="Priority">
                                                                    <option ng-selected="item_ram.ram1_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>

                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram1_color"
                                                                                style="{'background-color': item_ram.ram1_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram1_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood1_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood1_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>

                                                            </td>

                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram2_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram2_priority">
                                                                    <option ng-selected="item.ram2_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram2_color"
                                                                                style="{'background-color': item_ram.ram2_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram2_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood2_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood2_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>

                                                            </td>

                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram3_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram3_priority">
                                                                    <option ng-selected="item.ram3_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>

                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram3_color"
                                                                                style="{'background-color': item_ram.ram3_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram3_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood3_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood3_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>

                                                            </td>

                                                            <td class="align-top text-center">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram4_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram4_priority">
                                                                    <option ng-selected="item.ram4_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram4_color"
                                                                                style="{'background-color': item_ram.ram4_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram4_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood4_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood4_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 5 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram5_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram5_priority">
                                                                    <option ng-selected="item.ram5_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram5_color"
                                                                                style="{'background-color': item_ram.ram5_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram5_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood5_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood5_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 6 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram6_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram6_priority">
                                                                    <option ng-selected="item.ram6_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>



                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram6_color"
                                                                                style="{'background-color': item_ram.ram6_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram6_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood6_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood6_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 7 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram7_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram7_priority">
                                                                    <option ng-selected="item.ram7_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram7_color"
                                                                                style="{'background-color': item_ram.ram7_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram7_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood7_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood7_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 8 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram8_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram8_priority">
                                                                    <option ng-selected="item.ram8_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram8_color"
                                                                                style="{'background-color': item_ram.ram8_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram8_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood8_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood8_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 9 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram9_text" placeholder="RAM">


                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram9_priority">
                                                                    <option ng-selected="item.ram9_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram9_color"
                                                                                style="{'background-color': item_ram.ram9_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram9_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood9_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood9_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                            <td class="align-top text-center" ng-if="select_columns_level >= 10 ">
                                                                <input class="form-control " type="text" ng-model="item_ram.ram10_text" placeholder="RAM">

                                                                <select id="ddl-ram-color" class="form-control mt-1" ng-model="item_ram.ram10_priority">
                                                                    <option ng-selected="item.ram10_priority == itemPriority.name"
                                                                            ng-repeat="itemPriority in master_ram_priority" ng-value="itemPriority.name">
                                                                        {{itemPriority.name}}
                                                                    </option>
                                                                </select>


                                                                <div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px">   Color :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.ram10_color"
                                                                                style="{'background-color': item_ram.ram10_color };" placeholder="Color">
                                                                            <option ng-selected="item_ram.ram10_color == itemColor.name"
                                                                                    ng-repeat="itemColor in master_ram_color" ng-value="itemColor.name">
                                                                                {{itemColor.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="d-flex align-items-center">
                                                                        <label class="form-label" style=" width:100px"> Criteria <br />SCE :      </label>
                                                                        <select id="ddl-ram-color" class="form-control form-control-sm mt-1" ng-model="item_ram.likelihood10_criterion"
                                                                                placeholder="Criterion SCE">
                                                                            <option ng-selected="item_ram.likelihood10_criterion == itemCriterion.name"
                                                                                    ng-repeat="itemCriterion in master_ram_criterion" ng-value="itemCriterion.name">
                                                                                {{itemCriterion.name}}
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </td>

                                                        </tr>
                                                    </tbody>
                                                </table>

                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>



                    </div>
                    <!-- RAM end-->
                    <!-- JSEA Worksheet -->
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==3),'tab-pane fade':(action_part!==3)}"
                         id="tab-worksheet" role="tabpanel" aria-labelledby="worksheet-tab">

                        <div style="background-color: #ffffff;">
                            <div class="mx-3 row  g-3 align-items-top mb-4">
                                <div class="col-md-7">
                                    <div class="col-md-12">
                                        <div class="row">
                                            <div class=" col-auto pe-0 me-0">
                                                <p class="form-label m-2 ps-0" style="min-width:200px;"><b>Task Name: </b>{{data_general[0].pha_request_name}}</p>
                                            </div>
                                            <div class="d-flex col-auto p-0 m-0 ps-1">
                                                <p class="form-label m-2 ps-0" ng-if="tab_worksheet_active"><b>Date:</b></p>
                                                <input type="date" class="form-control rounded-1  p-1 datetimepicker"
                                                       id="target_start_date"
                                                       name="target_start_date"
                                                       ng-change="actionChange(data_general[0],data_general[0].seq,'')"
                                                       ng-model="data_general[0].target_start_date" placeholder="dd/mm/yyyy" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-5">
                                    <div class="col-12 float-end align-top text-end ">
                                        <!-- ส่วนที่มีอยู่แล้ว -->
                                        <div class=" align-top text-end">
                                            <button class="float-end btn btn-outline btn-sm p-1 m-1" ng-click="toggleFullscreen()">
                                                <i class="fas fa-expand" style="color: #a1a1a6"></i>
                                            </button>
                                        </div>

                                        <div class=" align-top text-end mt-0" style="zoom:0.7;">
                                            <p class="form-label m-1 align-bottom text-end">
                                                <svg class="svg-inline--fa fa-lightbulb text-warning" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="lightbulb" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"></path></svg><!-- <span class="fas fa-lightbulb text-warning"></span> Font Awesome fontawesome.com -->
                                                P=People/ E=Environment/ R=Reputation/ A=Asset
                                            </p>
                                            <p class="form-label m-1 align-bottom text-end">
                                                <svg class="svg-inline--fa fa-lightbulb text-warning" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="lightbulb" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"></path></svg><!-- <span class="fas fa-lightbulb text-warning"></span> Font Awesome fontawesome.com -->
                                                S = Severity Level / L = Likely hood / IR =
                                                Initial Risk / RR = Residual Risk
                                            </p>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="border-bottom" id="fullscreenzone" style="background-color: #ffffff;">
                                <div class="table-responsive scrollbar tableFixHead" style="min-height:400px">
                                    <table class="table fs--2 mb-0 table-bordered" cellpadding="0" cellspacing="0">
                                        <thead class="text-uppercase  text-center py-8 bg-soft" style="font-size: 10px;" id="myHeader">
                                            <tr class="">
                                                <th class="align-middle mx-0" colspan="1" rowspan="2" style="padding: 0 !important; width: 8%;"
                                                    data-tooltip="ลำดับขั้นตอนหลัก" data-bs-placement="top" data-bs-toggle="tooltip">ลำดับขั้นตอนหลัก<br />(Work step)</th>
                                                <th class=" align-middle   mx-0" colspan="1" rowspan="2" style="padding: 0 !important; width: 8%;"
                                                    data-tooltip="ลักษณะ/กิจกรรมการทำงาน">ลักษณะ/กิจกรรมการทำงาน<br />(Task description)</th>
                                                <th class=" align-middle   mx-0" colspan="1" rowspan="2" style="padding: 0 !important; width: 22%;"
                                                    data-tooltip="อันตรายที่อาจเกิดขึ้น และอาจเกิดผลกระทบต่อ คน สิ่งแวดล้อม ชื่อเสียง หรือทรัพย์สิน">อันตรายที่อาจเกิดขึ้น และอาจเกิดผลกระทบต่อ คน สิ่งแวดล้อม ชื่อเสียง หรือทรัพย์สิน<br />(Potential Hazard and Consequence to PERA)</th>
                                                <th class=" align-middle   mx-0" colspan="1" rowspan="2" style="padding: 0 !important; width: 22%;"
                                                    data-tooltip="อะไรคือสาเหตุที่ทำให้อันตราย อาจก่อให้เกิดผลกระทบต่อ คน สิ่งแวดล้อม ชื่อเสียง หรือทรัพย์สิน เช่นอาจเกิดจาก คน อุปกรณ์ วิธีการ หรือสภาพแวดล้อม เป็นต้น">
                                                    อะไรคือสาเหตุที่ทำให้อันตราย อาจก่อให้เกิดผลกระทบต่อ คน สิ่งแวดล้อม ชื่อเสียง หรือทรัพย์สิน เช่นอาจเกิดจาก คน อุปกรณ์ วิธีการ หรือสภาพแวดล้อม เป็นต้น<br />(Possible cause to release <br> the hazard and produce an incident)
                                                </th>
                                                @* <th class=" align-middle   mx-0" colspan="1" rowspan="2" style="padding: 0 !important;"
                                                    ng-if="select_columns_level != '4' ">CAT<br>(P/A/E/R/Q) </th> *@
                                                <th class=" align-middle   mx-0" colspan="2" rowspan="1" style="padding: 0 !important; width: 5%;">Initial<br>risk</th>
                                                <th class=" align-middle   mx-0" colspan="1" rowspan="2" style="padding: 0 !important; width: 22%;"
                                                    data-tooltip="ข้อปฏิบัติเพื่อลดผลกระทบจากอันตรายที่อาจเกิดขึ้น">ข้อปฏิบัติเพื่อลดผลกระทบจากอันตรายที่อาจเกิดขึ้น<br />(Recommendations)</th>
                                                <th class=" align-middle   mx-0" colspan="1" rowspan="2" style="padding: 0 !important; width: 8%;"
                                                    data-tooltip="ผู้รับผิดชอบ">ผู้รับผิดชอบ<br />(Action by)</th>
                                                <th class=" align-middle   mx-0" colspan="3" rowspan="1" style="padding: 0 !important; width: 5%;">Residual<br>risk</th>
                                            </tr>
                                            <tr>
                                                @* <th class=" align-middle  mx-0" style="padding: 0 !important;">S</th> *@
                                                <th class=" align-middle  mx-0" style="padding: 0 !important;">S/L</th>
                                                <th class=" align-middle  mx-0" style="padding: 0 !important;">IR</th>
                                                @* <th class=" align-middle  mx-0" style="padding: 0 !important;">S</th> *@
                                                <th class=" align-middle  mx-0" style="padding: 0 !important;">S/L</th>
                                                <th class=" align-middle  mx-0" style="padding: 0 !important;">RR</th>
                                            </tr>
                                        </thead>


                                        <tbody class="">
                                            <tr class="rowwork border border-dashed"
                                                ng-repeat="item in data_listworksheet | orderBy:'no'">

                                                @* workstep *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "style="padding: 0 !important; width: 200px; max-width:300px;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='workstep' ">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.workstep_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none': !(tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success" ng-click="adddata_listworksheet_lv1('workstep',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.workstep_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger"
                                                                       ng-if="!(item.workstep_no == 1)"
                                                                       ng-click="removeDataworksheet('workstep',item,$index)">
                                                                        <span class="fas fa-times-circle"></span>
                                                                        Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 100vh; font-size: 10px;"
                                                                      id="workstep_worksheet_{{item.seq}}" 
                                                                      name="workstep_worksheet_{{item.seq}}"
                                                                      placeholder="Work Step" 
                                                                      rows="3"
                                                                      ng-model="item.workstep"
                                                                      ng-keyup="filterResultHistory(item.workstep, 'workstep', 'workstep_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'');
                                                                                (contentModified && item.workstep.trim() !== '') ? updateWorksheetChanges(item, item.seq, '') : null"
                                                                      ng-mouseenter="showTooltip = true" 
                                                                      ng-mouseleave="showTooltip = false">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('workstep_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('workstep_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | filter:{field:'workstep'}"
                                                                     ng-click="selectResult(result,item,'workstep')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        @*mock track change text tooltip  ///// && item.WorksheetChanges && item.WorksheetChanges.length > 0*@
                                                        <div class="ms-2 mt-1 pe-auto ps-2" style="cursor: pointer;" ng-show="showHistory"
                                                             data-tooltip-location="right"
                                                             data-tooltip="This is the tooltip content ">
                                                            <span class="fa-regular fa-lightbulb fa-lg"></span>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* taskdesc *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important; width: 200px; max-width:300px;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='workstep' || item.row_type =='taskdesc'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.workstep_no +'.'+item.taskdesc_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('taskdesc',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.taskdesc_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger"
                                                                       ng-if="!(item.taskdesc_no == 1)"
                                                                       ng-click="removeDataworksheet('taskdesc',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 200px; font-size: 10px;"
                                                                      id="taskdesc_worksheet_{{item.seq}}" 
                                                                      name="taskdesc_worksheet_{{item.seq}}"
                                                                      placeholder="taskdesc" 
                                                                      rows="3"
                                                                      ng-model="item.taskdesc"
                                                                      ng-keyup="filterResultHistory(item.taskdesc, 'taskdesc', 'taskdesc_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('taskdesc_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('taskdesc_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | filter:{field:'taskdesc'}"
                                                                     ng-click="selectResult(result,item,'taskdesc')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="ms-2 mt-1 pe-auto ps-2" style="cursor: pointer;" ng-show="showHistory"
                                                             data-tooltip-location="right"
                                                             data-tooltip="This is the tooltip content ">
                                                            <span class="fa-regular fa-lightbulb fa-lg"></span>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* potentailhazard *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important; width: 200px; max-width:300px;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='workstep' || item.row_type =='taskdesc' || item.row_type =='potentailhazard'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.workstep_no  + '.'+item.taskdesc_no + '.'+item.potentailhazard_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('potentailhazard',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.potentailhazard_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger"
                                                                       ng-if="!(item.potentailhazard_no == 1)"
                                                                       ng-click="removeDataworksheet('potentailhazard',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 200px; font-size: 10px;"
                                                                      id="potentailhazard_worksheet_{{item.seq}}" 
                                                                      name="potentailhazard_worksheet_{{item.seq}}"
                                                                      placeholder="potentailhazard" 
                                                                      rows="3"
                                                                      ng-model="item.potentailhazard"
                                                                      ng-keyup="filterResultHistory(item.potentailhazard, 'potentailhazard', 'potentailhazard_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('potentailhazard_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('potentailhazard_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | filter:{field:'potentailhazard'}"
                                                                     ng-click="selectResult(result,item,'potentailhazard')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="ms-2 mt-1 pe-auto ps-2" 
                                                            style="cursor: pointer;" 
                                                            ng-show="showHistory"
                                                            data-tooltip-location="right"
                                                            data-tooltip="This is the tooltip content ">
                                                            <span class="fa-regular fa-lightbulb fa-lg"></span>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* possiblecase *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 " style="padding: 0 !important; width: 200px; max-width:300px;">
                                                    <div class="d-flex align-items-top w-100" ng-if="item.row_type =='workstep' || item.row_type =='taskdesc' || item.row_type =='potentailhazard' || item.row_type =='possiblecase'">
                                                        <div>
                                                            <p class="p-0 m-0 me-1 text-end">{{item.workstep_no  + '.'+item.taskdesc_no + '.'+item.potentailhazard_no + '.' + item.possiblecase_no +'.'}}</p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1"
                                                                        type="button" 
                                                                        data-bs-toggle="dropdown" 
                                                                        data-boundary="window" 
                                                                        aria-haspopup="true"
                                                                        aria-expanded="false" 
                                                                        data-bs-reference="parent"
                                                                        data-toggle="tooltip" 
                                                                        data-placement="top" 
                                                                        title="Options">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('possiblecase',item,$index)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.possiblecase_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger"
                                                                       ng-if="!(item.possiblecase_no == 1)"
                                                                       ng-click="removeDataworksheet('possiblecase',item,$index)">
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" width: 200px; font-size: 10px;"
                                                                      id="possiblecase_worksheet_{{item.seq}}" 
                                                                      name="possiblecase_worksheet_{{item.seq}}"
                                                                      placeholder="possiblecase" 
                                                                      rows="3"
                                                                      ng-model="item.possiblecase"
                                                                      ng-keyup="filterResultHistory(item.possiblecase, 'possiblecase', 'possiblecase_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')">
                                                            </textarea>
                                                            <div class="autocomplete-dropdown" style="position: absolute;"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('possiblecase_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('possiblecase_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | filter:{field:'possiblecase'}"
                                                                     ng-click="selectResult(result,item,'possiblecase')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="ms-2 mt-1 pe-auto ps-2" style="cursor: pointer;" ng-show="showHistory"
                                                             data-tooltip-location="right"
                                                             data-tooltip="This is the tooltip content ">
                                                            <span class="fa-regular fa-lightbulb fa-lg"></span>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* cat *@
                                                @* <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 70px;" ng-if="select_columns_level != '4' ">

                                                    <div class="d-flex align-items-top px-0" style="width: 70px;">

                                                        <div class="align-top font-sans-serif btn-reveal-trigger position-static pt-1 mx-0 px-0" style="width: 20px;">
                                                            <p class="p-0 m-0 me-1 text-end text-danger">
                                                                {{item.index_rows}}
                                                            </p>
                                                            <div class="" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1 mx-1 border border-end-0 border-top-0 text-center"
                                                                        type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true"
                                                                        aria-expanded="false" data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info align-top"></span>
                                                                </button>

                                                                <div class="dropdown-menu dropdown-menu-end py-2 align-top">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click="adddata_listworksheet_lv1('category',item)">
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider " ng-if="!(item.category_no == 1)"></div>
                                                                    <a class="dropdown-item text-danger"
                                                                       ng-if="!(item.category_no == 1)"
                                                                       ng-click="removeDataworksheet('category',item,$index)"><span class="fas fa-times-circle"></span> Remove</a>
                                                                </div>

                                                            </div>

                                                        </div>
                                                        <select class="form-select rounded-1 mx-1 p-1  border-start-0  border-end-0 border-top-0 "
                                                                ng-class="{'disabled-link':(!tab_worksheet_active)}"
                                                                ng-change="actionChangeWorksheet(item,item.seq,'')" ng-model="item.category_type">
                                                            <option ng-selected="item.category_type == item2.id"
                                                                    ng-repeat="item2 in DataCategory" ng-value="item2.id">
                                                                {{item2.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </td> *@

                                                @* <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;"
                                                         ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'s',item.seq,'befor')">
                                                            <div class="d-flex"><h6 class="me-1">{{item.ram_befor_security}}</h6> <span class="fas fa-pencil-alt fa-sm" style=" width: 8px;"></span> </div>
                                                        </button>
                                                    </div>
                                                </td> *@

                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;"
                                                         ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" 
                                                                ng-click="openModalDataRAM_Worksheet(item,'l',item.seq,'befor')">
                                                            <div class="d-flex">
                                                                <h6 class="me-1"  style="font-size: 10px !important;">
                                                                    {{item.ram_befor_security}} 
                                                                    <span ng-if="item.ram_befor_security && item.ram_befor_likelihood">/</span> 
                                                                    {{item.ram_befor_likelihood}}
                                                                </h6> 
                                                                <span class="fas fa-pencil-alt fa-sm" style=" width: 8px;"></span> 
                                                            </div>
                                                        </button>
                                                    </div>
                                                </td>

                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 25px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 25px;">
                                                        <button ng-style=" { 'background-color' : ((item.ram_befor_risk == 'H') ? 'red' : ((item.ram_befor_risk == 'M') ? 'yellow' : ((item.ram_befor_risk == 'L') ? 'green' : '#D3D3D3')) ) }"
                                                                class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" 
                                                                ng-click="openModalDataRAM_Worksheet(item,'r',item.seq,'befor')" 
                                                                style="width: 25px;">
                                                            <div class="text-center" style=" width: 25px;">
                                                                <h6 class="me-1 text-center" style=" width: 25px;">{{item.ram_befor_risk}}</h6>
                                                            </div>
                                                        </button>
                                                    </div>
                                                </td>
                                                
                                                @* recommendations *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 200px; max-width:400px;">
                                                    <div class="d-flex align-items-top w-100"
                                                         ng-if="item.row_type =='workstep' || item.row_type =='taskdesc' || item.row_type =='potentailhazard' || item.row_type =='possiblecase' ">

                                                        <span class=" font-sans-serif btn-reveal-trigger position-static pt-1 disabled-link d-none" ng-class="{'d-none':(!tab_worksheet_active)}">
                                                            <button data-bs-toggle="modal" data-bs-target="#modalSuggestionRecommendations"
                                                                    class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 text-align-end p-1">
                                                                <span class="fas fa-lightbulb text-warning align-top"></span>
                                                            </button>
                                                        </span>

                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style="min-width: 200px !important; max-width: 400px !important; font-size: 10px;"
                                                                      id="recommendations_worksheet_{{item.seq}}" name="recommendations_worksheet_{{item.seq}}"
                                                                      placeholder="Recommendations" rows="3"
                                                                      ng-model="item.recommendations"
                                                                      ng-keyup="filterResultHistory(item.recommendations, 'recommendations', 'recommendations_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')"></textarea>

                                                            <div class="autocomplete-dropdown col-auto" style="position: absolute;"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('recommendations_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('recommendations_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | filter:{field:'recommendations'}"
                                                                     ng-click="selectResult(result,item,'recommendations')">
                                                                    {{ result.name }}โช
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="ms-2 mt-1 pe-auto ps-2" style="cursor: pointer;" ng-show="showHistory"
                                                             data-tooltip-location="right"
                                                             data-tooltip="This is the tooltip content ">
                                                            <span class="fa-regular fa-lightbulb fa-lg"></span>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* responder *@
                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 200px; max-width:400px;">
                                                    <div class="d-flex align-items-top w-100"
                                                         ng-if="item.row_type =='workstep' || item.row_type =='taskdesc' || item.row_type =='potentailhazard' || item.row_type =='possiblecase' ">
                                                        @* {{item.responder_action_by}} *@
                                                        <div class="autocomplete-container" style=" width: 100%; " ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                            <textarea class="form-control form-control-sm rounded-1 p-0 m-0 w-100 border border-end-0 border-top-0"
                                                                      style=" min-width: 200px !important; max-width: 300px !important; font-size: 10px;"
                                                                      id="responder_action_by_worksheet_{{item.seq}}" name="responder_action_by_worksheet_{{item.seq}}"
                                                                      placeholder="Action by" rows="3"
                                                                      ng-model="item.responder_action_by"
                                                                      ng-keyup="filterResultHistory(item.responder_action_by, 'responder_action_by', 'responder_action_by_worksheet_'+ item.seq);actionChangeWorksheet(item,item.seq,'')"></textarea>

                                                            <div class="autocomplete-dropdown col-auto" style="position: absolute;"
                                                                 ng-class="{'ng-show' : (filteredArr[0].fieldID == ('responder_action_by_worksheet_'+item.seq)),'ng-hide' : (filteredArr[0].fieldID !== ('responder_action_by_worksheet_'+item.seq)) }">
                                                                <div class="autocomplete-option"
                                                                     ng-repeat="result in filteredResults | filter:{field:'responder_action_by'}"
                                                                     ng-click="selectResult(result,item,'responder_action_by')">
                                                                    {{ result.name }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="ms-2 mt-1 pe-auto ps-2" style="cursor: pointer;" ng-show="showHistory"
                                                             data-tooltip-location="right"
                                                             data-tooltip="This is the tooltip content ">
                                                            <span class="fa-regular fa-lightbulb fa-lg"></span>
                                                        </div>
                                                    </div>
                                                </td>

                                                @* <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;" ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'s',item.seq,'after')">
                                                            <div class="d-flex"><h6 class="me-1">{{item.ram_after_security}}</h6> <span class="fas fa-pencil-alt fa-sm" style=" width: 8px;"></span> </div>
                                                        </button>
                                                    </div>
                                                </td> *@

                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 20px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 20px;" ng-class="{'disabled-link':(!tab_worksheet_active)}">
                                                        <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'l',item.seq,'after')">
                                                            <div class="d-flex">
                                                                <h6 class="me-1" style="font-size: 10px !important;">
                                                                    {{item.ram_after_security}}
                                                                    <span ng-if="item.ram_after_security && item.ram_after_likelihood">/</span>
                                                                     {{item.ram_after_likelihood}}
                                                                </h6> 
                                                                <span class="fas fa-pencil-alt fa-sm" style=" width: 8px;"></span> 
                                                            </div>
                                                        </button>
                                                    </div>
                                                </td>

                                                <td class="align-top border border-light border-end-0  border-start-0  border-top-0 "
                                                    style="padding: 0 !important; width: 25px;">
                                                    <div class="align-items-center text-end mt-1" style=" width: 25px;">
                                                        <button ng-style=" { 'background-color' : ((item.ram_after_risk == 'H') ? 'red' : ((item.ram_after_risk == 'M') ? 'yellow' : ((item.ram_after_risk == 'L') ? 'green' : '#D3D3D3')) ) }"
                                                                class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2p-1 ps-0 text-end"
                                                                type="button" ng-click="openModalDataRAM_Worksheet(item,'r',item.seq,'after')" style="width: 25px;">
                                                            <div class="text-center" style=" width: 25px;"><h6 class="me-1 text-center" style=" width: 25px;">{{item.ram_after_risk}}</h6></div>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>

                                    </table>

                                </div>

                            </div>

                        </div>

                    </div>
                    <!-- JSEA Worksheet -->
                    @* <!-- Safety Reviewer Appeover start--> *@
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==4),'tab-pane fade':(action_part!==4)}"
                         id="tab-approver" role="tabpanel" aria-labelledby="approver-tab">

                        <div class="m-3 row  gx-0 align-items-center">

                            <div class=" border-bottom border-200 my-0" id="ApproverTable">
                                <div class="table-responsive scrollbar">
                                    <table class="table fs--2 mb-0">
                                        <thead class=" text-uppercase text-center">
                                            <tr>
                                                <th class=" align-middle">No</th>
                                                <th class=" align-middle">Approver</th>
                                                <th class=" align-middle">Status</th>
                                                <th class=" align-middle text-start"><b class="text-danger" ng-if="item.action_status == 'reject'"> * </b>Comment</th>
                                                <th class=" align-middle text-start">Document File</th>
                                                <th class=" align-middle">Action Date</th>
                                                <th class=" align-middle"></th>
                                            </tr>
                                        </thead>

                                        <tbody class="list" id="customer-rating-table-body">
                                            <tr ng-repeat="item in data_approver | orderBy:['no']"
                                                ng-if="(item.user_name == user_name ) || (flow_role_type == 'admin')"
                                                class="hover-actions-trigger btn-reveal-trigger position-static text-center">

                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.no}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.user_displayname}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap  text-start">
                                                    <div class="col-md-12 p-1 ps-3 text-start" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)   ">
                                                        <div class="form-check form-check-inline cursor-pointer p-0">
                                                            <span class="fa-solid far fa-file-pdf text-danger" style="font-size:15px;"
                                                                  ng-click="confirmExport('jsea_report','pdf')"></span>
                                                            <b>
                                                                JSEA Report
                                                            </b>
                                                        </div><br />
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" id="inlineRadio-{{item.seq}}" type="radio"
                                                                   name="inlineRadioOptions-{{item.seq}}"
                                                                   value="approve" checked ng-model="item.action_status" />
                                                            <label class="form-check-label" for="inlineRadioApprove-{{item.seq}}"> Approve</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" id="inlineRadioOptions-{{item.seq}}" type="radio"
                                                                   name="inlineRadioOptions-{{item.seq}}"
                                                                   value="reject" ng-model="item.action_status" />
                                                            <label class="form-check-label" for="inlineRadioReject-{{item.seq}}"> Send back with Comment</label>
                                                        </div>
                                                        <div id="valid-approver-status-{{item.seq}}" class="invalid-feedback text-danger">
                                                            Please select a valid status.
                                                        </div>
                                                    </div>

                                                    <div class="col-md-12 p-1 text-start" ng-if="(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                        <div class="form-check form-check-inline cursor-pointer p-0">
                                                            <span class="fa-solid far fa-file-pdf text-danger" style="font-size:15px;"
                                                                  ng-click="confirmExport('jsea_report','pdf')"></span>
                                                            <b>
                                                                JSEA Report
                                                            </b>
                                                        </div><br />
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio" disabled checked />
                                                            <label class="form-check-label">  {{item.action_status =='approve' ? 'Approve' : 'Send back with Comment' }}</label>
                                                        </div>

                                                    </div>

                                                </td>
                                                <td class="align-top white-space-nowrap text-start">

                                                    <div class="col-md-12 p-1 ps-3" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                        <textarea class="form-control rounded-1" id="floatingTextarea2" placeholder="Enter your comment"
                                                                  ng-model="item.comment">  </textarea>

                                                        <div id="valid-approver-comment-{{item.seq}}" class="invalid-feedback text-danger">
                                                            Please select a valid comment.
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 p-1 ps-3 text-start" ng-if="(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.comment}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top px-1 text-start" style="min-width:200px;">
                                                    <div class=" p-0 cursor-pointer "
                                                         ng-repeat="item_x in data_drawing_approver  | filter:{id_approver : item.seq}  ">
                                                        @* {{item_x.document_file_size}} xx {{item_x.document_file_name}}   *@
                                                    </div>
                                                    <div class=" p-0 cursor-pointer "
                                                         ng-repeat="item_x in data_drawing_approver  | filter:{id_approver : item.seq}  ">

                                                        <div class="d-flex flex-nowrap" ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                            <div class="font-sans-serif btn-reveal-trigger position-static me-1">
                                                                <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2 p-1"
                                                                        type="button" data-bs-toggle="dropdown" data-boundary="window"
                                                                        aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                                                    <span class="fas fa-cog text-info"></span>
                                                                </button>
                                                                <div class="dropdown-menu dropdown-menu-end py-2">
                                                                    <a class="dropdown-item text-success"
                                                                       ng-click=addDataApproverDrawing(item_x,item.seq,item.id_session)>
                                                                        <span class="fas fa-copy"></span>
                                                                        Add
                                                                    </a>
                                                                    <div class="dropdown-divider"></div><a class="dropdown-item text-danger"
                                                                                                           ng-click=removeDataApproverDrawing(item_x,item_d.seq)>
                                                                        <span class="fas fa-times-circle"></span> Remove
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div class="align-items-center">
                                                                <div class="">
                                                                    <span class="nametext ms-3 filename-text me-2 d-none" id="filename-approver-{{item_x.seq}}">
                                                                        {{(item_x.document_file_size>0? item_x.document_file_name + '('+  item_x.document_file_size + 'KB)' : '')}}
                                                                    </span>
                                                                    <input type="file" id="attfile-{{item_x.seq}}"
                                                                           name="file{{item_x.seq}}"
                                                                           onchange="angular.element(this).scope().fileSelectApprover(this,'approver')"
                                                                           style="display:none" />
                                                                    <label class="dz-message-text text-info fw-bold p-1" for="attfile-{{item_x.seq}}"
                                                                           style="cursor: pointer;">
                                                                        <i class="fa-solid fa-arrow-up-from-bracket fa-xl me-1"></i>
                                                                        <span class="upload-text d-none d-lg-inline">Upload File (Max size 10mb)</span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="text-start p-0 cursor-pointer d-flex flex-nowrap" ng-if="item_x.document_file_size>0 ">
                                                            <a class="nametext ms-3 filename-text me-2" ng-click="downloadFile(item_x)">
                                                                <i class="far fa-file-pdf text-danger"></i> {{(item_x.document_file_size>0? item_x.document_file_name + '('+  item_x.document_file_size + 'KB)' : '')}}
                                                            </a>
                                                        </div>

                                                    </div>
                                                    <div ng-class="{'invalid-feedback text-danger': !(form_valid.valid_document_file==true && item.seq == id_approver_select), 'feedback text-danger': form_valid.valid_document_file}">
                                                        Please provide a valid document file.
                                                    </div>
                                                </td>
                                                <td class="align-top white-space-nowrap">
                                                    <div class="col-md-12 p-1 ps-3">
                                                        <label class="text-1100 fw-bold ">
                                                            {{item.date_review_show}}
                                                        </label>
                                                    </div>
                                                </td>
                                                <td class="align-top px-0 pt-0 ">
                                                    <div class="d-flex">

                                                        <button class="btn btn-outline text-primary  p-1 m-2 me-0" style=" background-color: #f1f2f4; width:50px;"
                                                                ng-click="confirmDialogApprover(item,'save')"
                                                                ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                            <span class="fa fa-save text-primary fa-lg"></span><br /><span style="font-size:8px">Save</span>
                                                        </button>

                                                        <button class="btn btn-outline text-success  p-1 m-2 ms-1"
                                                                style="background-color: #f1f2f4; width:80px; "
                                                                ng-click="confirmDialogApprover(item,'submit')"
                                                                ng-if="!(item.approver_action_type == 2 || data_header[0].pha_status != 21)">
                                                            <span class="fa fa-save text-success fa-lg"></span><br /><span style="font-size:8px">Submit</span>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>

                                        </tbody>

                                    </table>
                                </div>
                            </div>

                        </div>


                    </div>
                    @* <!-- Safety Reviewer Appeover end --> *@


                    <!-- Report start-->
                    <div class="" ng-class="{'tab-pane fade show active':(action_part==5),'tab-pane fade':(action_part!==5)}"
                         id="tab-report" role="tabpanel" aria-labelledby="report-tab" ng-if="export_type==true">

                        <div class="m-3 row  gx-0 align-items-center">
                            <div class="bg-white position-relative top-1">
                                <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                                    <table class="table table-sm fs--1 mb-0">
                                        <thead class=" text-uppercase">
                                            <tr>
                                                <th class="white-space-nowrap fs--1 align-middle ps-0" style="width:5%;"></th>
                                                <th class=" align-middle pe-5" style="width:70%">
                                                    Report
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class=" list text-uppercase" id="customers-table-body">
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2 d-none" ng-click="confirmExport('jsea_report','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('jsea_report','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('jsea_report','none-word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    JSEA REPORT
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('jsea_worksheet','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('jsea_worksheet','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('jsea_worksheet','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    JOB SAFETY ENVIRONMENTAL ANALYSIS (JSEA) WORKSHEET
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static d-none">
                                                <td class="fs--1 align-middle ps-0 py-3">
                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('jsea_recommendation','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('jsea_recommendation','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('jsea_recommendation','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    JSEA RECOMMENDATION RESPONSE SHEET & RECCOMENDATION STATUS TRACKING TABLE
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                                                <td class="fs--1 align-middle ps-0 py-3">

                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="confirmExport('jsea_ram','excel')"></span>
                                                        <span class="fa-solid far fa-file-pdf text-danger p-2" ng-click="confirmExport('jsea_ram','pdf')"></span>
                                                        <span class="fa-solid far fa-file-word text-secondary p-2 d-none" ng-click="confirmExport('jsea_ram','word')"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    Risk Assessment Matrix (RAM)
                                                </td>
                                            </tr>
                                            <tr class="hover-actions-trigger btn-reveal-trigger position-static d-none">
                                                <td class="fs--1 align-middle ps-0 py-3">

                                                    <div class="cursor-pointer">
                                                        <span class="fa-solid far fa-file-excel text-success p-2" ng-click="export_template_data()"></span>
                                                    </div>
                                                </td>
                                                <td class="email align-middle white-space-nowrap text-1000 pe-5">
                                                    JSEA Report Template
                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="bg-white position-relative top-1 d-none" ng-repeat="item_doc in exportfile "
                                 ng-if="(item_doc.DownloadPath !='' || item_doc.DownloadPath != null)">
                                <h5 class="modal-title" id="modalExportFileLabel">Download File</h5>
                                <a href="{{item_doc.DownloadPath}}" id="exportfile" name="exportfile" target="_blank">
                                    {{item_doc.DownloadPath}}-{{item_doc.Name}}
                                </a>
                            </div>


                        </div>

                    </div>
                    <!-- Report end-->

                </div>

            </div>
        </div>
    </div>


    @* ************************************************************** *@

    <!--Modal Employee Add Start-->
    <div class="modal fade modal-xl" id="modalEmployeeAdd" tabindex="-1" aria-labelledby="modalEmployeeAddLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" ng-if="selectDatFormType != 'specialist'">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalEmployeeCheckLabel">
                        <span class=" me-2 text-primary"><B>|</B></span> Search Employee/Contract
                    </h5>
                    <button class="btn p-1" 
                            type="button" 
                            data-bs-dismiss="modal" 
                            aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" 
                            aria-hidden="true" 
                            focusable="false" 
                            data-prefix="fas"
                            data-icon="xmark" 
                            role="img" 
                            xmlns="http://www.w3.org/2000/svg" 
                            viewBox="0 0 320 512"
                            data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body" ng-class="{'d-none':(selectDatFormType == 'specialist')}">
                    <div class="mb-4">
                        <div class="row g-3">
                            <div class="col-auto">
                                <div class="search-box position-relative">
                                    <input class="form-control search-input search"
                                           ng-model="searchText" 
                                           placeholder="Search"
                                           ng-change="fillterDataEmployeeAdd()" />
                                    <span class="fas fa-search search-box-icon"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    @* start แสดงข้อมูลที่ ค้นหาตาม textsearch*@
                    <div class="bg-white border-top border-bottom border-200 position-relative top-1">
                        <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                            <table class="table table-sm fs--1 mb-0">
                                <thead class=" text-uppercase">
                                    <tr class="text-center">
                                        <th class=""> </th>
                                        <th class="pe-5" scope="col">Employee</th>
                                        <th class="pe-5" scope="col">Indicator</th>
                                        <th class="pe-5" scope="col">E-Mail</th>
                                        <th class="pe-5" scope="col">Employee Type</th>

                                    </tr>
                                </thead>
                                    <tbody class="list">
                                        <!-- Check if employeelist_show is not empty and the first item in the array is not null -->
                                        <tr ng-if="employeelist_show.length > 0 && employeelist_show[0].employee_displayname !== null" ng-repeat="item in employeelist_show">
                                            <td class="">
                                                <a class="dropdown-item text-primary" ng-click="choosDataEmployee(item)">
                                                    Add
                                                </a>
                                            </td>
                                            <td class="">
                                                <a class="text-decoration-none d-flex align-items-center">
                                                    <div class="avatar avatar-m" style="height: 20px; width: 20px;">
                                                        <img ng-if="item.employee_img" class="rounded-circle" ng-src="../../{{ item.employee_img }}" alt="">
                                                    </div>
                                                    <p class="mb-0 ms-3 text-1100 fw-bold"> ({{item.employee_id}}){{item.employee_displayname}} </p>
                                                </a>
                                            </td>
                                            <td class="">{{item.employee_position}} </td>
                                            <td class="">{{item.employee_email}} </td>
                                            <td class="">{{item.employee_type}}</td>
                                        </tr>
                                        <!-- Show "Not Found" message when employeelist_show is empty or the first item is null -->
                                        <tr ng-if="employeelist_show[0].employee_displayname === null">
                                            <td colspan="5">
                                                <p class="mb-0 ms-3 text-1100 fw-bold text-center"> Not Found </p>
                                            </td>
                                        </tr>
                                    </tbody>
                            </table>

                        </div>
                    </div>
                    @* end แสดงข้อมูลที่ ค้นหาตาม textsearch*@
                </div>

                <div class="modal-header bg-soft" ng-if="!(selectDatFormType =='owner' )">

                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='member'"> <span class=" me-2 text-primary"><B>|</B></span>Member Team</h5>
                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='approver'"> <span class=" me-2 text-primary"><B>|</B></span>Safety Reviewer</h5>
                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='reviewer'"> <span class=" me-2 text-primary"><B>|</B></span>Approver AE or AGSI</h5>
                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='attendees'"> <span class=" me-2 text-primary"><B>|</B></span>ผู้จัดทำ (Attendees)</h5>
                    <h5 class="text-900 mb-0" ng-if="selectDatFormType =='specialist'"> <span class=" me-2 text-primary"><B>|</B></span>ผู้เชี่ยวชาญเฉพาะด้าน (ถ้ามี)</h5>

                </div>

                @* member *@
                <div class="modal-body" ng-if="selectDatFormType =='member'">
                    <div class="col-auto" ng-repeat="item2 in data_memberteam | filter:{id_session: selectdata_session }"
                         ng-if="!(item2.user_displayname ==''  || item2.user_displayname == null)">
                        <div class="d-flex align-items-center p-1" style="height: 20px;">
                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                    ng-class="{'d-none':(!tab_general_active)}"
                                    ng-click="removeDataEmployee(item2.seq, selectdata_session)">
                                Remove
                            </button>
                            <label class="mb-0 ms-3 text-1100 fw-bold"
                                   style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>

                        </div>
                    </div>

                </div>

                @* approver *@
                <div class="modal-body" ng-if="selectDatFormType =='approver'">
                    @* start ข้อมูลเดียวกันกับตรง session Approver*@
                    <div class="col-auto" ng-repeat="item2 in data_approver | filter:{id_session: selectdata_session }"
                         ng-if="!(item2.user_displayname ==''  || item2.user_displayname == null)">
                        <div class="d-flex align-items-center p-1" style="height: 20px;">
                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                    ng-class="{'d-none':(!tab_general_active)}"
                                    ng-click="removeDataApprover(item2.seq, selectdata_session)">
                                Remove
                            </button>
                            <div class="form-check mt-1 mb-0 text-1100 fw-bold">
                                <input class="form-check-input disabled-link" type="checkbox"
                                       ng-if="item2.approver_type =='approver'" checked
                                       ng-click="actionChangeSafety(item2,item2.seq)">
                                <input class="form-check-input" type="checkbox"
                                       ng-if="!(item2.approver_type =='approver')"
                                       ng-click="actionChangeSafetyUnCheck(item2,item2.seq)">
                                <label class="form-check-label fw-bold" for="approver_safety">
                                    (Main)
                                </label>
                            </div>
                            <label class="mb-0 ms-3 text-1100 fw-bold"
                                   style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>


                        </div>
                    </div>
                    @* end ข้อมูลเดียวกันกับตรง session*@
                </div>

                @* reviewer *@
                <div class="modal-body" ng-if="selectDatFormType =='reviewer' ">
                    <div class="col-auto" ng-repeat="item2 in data_relatedpeople | filter:{id_session: selectdata_session ,user_type:'reviewer'}"
                         ng-if="!(item2.user_displayname ==''  || item2.user_displayname == null)">
                        <div class="d-flex align-items-center p-1" style="height: 20px;">
                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                    ng-class="{'d-none':(!tab_general_active)}"
                                    ng-click="removeDataRelatedpeople(item2.seq, selectdata_session)">
                                Remove
                            </button>
                            <label class="mb-0 ms-3 text-1100 fw-bold"
                                   style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>

                        </div>
                    </div>
                </div>

                @* relatedpeople group *@
                <div class="modal-body" ng-if="!(selectDatFormType =='member' || selectDatFormType =='approver'|| selectDatFormType =='reviewer')">
                    <div class="bg-white border-top border-bottom border-200 position-relative top-1">
                        <div class="table-responsive scrollbar-overlay mx-n1 px-1">
                            <table class="table table-sm fs--1 mb-0">
                                <thead class=" text-uppercase">
                                    <tr class="">
                                        <th class="" style="width:150px;"> </th>
                                        <th class="pe-5">Name (ชื่อ-นามสกุล)</th>
                                        <th class="pe-5">Title (ตำแหน่ง)</th>
                                    </tr>
                                </thead>
                                <tbody class=" list">
                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                        ng-repeat="itemRel in data_relatedpeople | filter:{id_session:selectdata_session, user_type:selectDatFormType}"
                                        ng-if="!(itemRel.user_displayname ==''  || itemRel.user_displayname == null)">
                                        <td class="">
                                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger p-0 text-end" style="width:140px;"
                                                    ng-class="{'d-none':(!tab_general_active)}"
                                                    ng-click="removeDataRelatedpeople(itemRel.seq)">
                                                Remove
                                            </button>
                                        </td>
                                        <td class="">
                                            <b>{{itemRel.user_displayname}}</b>
                                        </td>
                                        <td class="">
                                            <b>{{itemRel.user_title}}</b>
                                        </td>

                                    </tr>
                                    @*Free text*@
                                    <tr class="hover-actions-trigger btn-reveal-trigger position-static"
                                        ng-repeat="itemRel in data_relatedpeople_outsider | filter:{id_session:selectdata_session, user_type:selectDatFormType}">
                                        <td class="">
                                            <button id="del-{{item2.seq}}" class="btn btn-link text-danger p-0 text-end" style="width:140px;"
                                                    ng-class="{'d-none':(!tab_general_active)}"
                                                    ng-click="removeDataRelatedpeopleOutsider(itemRel.seq)">
                                                Remove
                                            </button>
                                            <button id="add-{{item2.seq}}" class="btn btn-link text-primary p-0 text-end" style="width:140px;"
                                                    ng-class="{'d-none':(!tab_general_active)}"
                                                    ng-click="addnewFreebox(itemRel.seq)"
                                                    ng-if="$last">
                                                Add Other Contract
                                            </button>
                                        </td>
                                        <td class="">
                                            <input type="text" class="form-control form-control-sm" placeholder="Name"
                                                   style="width: 100%;"
                                                   ng-model="itemRel.user_displayname"
                                                   ng-change="actionChange(itemRel,itemRel.seq,'')">
                                        </td>
                                        <td class="">
                                            <input type="text" class="form-control form-control-sm" placeholder="Title"
                                                   style="width: 100%;"
                                                   ng-model="itemRel.user_title"
                                                   ng-change="actionChange(itemRel,itemRel.seq,'')">
                                        </td>

                                    </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>

                <div class="d-none">
                    @* attendees *@
                    <div class="modal-body" ng-if="selectDatFormType =='attendees'">
                        <div class="col-auto d-none" ng-repeat="item2 in data_relatedpeople | filter:{id_session: selectdata_session ,user_type:'attendees'}"
                             ng-if="!(item2.user_displayname)">
                            <div class="d-flex align-items-center p-1" style="height: 20px;">
                                <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                        ng-class="{'d-none':(!tab_general_active)}"
                                        ng-click="removeDataEmployee(item2.seq, selectdata_session)">
                                    Remove
                                </button>
                                <label class="mb-0 ms-3 text-1100 fw-bold"
                                       style="width:80%;border-color: #f1f2f4;">{{ item2.user_displayname}}</label>

                            </div>
                        </div>
                    </div>

                    @* specialist *@
                    <div class="modal-body" ng-if="selectDatFormType =='specialist' ">

                        <div class="col-auto" ng-repeat="item2 in data_relatedpeople | filter:{id_session: selectdata_session ,user_type:'specialist'}"
                             ng-if="!(item2.user_displayname == null)">
                            <div class="d-flex align-items-center p-1" style="height: 20px;">
                                <button id="del-{{item2.seq}}" class="btn btn-link text-danger"
                                        ng-class="{'d-none':(!tab_general_active)}"
                                        ng-click="removeDataRelatedpeople(item2.seq)">
                                    Remove
                                </button>

                                <label class="mb-0 ms-3 text-1100 fw-bold"
                                       style="width:80%;border-color: #f1f2f4;">{{item2.user_displayname}}</label>

                            </div>
                        </div>
                    </div>

                </div>


            </div>
        </div>
    </div>
    <!--Modal Employee Check End-->
    @*


    *@
    @* Save *@
    <!--Modal File Start-->
    <div class="modal fade" id="modalMsgFile" tabindex="-1" aria-labelledby="modalMsgFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header bg-primary">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsgFileLabel">
                        <span class=" me-2"><B>|</B></span>Upload Successful
                    </h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body d-flex flex-column justify-content-center mb-4">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        Upload Data Success.
                    </h5>
                </div>
            </div>
        </div>
    </div>
    @* msg error file *@
    <div class="modal fade" id="modalMsgFileError" tabindex="-1" aria-labelledby="modalMsgFileErrorLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header bg-warning">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsgFileErrorLabel">
                        <span class=" me-2"><B>|</B></span>Warning
                    </h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body d-flex flex-column justify-content-center mb-4"
                     ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        File type not allowed for attachment.<br />
                        Please select a PDF, Word or Excel, Image file.<br />
                        (.PDF, .DOC, .DOCX, .XLS, .XLSX, .JPG, .PNG, .GIF)
                    </h5>
                </div>
            </div>
        </div>
    </div>
    <!--Modal File End-->
    <!--Modal Save Start-->
    <div class="modal fade" id="modalMsg" tabindex="-1" aria-labelledby="modalMsgLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center" style="display: flex !important;"
                     ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? false :true) }">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-triangle-exclamation fa-lg" ng-if="Action_Msg_Header == 'Warning'"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                        <i class="fa-solid fa-circle-check fa-lg" ng-if="Action_Msg_Header != 'Warning'"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body" ng-if="Action_Msg_Header == 'Success'">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <h5 class="mb-0 text-center " style="font-size: 40px; font-weight: bold;" data-anchor="data-anchor" id="modalMsgLabel">
                            {{Action_Msg_Header}}
                        </h5>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 mb-3">
                        <p class="lh-lg mb-0 text-center" style="font-size: 16px;">
                            {{ Action_Msg_Detail}}
                        </p>
                    </div>

                </div>
                <div class="modal-footer" ng-if="Action_Msg_Header == 'Success'">
                    <div class="d-flex flex-column align-items-center bg-primary"
                         ng-if="!Action_Msg_Confirm">
                        <button class="btn p-2 px-8 text-white" type="button" data-bs-dismiss="modal" aria-label="Close">
                            OK
                        </button>
                    </div>
                </div>

                <div class="modal-body" ng-if="Action_Msg_Header == 'Warning'">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <h5 class="mb-0 text-center ms-5" style="font-size: 40px; font-weight: bold;" data-anchor="data-anchor" id="modalMsgLabel">
                            {{Action_Msg_Header}}
                        </h5>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 mb-3">
                        <p class="lh-lg mb-0 text-center" style="font-size: 16px;">
                            {{ Action_Msg_Detail}}
                        </p>
                    </div>
                    <div class="d-flex flex-column align-items-center" ng-if="!Action_Msg_Confirm">
                        <button class="btn p-2 px-8 text-white" type="button" data-bs-dismiss="modal" aria-label="Close"
                                ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? false :true) }">
                            {{ Action_Msg_Header == 'Warning' ? 'Go back' : 'OK' }}
                        </button>
                    </div>
                </div>

                <div class="modal-body d-flex flex-column justify-content-center mb-4"
                     ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <h5 class="mb-3 text-center" style="font-size: 16px; font-weight: bold;">
                        Do you want to continue?
                    </h5>
                </div>
                <div class="modal-footer" ng-if="Action_Msg_Confirm && Action_Msg_Header == 'Warning'">
                    <div class="d-flex justify-content-center align-items-center">
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmSubmit('yes')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-check"></span> Yes
                            </a>
                        </button>
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmSubmit('no')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-times"></span> No
                            </a>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Save End-->
    <div class="modal fade" id="modalMsg2" tabindex="-1" aria-labelledby="modalMsg2Label"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" ng-class="{ 'bg-warning' : (Action_Msg_Header == 'Warning'? true :false),'bg-primary' : (Action_Msg_Header == 'Warning'? true :false) }">
                    <h5 class="text-900 mb-0" data-anchor="data-anchor" id="modalMsg2Label">
                        <span class=" me-2" ng-class="{ 'text-danger' : (Action_Msg_Header == 'Warning'? true :false),'text-primary' : (Action_Msg_Header == 'Warning'? true :false) }"><B>|</B></span> {{Action_Msg_Header}}
                    </h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" ng-if="!Action_Msg_Confirm">
                    <p class="text-700 lh-lg mb-0">{{Action_Msg_Detail}}</p>
                </div>

                <div class="modal-body">

                    <div class="d-flex justify-content-center">
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmMailtoMemberReview('yes')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-check"></span> Yes
                            </a>
                        </button>
                        <button class="btn btn-phoenix-primary px-7 p-2 m-2" ng-click="confirmMailtoMemberReview('no')"
                                data-bs-dismiss="modal">
                            <a class="dropdown-item text-primary">
                                <span class="fas fa-times"></span> No
                            </a>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!--Modal Export & Import Data Start-->
    <div class="modal fade modal-xl" id="modalExportImport" tabindex="-1" aria-labelledby="modalExportImportLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportImportLabel">Export & Import Data</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                </div>

            </div>
        </div>
    </div>
    <!--Modal Export & Import Data End-->
    @*


    *@
    @* RAM *@

    <!--Modal RAM Start-->
    <div class="modal fade modal-xl shadow-sm p-3 mb-5  rounded" id="modalRAM" tabindex="-1"
         aria-labelledby="modalRAMLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">

            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalRAMLabel">Risk Assessment Matrix (RAM){{(selectedDataNodeWorksheetRamType =='s'?' : Security':(selectedDataNodeWorksheetRamType =='l'?' : Likelihood':''))}}</h5>
                        <span class="mx-1 d-flex">
                            <a class="m-1 text-info cursor-pointer"
                                href="{{y.document_definition_file_path}}" target="_blank"
                                ng-repeat="y in master_ram | filter:{id: data_general[0].id_ram}">Definition Consequence Rating<span class="fas fa-file-pdf fa-lg ms-1"></span></a>
                        </span>

                    <div class="col-auto ms-auto" style="zoom:1.5">
                        <b class="pe-1 me-1"> Security : {{cal_ram_action_security}}</b>
                        <b class="pe-1 me-1"> Likelihood : {{cal_ram_action_likelihood}}</b>
                        <b class="pe-1 me-1">  Risk : </b>
                        <label class="pe-1 me-1 text-center" style="width:100px"
                               ng-style=" { 'background-color' : ((cal_ram_action_risk == 'H') ? 'red' : ((cal_ram_action_risk == 'M') ? 'yellow' : ((cal_ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }">{{cal_ram_action_risk}}</label>
                    </div>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <div class="modal-body">
                    <div class="row">
                        <div class="row">
                            <div class="col-6 d-flex justify-content-center gap-10">
                            </div>
                            <div class="col-6 d-flex justify-content-end" 
                              ng-class="{'ram-l-5': (data_general[0].id_ram == 5) ,'ram-l-4': (data_general[0].id_ram == 4)}">
                                <div class="d-flex justify-content-end align-items-center flex-column" 
                                    ng-repeat="item_ram in master_likelihood_level | filter:{id_ram:data_general[0].id_ram,columns_level:item_ram.columns_level}">
                                    <label for="likelihood"><b>{{item_ram.likelihood_level}}</b></label>
                                    <input type="radio" 
                                            id="likelihood" 
                                            name="likelihood" 
                                            ng-click="selectDataRAM('l',item_ram.likelihood_level)"
                                            style="cursor: pointer; width: 30px; height: 30px;">
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-1 d-flex flex-column justify-content-end"  
                            ng-class="{'ram-s-5': (data_general[0].id_ram == 5) ,'ram-s-4': (data_general[0].id_ram == 4)}">
                            <div class="d-flex justify-content-end align-items-center gap-2" 
                                ng-repeat="item_ram in master_security_level | filter:{id_ram:data_general[0].id_ram,category_type:item_ram.category_type}">
                                <label for="security_level"><b>{{item_ram.security_level}}</b></label>
                                <input type="radio" 
                                        id="security_level" 
                                        name="security_level"  
                                        ng-click="selectDataRAM('s',item_ram.security_level)"
                                       style="cursor: pointer; width: 30px; height: 30px;">
                            </div>
                        </div>

                        <div class="col-11">
                            <div class="cursor-pointer " ng-repeat="itemRam in master_ram | filter:{id: data_general[0].id_ram}">
                                <img src="{{itemRam.document_file_path}}" style="width: 100%;  height:100%;" />
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-body d-none">
                    <div class="row">

                        <div class="col-12 mb-1">
                            <b class="pe-1 me-1"> Security : {{cal_ram_action_security}}</b>
                            <b class="pe-1 me-1"> Likelihood : {{cal_ram_action_likelihood}}</b>
                            <b class="pe-1 me-1">  Risk : </b>
                            <label class="pe-1 me-1 text-center" style="width:200px"
                                   ng-style=" { 'background-color' : ((cal_ram_action_risk == 'H') ? 'red' : ((cal_ram_action_risk == 'M') ? 'yellow' : ((cal_ram_action_risk == 'L') ? 'green' : '#D3D3D3')) ) }">{{cal_ram_action_risk}}</label>
                        </div>


                    </div>


                    <div ng-if="(selectedDataNodeWorksheetRamType == 'r' || selectedDataNodeWorksheetRamType == 'ram')">


                        <div class="text-center cursor-pointer " ng-repeat="itemRam in master_ram | filter:{id: data_general[0].id_ram}">
                            <img src="{{itemRam.document_file_path}}" style="width: 400px;  height:300px;" />
                        </div>


                    </div>
                    <div ng-if="selectedDataNodeWorksheetRamType == 's'">

                        <table class="table table-sm fs--1 mb-0 col-auto ">
                            <thead class="bg-light-primary">
                                <tr>
                                    <td rowspan="2" class="text-center"></td>
                                    <th rowspan="1" colspan="3" class="text-center" ng-if="select_columns_level != 5">Security</th>
                                    <th rowspan="1" colspan="6" class="text-center" ng-if="select_columns_level == 5">Security</th>
                                </tr>
                                <tr ng-if="select_columns_level != 5">
                                    <td class="text-center">Level</td>
                                    <td>Description</td>
                                </tr>
                                <tr ng-if="select_columns_level == 5">
                                    <td class="text-center">Level</td>
                                    <td>People</td>
                                    <td>Assets</td>
                                    <td>Enhancement</td>
                                    <td>Reputation</td>
                                    <td>Product Quality</td>
                                </tr>
                            </thead>

                            <tbody class=" align-top text-start">
                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                    ng-repeat="item_ram in master_security_level | filter:{id_ram:data_general[0].id_ram,category_type:item_ram.category_type}">
                                    <td class=" text-end" style="width: 80px;">
                                        <a class="pointer" ng-click="selectDataRAM('s',item_ram.security_level)"
                                           data-bs-dismiss="modal" aria-label="Close">Select</a>
                                    </td>
                                    <td class="text-center">{{item_ram.security_level}}</td>
                                    <td ng-if="item_ram.category_type !== 5">{{item_ram.security_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.people_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.assets_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.enhancement_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.reputation_text}}</td>
                                    <td ng-if="item_ram.category_type == 5">{{item_ram.product_quality_text}}</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <div ng-if="selectedDataNodeWorksheetRamType == 'l'">

                        <table class="table table-sm fs--1 mb-0 col-auto ">
                            <thead class="bg-light-primary">
                                <tr>
                                    <td rowspan="2" class="text-center"></td>
                                    <th rowspan="1" colspan="3" ng-if="select_columns_level != 5">Likelihood</th>
                                    <th rowspan="1" colspan="5" ng-if="select_columns_level == 5">Likelihood</th>
                                </tr>
                                <tr ng-if="select_columns_level != 5">
                                    <td class="text-center">Level</td>
                                    <td>Description</td>
                                </tr>
                                <tr ng-if="select_columns_level == 5">
                                    <td class="text-center">Level</td>
                                    <td>Description</td>
                                    <td>Description(2)</td>
                                    <td>Criterion</td>
                                </tr>
                            </thead>

                            <tbody class=" align-top text-start">
                                <tr class="hover-actions-trigger btn-reveal-trigger position-static "
                                    ng-repeat="item_ram in master_likelihood_level | filter:{id_ram:data_general[0].id_ram,columns_level:item_ram.columns_level}">
                                    <td class="text-end pointer" style="width: 80px;">
                                        <a class="pointer" ng-click="selectDataRAM('l',item_ram.likelihood_level)"
                                           data-bs-dismiss="modal" aria-label="Close">Select</a>
                                    </td>
                                    <td class="text-center">{{item_ram.likelihood_level}}</td>
                                    <td ng-if="item_ram.columns_level !== 5">{{item_ram.likelihood_show}}</td>

                                    <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_text}}</td>
                                    <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_desc}}</td>
                                    <td ng-if="item_ram.columns_level == 5">{{item_ram.likelihood_criterion}}</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>

                </div>

            </div>

        </div>
    </div>
    <!--Modal RAM End-->
    <!--Modal New RAM-->
    <div class="modal fade" id="modalNewRAM" tabindex="-1" aria-labelledby="modalNewRAM"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalNewRAM">Risk Assessment Matrix</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3 flex-start mb-3">
                        <div class="col-md-8 ps-2">
                            <input class="form-control rounded-1 ps-1" ng-class="{'disabled-link':(!tab_general_active)}"
                                   type="text" placeholder="Ram Name"
                                   name="ram_name"
                                   ng-model="item.ram_name"
                                   ng-keyup="actionChange_ram_name(item.ram_name)">
                        </div>
                    </div>

                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center ">
                            <select class="form-control" ng-model="ram_rows_level">
                                <option ng-repeat="itemNo in master_no">
                                    {{itemNo.name}}
                                </option>
                            </select>
                            <label class="form-label" style=" width:100px">X</label>
                            <select class="form-control" ng-model="ram_columns_level">
                                <option ng-repeat="itemNo in master_no">
                                    {{itemNo.name}}
                                </option>
                            </select>
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm" style="width: 100px;" ng-click="confirmAddRAM()">Add</button>
                            </span>
                        </div>
                        <div class="">
                            <label class="form-label">{{ram_msg_level}}</label>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal New RAM-->
    @*


    *@
    @* Notification *@
    @* <!--Modal Notification Start--> *@
    <div class="modal fade modal-xl" id="modalNotification" tabindex="-1" aria-labelledby="modalNotificationLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalNotificationLabel">Notification (SAP)</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3">
                        <div class="text-center cursor-pointer ">

                            <div class="table-responsive scrollbar-overlay mx-n1 px-1" style="zoom:0.7">
                                <table class="table table-sm fs--1 mb-0">
                                    <thead class=" text-uppercase">
                                        <tr>
                                            <th class="fs--1 align-middle ps-0 py-3">Notif Date </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Notif Time </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Notification </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Orders </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Type </th>
                                            <th class="fs--1 align-middle ps-0 py-3">P </th>
                                            <th class="fs--1 align-middle ps-0 py-3">PLS </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Functional Location </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Descriptions Func </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Descriptions </th>
                                            <th class="fs--1 align-middle ps-0 py-3">MN(wk)</th>
                                            <th class="fs--1 align-middle ps-0 py-3">Plnt </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Reported By </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Required Start </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Required End </th>
                                            <th class="fs--1 align-middle ps-0 py-3">User Status </th>
                                            <th class="fs--1 align-middle ps-0 py-3">Date Update </th>
                                        </tr>
                                    </thead>
                                    <tbody class=" list" ng-repeat="itemMaster in master_functional | orderBy:seq">
                                        <tr class="hover-actions-trigger btn-reveal-trigger position-static ">
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notif_date}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notif_time}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.notification}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.orders}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.typ}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.p}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.pls}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.functional_location}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.descriptions_func}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.descriptions}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.mn_wk}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.plnt}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.reported_by}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.required_start}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.required_end}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.user_status}}</td>
                                            <td class="fs--1 align-middle ps-0 py-3">{{itemMaster.date_update}}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    @* <!--Modal Notification End--> *@

    <!--Modal Export File Start-->
    <div class="modal fade" id="modalExportFile" tabindex="-1" aria-labelledby="modalExportFileLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalExportFileLabel">Download File</h5>
                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="bg-white position-relative top-1">

                        <a href="{{exportfile[0].DownloadPath}}" id="exportfile" name="exportfile" target="_blank">
                            {{exportfile[0].Name}}
                        </a>

                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Export File End-->
    <!--Modal Cause Show-->
    <div class="modal fade modal-xl" id="modalCauseText" tabindex="-1" aria-labelledby="modalCauseTextLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalCauseTextLabel">Details</h5>

                    <button class="btn p-1" type="button" data-bs-dismiss="modal" aria-label="Close">
                        <svg class="svg-inline--fa fa-xmark fs--1" aria-hidden="true" focusable="false" data-prefix="fas"
                             data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"
                             data-fa-i2svg="">
                            <path fill="currentColor"
                                  d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row g-3">
                        <div class="" ng-repeat="itms_show in data_listworksheet_show ">
                            {{itms_show.workstep_no +'.'+ itms_show.cause}}
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!--Modal Cause Show-->
    @*


    *@
    @* e-Mail *@
    <!--Modal Check Send e-Mail Case Save for PHA Conduct -->
    <div class="modal fade" id="modalSendMailRegister" tabindex="-1" aria-labelledby="modalSendMailRegisterLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_register_without')">
                                    Save for PHA Conduct
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail Case Save for PHA Conduct -->
    <!--Modal กรณีที่ Draft เมื่อกด Tab JSEA Worksheet-->
    <div class="modal fade" id="modalPleaseRegister" tabindex="-1"
         aria-labelledby="modalPleaseRegisterLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-end align-items-end bg-primary" style="display: flex !important;">
                    <div class="d-flex justify-content-end mb-2">
                        <i class="fa-solid fa-times" ng-click="closePleaseRegister()"
                           style="color: rgb(255, 255, 255); font-size: 20px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalPleaseRegisterLabel" style="font-size: 20px; font-weight: bold;">
                            Please register task before fill in JSEA Worksheet.
                        </h5>

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-primary btn-sm col-auto" ng-click="confirmSave('confirm_submit_register')">Register with notify members</button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-success btn-sm col-auto" ng-click="confirmSave('confirm_submit_register_without')">Register without notify members</button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal กรณีที่ Draft เมื่อกด Tab JSEA Worksheet-->
    <!--Modal Check Send e-Mail ปุ่ม Submit ที่ Status WPC -->
    <div class="modal fade" id="modalSendMailConduct" tabindex="-1" aria-labelledby="modalSendMailConductLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h6 class="modal-title mb-0 text-center" id="modalSendMailConductLabel" style="font-size: 40px; font-weight: bold;">
                            Complete JSEA Worksheet for all sessions?
                        </h6>
                    </div>
                    <div class="justify-content-center align-items-center mb-5" ng-if=" data_header[0].pha_status == 22">

                        <label class="form-label ps-0" for="expense_type">Note to Approver</label>
                        <textarea class="form-control rounded-1" placeholder="Note"
                                  ng-repeat="item in data_node | filter:{id:selectedItemNodeView}"
                                  ng-model="item.descriptions"
                                  ng-if=" data_header[0].pha_status == 22"
                                  style="height: 50px"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">

                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_complete')">
                                    Complete and Submit to Safety Reviewer
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        style=" background-color: #c9c5c5;"
                                        ng-click="confirmSave('confirm_cancel_complete')">
                                    Cancel
                                </button>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Submit ที่ Status WPC -->
    <!--Modal Check Send e-Mail ปุ่ม Team Member Start-->
    <div class="modal fade" id="modalSendMailTeam" tabindex="-1" aria-labelledby="modalSendMailTeamLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h4 class="modal-title mb-0 text-center" id="modalSendMailTeamLabel" style="font-size: 30px; font-weight: bold;">
                            Confirm send email to member review?
                        </h4>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmMailtoMemberReview('confirm_submit_team')">
                                    Yes
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        ng-click="confirmMailtoMemberReview('confirm_cancel_team')"
                                        style=" background-color: #c9c5c5;">
                                    No
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Team Member Start-->
    <!--Modal Genarate Full Report -->
    <div class="modal fade" id="modalSendGenarateFullReport" tabindex="-1" aria-labelledby="modalSendGenarateFullReportLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary"
                     style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h4 class="modal-title mb-0 text-center" id="modalSendGenarateFullReportLabel"
                            style="font-size: 40px; font-weight: bold;">
                            Genarate Full Report?
                        </h4>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_genarate')">
                                    Genarate Full Report with notify members.
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_genarate_without')"
                                        style=" background-color: #c9c5c5;">
                                    Genarate Full Report without notify members.
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Genarate Full Report-->
    <!--Modal Check Send e-Mail ปุ่ม Submit TA2 Approver-->
    <div class="modal fade" id="modalSendMailApprover" tabindex="-1" aria-labelledby="modalSendMailApproverLabel"
         aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="width: 100%; min-height: 300px;">
                <div class="modal-header justify-content-center align-items-center bg-primary" style="display: flex !important;">
                    <div class="d-flex mb-2 d-none">
                        <i class="fa-solid fa-envelope-open-text fa-lg"
                           style="color: rgb(255, 255, 255); font-size: 80px; font-weight: bold;"></i>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center align-items-center mb-5">
                        <h5 class="modal-title mb-0 text-center" id="modalSendMailApproverLabel" style="font-size: 40px; font-weight: bold;">
                            Submit JSEA Worksheet for all sessions?
                        </h5>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row g-3 flex-center">
                        <div class="d-flex flex-center">
                            <span class="mx-2" ng-if="save_type">
                                <button class="btn btn-success btn-sm col-auto"
                                        ng-click="confirmSave('confirm_submit_approver')">
                                    Submit
                                </button>
                            </span>
                            <span class="mx-2" ng-if="submit_type">
                                <button class="btn btn-default btn-sm col-auto"
                                        style=" background-color: #c9c5c5;"
                                        ng-click="confirmSave('confirm_cancel_approver')">
                                    Cancel
                                </button>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal Check Send e-Mail ปุ่ม Submit TA2 Approver-->



</div>

@section Scripts {

    <script src="~/assets/js/angular.min.js"></script>
    <script src="~/assets/js/lodash.min.js"></script>
    <script src="~/assets/js/phoenix.js"></script>
    <script src="~/assets/js/choices.min.js"></script>
    <script src="~/assets/js/fakedata.js"></script>

    <script src="~/js/_flow/jsea.js"></script>

}
